[
  {
    "id": 205,
    "step_name": "ApplicationComponent",
    "phase": "generate",
    "version": 2,
    "sequence": 1,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Directory`)\nWHERE n.active = true\n  AND NOT n.name IN ['__pycache__', 'node_modules', '.git', '.venv', 'venv', 'dist', 'build',\n                     'static', 'assets', 'public', 'images', 'img', 'css', 'js', 'fonts',\n                     'templates', 'views', 'layouts', 'partials']\n  AND NOT n.path =~ '.*(test|spec|__pycache__|node_modules|\\\\.git|\\\\.venv|venv|dist|build).*'\nRETURN n.id as id, n.name as name, labels(n) as labels, properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying ApplicationComponent elements from source code directories.\n\nAn ApplicationComponent is a modular, deployable part of a system that:\n- Encapsulates related functionality (not just a folder)\n- Has clear boundaries and responsibilities\n- Contains code that works together as a unit\n- Could potentially be a separate module or package\n\nEach candidate includes graph metrics to help assess importance:\n- pagerank: How central/important the directory is\n- community: Which cluster of related code it belongs to\n- kcore: How connected it is to the core codebase\n- is_bridge: Whether it connects different parts of the codebase\n\nReview each candidate and decide which should become ApplicationComponent elements.\n\nINCLUDE directories that:\n- Represent cohesive functional units (services, modules, packages)\n- Have meaningful names indicating purpose\n- Are structural roots of related code\n\nEXCLUDE directories that:\n- Are just organizational containers with no cohesive purpose\n- Contain only configuration or static assets\n- Are too granular (single-file directories)\n\nNAMING RULES REMINDER:\n- Use lowercase snake_case for identifiers\n- Use consistent prefix for element type\n- Keep names generic and stable\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"appcomp_user_service\",\n      \"name\": \"User Service\",\n      \"documentation\": \"Handles user authentication, registration, and profile management\",\n      \"source\": \"dir_myproject_src_services_user\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"appcomp_frontend\",\n      \"name\": \"Frontend Application\",\n      \"documentation\": \"React-based web interface for the application\",\n      \"source\": \"dir_myproject_frontend\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-03T09:55:48.193178"
  },
  {
    "id": 101,
    "step_name": "ApplicationComponent",
    "phase": "generate",
    "version": 1,
    "sequence": 1,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (d:`Graph:Directory`) WHERE d.active = true RETURN d.id as id, d.name as name, d.path as path",
    "input_model_query": null,
    "instruction": "Group top-level code directories into ApplicationComponents. Use directory name as component name, include repo for context. Avoid nesting unless clear submodules exist.",
    "example": "{\"identifier\":\"app-comp:auth\",\"name\":\"Auth Component\",\"layer\":\"Application\",\"source\":\"Directory:src/auth\",\"confidence\":0.8}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.086589"
  },
  {
    "id": 347,
    "step_name": "ApplicationComponent",
    "phase": "generate",
    "version": 4,
    "sequence": 1,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Directory`)\nWHERE n.active = true\n  AND NOT n.name IN ['__pycache__', 'node_modules', '.git', '.venv', 'venv', 'dist', 'build',\n                     'static', 'assets', 'public', 'images', 'img', 'css', 'js', 'fonts',\n                     'templates', 'views', 'layouts', 'partials']\n  AND NOT n.path =~ '.*(test|spec|__pycache__|node_modules|\\\\.git|\\\\.venv|venv|dist|build).*'\nRETURN n.id as id, n.name as name, labels(n) as labels, properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying ApplicationComponent elements from source code files.\n\nAn ApplicationComponent represents a modular unit of functionality that encapsulates implementation.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include files with pagerank > median (structurally important)\n2. Include files with in_degree >= 2 (imported by multiple modules)\n3. Prefer files in k-core >= 2 (core application modules)\n4. Exclude files with out_degree = 0 AND in_degree = 0 (isolated utilities)\n\nINCLUDE files that:\n- Contain business logic or domain operations\n- Define API endpoints or service interfaces\n- Implement core application features\n\nEXCLUDE files that:\n- Are configuration only (config.py, settings.py)\n- Are purely tests or fixtures\n- Are database migrations or seeds\n\nNAMING RULES (MANDATORY):\n1. Identifier: ac_<module_name>\n2. Use lowercase snake_case\n3. Extract module name from file path\n4. Remove common suffixes: _module, _service, _controller\n\nLIMIT: Maximum 5-8 ApplicationComponent elements.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"ac_user_service\",\n      \"name\": \"User Service\",\n      \"documentation\": \"Handles user authentication, registration, and profile management\",\n      \"source\": \"dir_myproject_src_services_user\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"ac_frontend\",\n      \"name\": \"Frontend Application\",\n      \"documentation\": \"React-based web interface for the application\",\n      \"source\": \"dir_myproject_frontend\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T17:15:07.018673"
  },
  {
    "id": 380,
    "step_name": "ApplicationComponent",
    "phase": "generate",
    "version": 10,
    "sequence": 1,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Directory`)\nWHERE n.active = true\n  AND NOT n.name IN ['__pycache__', 'node_modules', '.git', '.venv', 'venv', 'dist', 'build',\n                     'static', 'assets', 'public', 'images', 'img', 'css', 'js', 'fonts',\n                     'templates', 'views', 'layouts', 'partials']\n  AND NOT n.path =~ '.*(test|spec|__pycache__|node_modules|\\\\.git|\\\\.venv|venv|dist|build).*'\nRETURN n.id as id, n.name as name, labels(n) as labels, properties(n) as properties",
    "input_model_query": null,
    "instruction": "<persona>\nYou are a senior enterprise architect with 15+ years of ArchiMate 3.2 expertise. You value semantic precision and consistent terminology above all else. You identify application components based on their architectural role, not their repository origin.\n</persona>\n\n<definition>\nAn ApplicationComponent represents a modular, deployable part of a software system that encapsulates behavior and data. These are structural elements representing logical groupings of functionality within the Application Layer.\n</definition>\n\n<naming_rules>\nIDENTIFIER FORMAT (MANDATORY):\n- Prefix: ac_\n- Format: ac_<function_description>\n- Style: lowercase snake_case\n- NEVER include repository name in identifier\n\nVALID examples:\n- ac_backend, ac_frontend, ac_api, ac_core\n- ac_kafka, ac_spark, ac_mongo, ac_ldap\n\nINVALID examples (NEVER use):\n- ac_lightblue_core (includes repo name)\n- ac_bigdata_kafka (includes repo name)\n- ApplicationComponent (wrong format)\n</naming_rules>\n\n<canonical_patterns>\nMap directories to these standard patterns:\n\n| Directory Pattern | Identifier | Name |\n|-------------------|------------|------|\n| backend/, server/ | ac_backend | Backend |\n| frontend/, client/, ui/, web/ | ac_frontend | Frontend |\n| src/, app/, main/, core/ | ac_core | Core |\n| api/, routes/, endpoints/ | ac_api | API |\n| services/, handlers/, jobs/ | ac_services | Services |\n| models/, entities/, domain/ | ac_models | Models |\n| utils/, lib/, common/ | ac_common | Common |\n\nFor directories not matching canonical patterns, derive a meaningful identifier from the directory's functional purpose (e.g., kafka/ → ac_kafka, migrator/ → ac_migrator).\n</canonical_patterns>\n\n<selection_criteria>\nINCLUDE directories that:\n- Represent cohesive functional units\n- Have high pagerank (structurally important)\n- Contain multiple source files\n- Handle specific domain functionality\n\nEXCLUDE directories:\n- Build artifacts: dist/, build/, node_modules/, __pycache__/\n- Documentation only: docs/, .github/\n- Configuration only: config/ (if just config files)\n- Empty or trivial directories\n\nTarget: 3-7 ApplicationComponents per repository.\n</selection_criteria>\n\n<output_format>\nJSON with \"elements\" array containing:\n- identifier: ac_ prefix + descriptive snake_case\n- name: Title Case descriptive name\n- documentation: Brief functional description\n- source: Source directory node ID\n- confidence: 0.7-1.0\n</output_format>\n\n<determinism>\nOutput stable, deterministic results. Given identical input, produce identical output.\n</determinism>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"ac_backend\",\n      \"name\": \"Backend\",\n      \"documentation\": \"Server-side application containing API endpoints and business logic\",\n      \"source\": \"dir_backend\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"ac_frontend\",\n      \"name\": \"Frontend\",\n      \"documentation\": \"Client-side web application with user interface components\",\n      \"source\": \"dir_frontend\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"ac_core\",\n      \"name\": \"Core\",\n      \"documentation\": \"Core application logic and domain services\",\n      \"source\": \"dir_src\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": "{\"temperature\": 0.0}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T21:41:38.339605"
  },
  {
    "id": 365,
    "step_name": "ApplicationComponent",
    "phase": "generate",
    "version": 9,
    "sequence": 1,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Directory`)\nWHERE n.active = true\n  AND NOT n.name IN ['__pycache__', 'node_modules', '.git', '.venv', 'venv', 'dist', 'build',\n                     'static', 'assets', 'public', 'images', 'img', 'css', 'js', 'fonts',\n                     'templates', 'views', 'layouts', 'partials']\n  AND NOT n.path =~ '.*(test|spec|__pycache__|node_modules|\\\\.git|\\\\.venv|venv|dist|build).*'\nRETURN n.id as id, n.name as name, labels(n) as labels, properties(n) as properties",
    "input_model_query": null,
    "instruction": "<application_component_derivation>\n\n<definition>\nAn ApplicationComponent represents a modular, deployable part of a software system that encapsulates its behavior and data. In ArchiMate, these are structural elements representing logical groupings of functionality.\n</definition>\n\n<canonical_identifiers>\nUse these canonical identifiers when a directory clearly matches the pattern. For directories that don't match, create a descriptive identifier following the naming convention.\n\n| Directory Pattern | Identifier | Name | When to Use |\n|-------------------|------------|------|-------------|\n| backend/, server/, api/ | ac_backend | Backend | Server-side application code |\n| frontend/, client/, ui/, web/, webapp/ | ac_frontend | Frontend | Client-side application code |\n| src/, app/, main/, core/ | ac_core | Core | Main application logic |\n| api/, routes/, endpoints/ | ac_api | API | API layer/routing |\n| services/, handlers/, jobs/ | ac_services | Services | Service layer, background jobs |\n| models/, entities/, domain/ | ac_models | Models | Data model layer |\n| utils/, lib/, common/, shared/ | ac_common | Common | Shared utilities |\n\nNAMING RULES (CRITICAL - READ CAREFULLY):\n1. Use snake_case with ac_ prefix for identifiers (e.g., ac_kafka, ac_streaming)\n2. **NEVER** include the repository name in the identifier!\n   - WRONG: ac_lightblue_core, ac_bigdata_kafka, ac_myrepo_services\n   - CORRECT: ac_core, ac_kafka, ac_services\n3. The identifier should describe the COMPONENT FUNCTION, not which repository it belongs to\n4. When a directory doesn't match canonical patterns, create a meaningful identifier based on its purpose\n5. Maximum 5-7 ApplicationComponents per repository\n6. For any non-trivial codebase with multiple directories, you SHOULD identify at least 2-3 components\n7. Prefer descriptive identifiers over omitting architecturally significant directories\n</canonical_identifiers>\n\n<examples_of_correct_naming>\nFor a repository named \"lightblue\" with directories: core/, mongo/, ldap/, migrator/\n- CORRECT identifiers: ac_core, ac_mongo, ac_ldap, ac_migrator\n- WRONG identifiers: ac_lightblue_core, ac_lightblue_mongo, ac_lightblue_ldap\n\nFor a repository named \"bigdata\" with directories: kafka/, spark/, webapp/\n- CORRECT identifiers: ac_kafka, ac_spark, ac_webapp\n- WRONG identifiers: ac_bigdata_kafka, ac_bigdata_spark, ac_bigdata_webapp\n</examples_of_correct_naming>\n\n<selection_criteria>\nMUST INCLUDE directories that:\n- Represent cohesive functional units with related code\n- Have high pagerank (structurally important)\n- Contain multiple source files or are key architectural boundaries\n- Handle specific domain functionality (e.g., messaging, streaming, data processing)\n\nEXCLUDE only these directories:\n- Build artifacts (dist/, build/, node_modules/, __pycache__/)\n- Documentation only (docs/, .github/)\n- Configuration only without code (config/ if just config files)\n- Empty or trivial directories\n</selection_criteria>\n\n<important>\nWhen in doubt about a directory, CREATE an element with lower confidence (0.7-0.8) rather than omitting it. It's better to have comprehensive coverage that can be refined later than to miss architecturally significant components.\n\nFor repositories with streaming, messaging, or data processing code (Kafka, Spark, etc.), these functional areas should typically become ApplicationComponents.\n</important>\n\n<output_format>\nJSON with \"elements\" array. Each element has:\n- identifier: ac_ prefix + descriptive snake_case name (NO REPOSITORY NAME!)\n- name: Title Case descriptive name\n- documentation: Brief description of what this component contains\n- source: Source directory node ID\n- confidence: 0.7-1.0 (use 0.7-0.8 for uncertain mappings)\n</output_format>\n\n<determinism>\nGiven identical directories, always produce identical output. Output stable, deterministic results.\n</determinism>\n\n</application_component_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"ac_backend\",\n      \"name\": \"Backend\",\n      \"documentation\": \"Server-side application containing API endpoints and business logic\",\n      \"source\": \"dir_backend\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"ac_frontend\",\n      \"name\": \"Frontend\",\n      \"documentation\": \"Client-side web application with user interface components\",\n      \"source\": \"dir_frontend\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"ac_core\",\n      \"name\": \"Core\",\n      \"documentation\": \"Core application logic and domain services\",\n      \"source\": \"dir_src\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": "{\"temperature\": 0.0}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T16:40:56.919721"
  },
  {
    "id": 382,
    "step_name": "ApplicationComponent",
    "phase": "generate",
    "version": 11,
    "sequence": 1,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Directory`)\nWHERE n.active = true\n  AND NOT n.name IN ['__pycache__', 'node_modules', '.git', '.venv', 'venv', 'dist', 'build',\n                     'static', 'assets', 'public', 'images', 'img', 'css', 'js', 'fonts',\n                     'templates', 'views', 'layouts', 'partials']\n  AND NOT n.path =~ '.*(test|spec|__pycache__|node_modules|\\\\.git|\\\\.venv|venv|dist|build).*'\nRETURN n.id as id, n.name as name, labels(n) as labels, properties(n) as properties",
    "input_model_query": null,
    "instruction": "<persona>\nYou are a senior enterprise architect with 15+ years of ArchiMate 3.2 expertise. You value semantic precision and consistent terminology above all else. You identify application components based on their architectural role as deployable units.\n</persona>\n\n<definition>\nAn ApplicationComponent represents a modular, deployable part of a software system that encapsulates behavior and data. These are structural elements at the DIRECTORY level representing logical groupings of functionality.\n</definition>\n\n<semantic_exclusions>\nAn ApplicationComponent is NOT:\n- An ApplicationService (components realize services, they are not services)\n- A single file or class (too granular)\n- A utility function or helper (those belong to a component)\n- A configuration artifact (that's a DataObject)\n\nDO NOT:\n- Create components for individual modules within a directory\n- Create components for test directories\n- Create components that don't contain executable code\n- Create multiple components for the same functional area\n</semantic_exclusions>\n\n<granularity_constraint>\nDIRECTORY LEVEL ONLY: Model at the major directory level, not at module/package level.\n\nCORRECT: ac_backend for the entire backend/ directory\nINCORRECT: ac_backend_auth, ac_backend_users as separate components within backend/\n\nException: Only create sub-directory components when they represent genuinely independent deployable units.\n</granularity_constraint>\n\n<component_test>\nVALIDATION RULE (apply to every candidate):\nA candidate ApplicationComponent must answer \"What services does this component realize?\" with at least one ApplicationService.\n\nREJECT if:\n- No service can be associated with this component\n- The component only contains utilities with no service realization\n- The component is purely configuration or documentation\n</component_test>\n\n<realization_constraint>\nSTRICT REALIZATION: Every ApplicationComponent must realize at least one ApplicationService.\n\nComponents without service realization should be:\n- Merged into a parent component, OR\n- Reconsidered as part of another element type (DataObject for configs)\n</realization_constraint>\n\n<naming_rules>\nIDENTIFIER FORMAT (MANDATORY):\n- Prefix: ac_\n- Format: ac_<functional_area>\n- Style: lowercase snake_case\n- NEVER include repository name\n\nNORMALIZATION PRECEDENCE:\n1. Prefer canonical patterns over derived names\n2. Prefer broader functional names over specific technology names\n3. Prefer singular over plural\n4. Prefer architectural role over directory name\n\nCONFLICT RESOLUTION:\n- ac_server vs ac_backend → choose ac_backend (standard term)\n- ac_src vs ac_core → choose ac_core (meaningful)\n- ac_lib vs ac_common → choose ac_common (standard term)\n</naming_rules>\n\n<canonical_patterns>\n| Directory Pattern | Identifier | Name |\n|-------------------|------------|------|\n| backend/, server/, api/ | ac_backend | Backend |\n| frontend/, client/, ui/, web/ | ac_frontend | Frontend |\n| src/, app/, main/, core/ | ac_core | Core |\n| services/, handlers/ | ac_services | Services |\n| models/, entities/, domain/ | ac_models | Models |\n| utils/, lib/, common/, shared/ | ac_common | Common |\n| worker/, jobs/, tasks/ | ac_worker | Worker |\n| gateway/, proxy/ | ac_gateway | Gateway |\n\nFor directories not matching canonical patterns, derive identifier from functional purpose (kafka/ → ac_kafka).\n</canonical_patterns>\n\n<selection_criteria>\nINCLUDE directories that:\n- Represent cohesive deployable units\n- Have high pagerank (structurally important)\n- Contain multiple source files\n- Realize at least one ApplicationService\n\nEXCLUDE:\n- Build artifacts: dist/, build/, node_modules/, __pycache__/\n- Documentation: docs/, .github/\n- Configuration only: config/ (unless contains code)\n- Test directories: tests/, test/, spec/\n- Empty or trivial directories\n</selection_criteria>\n\n<granularity_rules>\nTARGET: 3-7 ApplicationComponents per repository\n\nESCALATION RULES:\n- If > 7 candidates: merge by functional area until <= 7\n- If < 3 candidates: verify this is correct (small repos may have fewer)\n- If directory has no realizable services: do not create component\n</granularity_rules>\n\n<determinism>\nORDERING: Sort elements alphabetically by identifier.\n\nCONFIDENCE BANDS (fixed):\n- 0.9-1.0: Canonical patterns with clear service realization\n- 0.8-0.89: Clear derived components with identifiable services\n- 0.7-0.79: Inferred components with uncertain service mapping\n\nCONSISTENCY:\n- Do not invent synonyms across runs\n- Use identical identifiers for identical directories\n- Given identical input, produce identical output\n</determinism>\n\n<output_format>\nJSON with \"elements\" array containing:\n- identifier: ac_ prefix + functional area (snake_case)\n- name: Title Case component name\n- documentation: One sentence describing what services this component realizes\n- source: Source directory node ID\n- confidence: Per confidence bands above\n</output_format>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"ac_backend\",\n      \"name\": \"Backend\",\n      \"documentation\": \"Server-side application containing API endpoints and business logic\",\n      \"source\": \"dir_backend\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"ac_frontend\",\n      \"name\": \"Frontend\",\n      \"documentation\": \"Client-side web application with user interface components\",\n      \"source\": \"dir_frontend\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"ac_core\",\n      \"name\": \"Core\",\n      \"documentation\": \"Core application logic and domain services\",\n      \"source\": \"dir_src\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": "{\"temperature\": 0.0}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T21:51:54.562602"
  },
  {
    "id": 360,
    "step_name": "ApplicationComponent",
    "phase": "generate",
    "version": 8,
    "sequence": 1,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Directory`)\nWHERE n.active = true\n  AND NOT n.name IN ['__pycache__', 'node_modules', '.git', '.venv', 'venv', 'dist', 'build',\n                     'static', 'assets', 'public', 'images', 'img', 'css', 'js', 'fonts',\n                     'templates', 'views', 'layouts', 'partials']\n  AND NOT n.path =~ '.*(test|spec|__pycache__|node_modules|\\\\.git|\\\\.venv|venv|dist|build).*'\nRETURN n.id as id, n.name as name, labels(n) as labels, properties(n) as properties",
    "input_model_query": null,
    "instruction": "<application_component_derivation>\n\n<definition>\nAn ApplicationComponent represents a modular, deployable part of a software system that encapsulates its behavior and data. In ArchiMate, these are structural elements representing logical groupings of functionality.\n</definition>\n\n<canonical_identifiers>\nUse these canonical identifiers when a directory clearly matches the pattern. For directories that don't match, create a descriptive identifier following the naming convention.\n\n| Directory Pattern | Identifier | Name | When to Use |\n|-------------------|------------|------|-------------|\n| backend/, server/, api/ | ac_backend | Backend | Server-side application code |\n| frontend/, client/, ui/, web/, webapp/ | ac_frontend | Frontend | Client-side application code |\n| src/, app/, main/, core/ | ac_core | Core | Main application logic |\n| api/, routes/, endpoints/ | ac_api | API | API layer/routing |\n| services/, handlers/, jobs/ | ac_services | Services | Service layer, background jobs |\n| models/, entities/, domain/ | ac_models | Models | Data model layer |\n| utils/, lib/, common/, shared/ | ac_common | Common | Shared utilities |\n\nNAMING RULES (CRITICAL - READ CAREFULLY):\n1. Use snake_case with ac_ prefix for identifiers (e.g., ac_kafka, ac_streaming)\n2. **NEVER** include the repository name in the identifier!\n   - WRONG: ac_lightblue_core, ac_bigdata_kafka, ac_myrepo_services\n   - CORRECT: ac_core, ac_kafka, ac_services\n3. The identifier should describe the COMPONENT FUNCTION, not which repository it belongs to\n4. When a directory doesn't match canonical patterns, create a meaningful identifier based on its purpose\n5. Maximum 5-7 ApplicationComponents per repository\n6. For any non-trivial codebase with multiple directories, you SHOULD identify at least 2-3 components\n7. Prefer descriptive identifiers over omitting architecturally significant directories\n</canonical_identifiers>\n\n<examples_of_correct_naming>\nFor a repository named \"lightblue\" with directories: core/, mongo/, ldap/, migrator/\n- CORRECT identifiers: ac_core, ac_mongo, ac_ldap, ac_migrator\n- WRONG identifiers: ac_lightblue_core, ac_lightblue_mongo, ac_lightblue_ldap\n\nFor a repository named \"bigdata\" with directories: kafka/, spark/, webapp/\n- CORRECT identifiers: ac_kafka, ac_spark, ac_webapp\n- WRONG identifiers: ac_bigdata_kafka, ac_bigdata_spark, ac_bigdata_webapp\n</examples_of_correct_naming>\n\n<selection_criteria>\nMUST INCLUDE directories that:\n- Represent cohesive functional units with related code\n- Have high pagerank (structurally important)\n- Contain multiple source files or are key architectural boundaries\n- Handle specific domain functionality (e.g., messaging, streaming, data processing)\n\nEXCLUDE only these directories:\n- Build artifacts (dist/, build/, node_modules/, __pycache__/)\n- Documentation only (docs/, .github/)\n- Configuration only without code (config/ if just config files)\n- Empty or trivial directories\n</selection_criteria>\n\n<important>\nWhen in doubt about a directory, CREATE an element with lower confidence (0.7-0.8) rather than omitting it. It's better to have comprehensive coverage that can be refined later than to miss architecturally significant components.\n\nFor repositories with streaming, messaging, or data processing code (Kafka, Spark, etc.), these functional areas should typically become ApplicationComponents.\n</important>\n\n<output_format>\nJSON with \"elements\" array. Each element has:\n- identifier: ac_ prefix + descriptive snake_case name (NO REPOSITORY NAME!)\n- name: Title Case descriptive name\n- documentation: Brief description of what this component contains\n- source: Source directory node ID\n- confidence: 0.7-1.0 (use 0.7-0.8 for uncertain mappings)\n</output_format>\n\n<determinism>\nGiven identical directories, always produce identical output. Output stable, deterministic results.\n</determinism>\n\n</application_component_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"ac_backend\",\n      \"name\": \"Backend\",\n      \"documentation\": \"Server-side application containing API endpoints and business logic\",\n      \"source\": \"dir_backend\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"ac_frontend\",\n      \"name\": \"Frontend\",\n      \"documentation\": \"Client-side web application with user interface components\",\n      \"source\": \"dir_frontend\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"ac_core\",\n      \"name\": \"Core\",\n      \"documentation\": \"Core application logic and domain services\",\n      \"source\": \"dir_src\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-12T22:47:43.776290"
  },
  {
    "id": 357,
    "step_name": "ApplicationComponent",
    "phase": "generate",
    "version": 7,
    "sequence": 1,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Directory`)\nWHERE n.active = true\n  AND NOT n.name IN ['__pycache__', 'node_modules', '.git', '.venv', 'venv', 'dist', 'build',\n                     'static', 'assets', 'public', 'images', 'img', 'css', 'js', 'fonts',\n                     'templates', 'views', 'layouts', 'partials']\n  AND NOT n.path =~ '.*(test|spec|__pycache__|node_modules|\\\\.git|\\\\.venv|venv|dist|build).*'\nRETURN n.id as id, n.name as name, labels(n) as labels, properties(n) as properties",
    "input_model_query": null,
    "instruction": "<application_component_derivation>\n\n<definition>\nAn ApplicationComponent represents a modular, deployable part of a software system that encapsulates its behavior and data. In ArchiMate, these are structural elements representing logical groupings of functionality.\n</definition>\n\n<canonical_identifiers>\nUse these canonical identifiers when a directory clearly matches the pattern. For directories that don't match, create a descriptive identifier following the naming convention.\n\n| Directory Pattern | Identifier | Name | When to Use |\n|-------------------|------------|------|-------------|\n| backend/, server/, api/ | ac_backend | Backend | Server-side application code |\n| frontend/, client/, ui/, web/, webapp/ | ac_frontend | Frontend | Client-side application code |\n| src/, app/, main/, core/ | ac_core | Core | Main application logic |\n| api/, routes/, endpoints/ | ac_api | API | API layer/routing |\n| services/, handlers/, jobs/ | ac_services | Services | Service layer, background jobs |\n| models/, entities/, domain/ | ac_models | Models | Data model layer |\n| utils/, lib/, common/, shared/ | ac_common | Common | Shared utilities |\n\nNAMING RULES:\n1. Use snake_case with ac_ prefix for identifiers (e.g., ac_kafka, ac_streaming)\n2. NEVER include repository name in identifier (Wrong: ac_lightblue_core, Correct: ac_core)\n3. When a directory doesn't match canonical patterns, create a meaningful identifier based on its purpose\n4. Maximum 5-7 ApplicationComponents per repository\n5. For any non-trivial codebase with multiple directories, you SHOULD identify at least 2-3 components\n6. Prefer descriptive identifiers over omitting architecturally significant directories\n</canonical_identifiers>\n\n<selection_criteria>\nMUST INCLUDE directories that:\n- Represent cohesive functional units with related code\n- Have high pagerank (structurally important)\n- Contain multiple source files or are key architectural boundaries\n- Handle specific domain functionality (e.g., messaging, streaming, data processing)\n\nEXCLUDE only these directories:\n- Build artifacts (dist/, build/, node_modules/, __pycache__/)\n- Documentation only (docs/, .github/)\n- Configuration only without code (config/ if just config files)\n- Empty or trivial directories\n</selection_criteria>\n\n<important>\nWhen in doubt about a directory, CREATE an element with lower confidence (0.7-0.8) rather than omitting it. It's better to have comprehensive coverage that can be refined later than to miss architecturally significant components.\n\nFor repositories with streaming, messaging, or data processing code (Kafka, Spark, etc.), these functional areas should typically become ApplicationComponents.\n</important>\n\n<output_format>\nJSON with \"elements\" array. Each element has:\n- identifier: ac_ prefix + descriptive snake_case name\n- name: Title Case descriptive name\n- documentation: Brief description of what this component contains\n- source: Source directory node ID\n- confidence: 0.7-1.0 (use 0.7-0.8 for uncertain mappings)\n</output_format>\n\n<determinism>\nGiven identical directories, always produce identical output. Output stable, deterministic results.\n</determinism>\n\n</application_component_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"ac_backend\",\n      \"name\": \"Backend\",\n      \"documentation\": \"Server-side application containing API endpoints and business logic\",\n      \"source\": \"dir_backend\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"ac_frontend\",\n      \"name\": \"Frontend\",\n      \"documentation\": \"Client-side web application with user interface components\",\n      \"source\": \"dir_frontend\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"ac_core\",\n      \"name\": \"Core\",\n      \"documentation\": \"Core application logic and domain services\",\n      \"source\": \"dir_src\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-12T22:43:58.064062"
  },
  {
    "id": 356,
    "step_name": "ApplicationComponent",
    "phase": "generate",
    "version": 6,
    "sequence": 1,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Directory`)\nWHERE n.active = true\n  AND NOT n.name IN ['__pycache__', 'node_modules', '.git', '.venv', 'venv', 'dist', 'build',\n                     'static', 'assets', 'public', 'images', 'img', 'css', 'js', 'fonts',\n                     'templates', 'views', 'layouts', 'partials']\n  AND NOT n.path =~ '.*(test|spec|__pycache__|node_modules|\\\\.git|\\\\.venv|venv|dist|build).*'\nRETURN n.id as id, n.name as name, labels(n) as labels, properties(n) as properties",
    "input_model_query": null,
    "instruction": "<application_component_derivation>\n\n<definition>\nAn ApplicationComponent represents a modular, deployable part of a software system that encapsulates its behavior and data. In ArchiMate, these are structural elements representing logical groupings of functionality.\n</definition>\n\n<canonical_identifiers>\nUse these canonical identifiers when a directory clearly matches the pattern. For directories that don't match, create a descriptive identifier following the naming convention.\n\n| Directory Pattern | Identifier | Name | When to Use |\n|-------------------|------------|------|-------------|\n| backend/, server/, api/ | ac_backend | Backend | Server-side application code |\n| frontend/, client/, ui/, web/, webapp/ | ac_frontend | Frontend | Client-side application code |\n| src/, app/, main/, core/ | ac_core | Core | Main application logic |\n| api/, routes/, endpoints/ | ac_api | API | API layer/routing |\n| services/, handlers/, jobs/ | ac_services | Services | Service layer, background jobs |\n| models/, entities/, domain/ | ac_models | Models | Data model layer |\n| utils/, lib/, common/, shared/ | ac_common | Common | Shared utilities |\n\nNAMING RULES:\n1. Use snake_case with ac_ prefix for identifiers (e.g., ac_kafka, ac_streaming)\n2. When a directory doesn't match canonical patterns, create a meaningful identifier based on its purpose\n3. Maximum 5-7 ApplicationComponents per repository\n4. For any non-trivial codebase with multiple directories, you SHOULD identify at least 2-3 components\n5. Prefer descriptive identifiers over omitting architecturally significant directories\n</canonical_identifiers>\n\n<selection_criteria>\nMUST INCLUDE directories that:\n- Represent cohesive functional units with related code\n- Have high pagerank (structurally important)\n- Contain multiple source files or are key architectural boundaries\n- Handle specific domain functionality (e.g., messaging, streaming, data processing)\n\nEXCLUDE only these directories:\n- Build artifacts (dist/, build/, node_modules/, __pycache__/)\n- Documentation only (docs/, .github/)\n- Configuration only without code (config/ if just config files)\n- Empty or trivial directories\n</selection_criteria>\n\n<important>\nWhen in doubt about a directory, CREATE an element with lower confidence (0.7-0.8) rather than omitting it. It's better to have comprehensive coverage that can be refined later than to miss architecturally significant components.\n\nFor repositories with streaming, messaging, or data processing code (Kafka, Spark, etc.), these functional areas should typically become ApplicationComponents.\n</important>\n\n<output_format>\nJSON with \"elements\" array. Each element has:\n- identifier: ac_ prefix + descriptive snake_case name\n- name: Title Case descriptive name\n- documentation: Brief description of what this component contains\n- source: Source directory node ID\n- confidence: 0.7-1.0 (use 0.7-0.8 for uncertain mappings)\n</output_format>\n\n<determinism>\nGiven identical directories, always produce identical output. Output stable, deterministic results.\n</determinism>\n\n</application_component_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"ac_backend\",\n      \"name\": \"Backend\",\n      \"documentation\": \"Server-side application containing API endpoints and business logic\",\n      \"source\": \"dir_backend\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"ac_frontend\",\n      \"name\": \"Frontend\",\n      \"documentation\": \"Client-side web application with user interface components\",\n      \"source\": \"dir_frontend\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"ac_core\",\n      \"name\": \"Core\",\n      \"documentation\": \"Core application logic and domain services\",\n      \"source\": \"dir_src\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-12T17:14:28.236063"
  },
  {
    "id": 350,
    "step_name": "ApplicationComponent",
    "phase": "generate",
    "version": 5,
    "sequence": 1,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Directory`)\nWHERE n.active = true\n  AND NOT n.name IN ['__pycache__', 'node_modules', '.git', '.venv', 'venv', 'dist', 'build',\n                     'static', 'assets', 'public', 'images', 'img', 'css', 'js', 'fonts',\n                     'templates', 'views', 'layouts', 'partials']\n  AND NOT n.path =~ '.*(test|spec|__pycache__|node_modules|\\\\.git|\\\\.venv|venv|dist|build).*'\nRETURN n.id as id, n.name as name, labels(n) as labels, properties(n) as properties",
    "input_model_query": null,
    "instruction": "<application_component_derivation>\n\n<definition>\nAn ApplicationComponent represents a modular, deployable part of a software system that encapsulates its behavior and data. In ArchiMate, these are structural elements representing logical groupings of functionality.\n</definition>\n\n<canonical_identifiers>\nYou MUST use ONLY these exact identifiers. Select the ones that apply to the repository:\n\n| Directory Pattern | Identifier | Name | When to Use |\n|-------------------|------------|------|-------------|\n| backend/, server/, api/ | ac_backend | Backend | Server-side application code |\n| frontend/, client/, ui/, web/ | ac_frontend | Frontend | Client-side application code |\n| src/, app/, main/, core/ | ac_core | Core | Main application logic |\n| api/, routes/, endpoints/ | ac_api | API | API layer/routing |\n| services/, handlers/ | ac_services | Services | Service layer |\n| models/, entities/, domain/ | ac_models | Models | Data model layer |\n| utils/, lib/, common/, shared/ | ac_common | Common | Shared utilities |\n| tests/, test/, spec/ | ac_tests | Tests | Test suite (only if prominent) |\n\nCRITICAL RULES:\n1. Use EXACTLY these identifiers - do not invent variants\n2. Maximum 4-5 ApplicationComponents per repository\n3. Map directories to the CLOSEST canonical pattern\n4. If a directory doesn't match any pattern, do not create an element for it\n5. Prefer fewer, broader components over many specific ones\n</canonical_identifiers>\n\n<selection_criteria>\nInclude directories that:\n- Represent cohesive functional units (backend, frontend, api)\n- Have high pagerank (structurally important)\n- Contain multiple source files\n\nExclude directories that:\n- Are configuration only (config/, settings/)\n- Are build artifacts (dist/, build/, node_modules/)\n- Are documentation (docs/, .github/)\n- Have no source code files\n</selection_criteria>\n\n<output_format>\nJSON with \"elements\" array. Each element has:\n- identifier: EXACTLY from the canonical table above\n- name: EXACTLY from the canonical table above\n- documentation: Brief description of what this component contains\n- source: Source directory node ID\n- confidence: 0.8-1.0\n</output_format>\n\n<determinism>\nGiven identical directories, always produce identical output. When uncertain, choose the more generic canonical identifier.\n</determinism>\n\n</application_component_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"ac_backend\",\n      \"name\": \"Backend\",\n      \"documentation\": \"Server-side application containing API endpoints and business logic\",\n      \"source\": \"dir_backend\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"ac_frontend\",\n      \"name\": \"Frontend\",\n      \"documentation\": \"Client-side web application with user interface components\",\n      \"source\": \"dir_frontend\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"ac_core\",\n      \"name\": \"Core\",\n      \"documentation\": \"Core application logic and domain services\",\n      \"source\": \"dir_src\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T18:28:28.660542"
  },
  {
    "id": 314,
    "step_name": "ApplicationComponent",
    "phase": "generate",
    "version": 3,
    "sequence": 1,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Directory`)\nWHERE n.active = true\n  AND NOT n.name IN ['__pycache__', 'node_modules', '.git', '.venv', 'venv', 'dist', 'build',\n                     'static', 'assets', 'public', 'images', 'img', 'css', 'js', 'fonts',\n                     'templates', 'views', 'layouts', 'partials']\n  AND NOT n.path =~ '.*(test|spec|__pycache__|node_modules|\\\\.git|\\\\.venv|venv|dist|build).*'\nRETURN n.id as id, n.name as name, labels(n) as labels, properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying ApplicationComponent elements from source code files.\n\nAn ApplicationComponent represents a modular unit of functionality that encapsulates implementation.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include files with pagerank > median (structurally important)\n2. Include files with in_degree >= 2 (imported by multiple modules)\n3. Prefer files in k-core >= 2 (core application modules)\n4. Exclude files with out_degree = 0 AND in_degree = 0 (isolated utilities)\n\nINCLUDE files that:\n- Contain business logic or domain operations\n- Define API endpoints or service interfaces\n- Implement core application features\n\nEXCLUDE files that:\n- Are configuration only (config.py, settings.py)\n- Are purely tests or fixtures\n- Are database migrations or seeds\n\nNAMING RULES (MANDATORY):\n1. Identifier: ac_<module_name>\n2. Use lowercase snake_case\n3. Extract module name from file path\n4. Remove common suffixes: _module, _service, _controller\n\nLIMIT: Maximum 5-8 ApplicationComponent elements.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"appcomp_user_service\",\n      \"name\": \"User Service\",\n      \"documentation\": \"Handles user authentication, registration, and profile management\",\n      \"source\": \"dir_myproject_src_services_user\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"appcomp_frontend\",\n      \"name\": \"Frontend Application\",\n      \"documentation\": \"React-based web interface for the application\",\n      \"source\": \"dir_myproject_frontend\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-09T22:57:18.679392"
  },
  {
    "id": 102,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 1,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying ApplicationService elements from source code methods.\n\nAn ApplicationService represents explicitly exposed application behavior:\n- Web routes and API endpoints\n- Service interfaces that external clients can call\n- Handlers that respond to external requests\n\nEach candidate includes method information and graph metrics.\n\nReview each candidate and decide which should become ApplicationService elements.\n\nINCLUDE methods that:\n- Handle HTTP requests (routes, endpoints, views)\n- Expose functionality to external clients\n- Are entry points for user interactions\n- Have names suggesting they respond to requests\n\nEXCLUDE methods that:\n- Are internal/private helpers\n- Are utility functions\n- Are lifecycle methods (__init__, setup, etc.)\n- Only perform internal processing\n\nWhen naming:\n- Use service-oriented names (e.g., \"Invoice Form Service\" not \"invoice_form\")\n- Describe what the service provides\n\nNAMING RULES REMINDER:\n- Use lowercase snake_case for identifiers\n- Use consistent prefix for element type\n- Keep names generic and stable\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_invoice_form\",\n      \"name\": \"Invoice Form Service\",\n      \"documentation\": \"Web endpoint for creating and managing invoice data through a form interface\",\n      \"source\": \"method_invoice_form\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_export_pdf\",\n      \"name\": \"PDF Export Service\",\n      \"documentation\": \"Endpoint for generating and downloading invoice PDFs\",\n      \"source\": \"method_invoice_pdf\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.089040"
  },
  {
    "id": 218,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 2,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying ApplicationService elements from source code methods.\n\nAn ApplicationService represents explicitly exposed application behavior:\n- Web routes and API endpoints (Flask routes, Express handlers)\n- Service interfaces that external clients can call\n- Entry points for user-facing functionality\n\nReview each candidate and ONLY create ApplicationService elements for PRIMARY entry points.\n\nINCLUDE methods that:\n- Handle HTTP requests (routes, endpoints, views)\n- Are decorated with @app.route, @router.get, etc.\n- Are the main entry point for a user action\n- Have names like: index, create, update, delete, list, show\n\nEXCLUDE methods that:\n- Are internal/private helpers (start with _)\n- Are utility functions (formatters, validators, checks)\n- Are lifecycle methods (__init__, setup, teardown)\n- Are callback handlers or hooks\n- Are filter functions (like Jinja filters)\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: as_<action>_<entity>\n2. Use Title Case for display name\n3. Derive name from the method's primary function, not repo-specific terms\n4. Group similar routes into logical services (e.g., form handling, data export)\n5. Keep names generic and applicable to any codebase\n\nSTRICT RULES:\n1. ONLY create ApplicationService for route handlers, NOT for helper methods\n2. Max 3-5 ApplicationService elements per application\n3. Group similar functionality - don't create separate services for each route\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_create_entity\",\n      \"name\": \"Create Entity Service\",\n      \"documentation\": \"Web endpoint for creating new entities through a form interface\",\n      \"source\": \"method_create_form\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_export_document\",\n      \"name\": \"Document Export Service\",\n      \"documentation\": \"Endpoint for generating and exporting documents\",\n      \"source\": \"method_export\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-08T13:16:55.257636"
  },
  {
    "id": 329,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 6,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<application_service_derivation>\nYou are deriving ApplicationService elements from methods in a software repository.\n\n<definition>\nAn ApplicationService represents an externally visible unit of functionality provided by an application. In ArchiMate, ApplicationServices are behavioral elements named with VERB PHRASES.\n</definition>\n\n<selection_criteria>\nInclude methods that:\n- Have high in_degree (called by multiple other components)\n- Have high pagerank (central to application flow)\n- Are HTTP route handlers or public API endpoints\n- Perform business logic operations\n\nExclude methods that:\n- Are internal utilities (low in_degree, low pagerank)\n- Are framework lifecycle hooks\n- Are database/ORM operations (these become TechnologyService)\n</selection_criteria>\n\n<naming_rules>\n1. Identifier format: as_<action_verb>_<generic_noun>\n2. Use lowercase snake_case\n3. Use SINGULAR noun form always\n4. Use GENERIC nouns, not entity-specific nouns\n\nIMPORTANT: Use ONLY these exact identifiers:\n- as_manage_entity (for ANY CRUD operations on business objects)\n- as_validate_data (for ANY validation operations)\n- as_generate_document (for ANY document/report generation)\n- as_export_data (for ANY export/download operations)\n\nDO NOT create ApplicationService for:\n- Entity-specific names (use generic as_manage_entity instead)\n- Methods with low in_degree (internal utilities, not exposed services)\n- Methods with low pagerank (peripheral functionality)\n- Framework initialization or lifecycle methods\n</naming_rules>\n\n<constraints>\n- Maximum 4-5 ApplicationService elements\n- Derive names from the method's business PURPOSE, not its technical name\n- When uncertain between variants, choose the more generic form\n</constraints>\n\n<determinism>\nGiven identical input, always produce identical output. Prefer stability over precision - use consistent canonical names rather than varying descriptive names.\n</determinism>\n</application_service_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_create_entity\",\n      \"name\": \"Create Entity Service\",\n      \"documentation\": \"Web endpoint for creating new entities through a form interface\",\n      \"source\": \"method_create_form\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_export_document\",\n      \"name\": \"Document Export Service\",\n      \"documentation\": \"Endpoint for generating and exporting documents\",\n      \"source\": \"method_export\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T07:53:11.775067"
  },
  {
    "id": 383,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 18,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<persona>\nYou are a senior enterprise architect with 15+ years of ArchiMate 3.2 expertise. You value semantic precision and consistent terminology above all else. You identify application services based on business capabilities, not code structure.\n</persona>\n\n<definition>\nAn ApplicationService represents a coherent piece of functionality that fulfills a specific business need. Services expose behavior through interfaces and are realized by application components.\n</definition>\n\n<semantic_exclusions>\nAn ApplicationService is NOT:\n- An ApplicationFunction (internal behavior, not exposed)\n- An ApplicationProcess (sequence of activities, not a capability)\n- A technical API endpoint (unless it represents a business-facing capability)\n- A CRUD operation (create/read/update/delete is not a service)\n- An infrastructure service (caching, logging, database access)\n\nDO NOT:\n- Create multiple ApplicationServices for the same capability exposed via different protocols\n- Model internal utility functions as services\n- Create services for framework lifecycle methods\n- Model technical cross-cutting concerns (caching, logging, metrics) as services\n- Create fine-grained services when a broader capability applies\n</semantic_exclusions>\n\n<scope_constraint>\nBUSINESS-FACING ONLY: Only model services that provide business value to external consumers.\n\nDO NOT model as ApplicationService:\n- Caching services\n- Logging services\n- Database access layers\n- Message queue handlers (unless business-facing)\n- Health check endpoints\n</scope_constraint>\n\n<capability_test>\nVALIDATION RULE (apply to every candidate):\nA candidate ApplicationService must answer \"What business outcome does this enable?\" in one sentence WITHOUT referring to technical mechanisms.\n\nREJECT or MERGE if the description:\n- Starts with \"manages\", \"handles\", or \"provides access to\" without a business outcome\n- Describes technical implementation rather than business value\n- Cannot be explained to a business stakeholder\n- Is a sub-capability of a broader service (merge into parent)\n\nExample VALID: \"Enables customers to place and track orders\"\nExample INVALID: \"Handles HTTP requests for user data\"\nExample MERGE: \"Generates invoices\" → merge into as_order_management\n</capability_test>\n\n<broad_capability_rule>\nPREFER BROADER CAPABILITIES: When in doubt, merge into a broader service.\n\nMERGE EXAMPLES:\n- Invoice generation → as_order_management\n- Email sending → as_notification\n- Profile updates → as_user_management\n- Password reset → as_authentication\n\nOnly create a separate service when:\n- It serves a different business domain\n- It has distinct consumers\n- It represents a standalone product capability\n</broad_capability_rule>\n\n<naming_rules>\nIDENTIFIER FORMAT (MANDATORY):\n- Prefix: as_\n- Format: as_<capability_noun>\n- Style: lowercase snake_case\n- NEVER include repository name\n\nNORMALIZATION PRECEDENCE (apply in order):\n1. Prefer canonical patterns over derived names\n2. Prefer broader capability names over sub-capabilities\n3. Prefer nouns over verbs in identifiers\n4. Prefer industry-standard terms when available\n\nCONFLICT RESOLUTION:\n- as_user_profile vs as_user_management → choose as_user_management (broader)\n- as_send_email vs as_notification → choose as_notification (standard term)\n- as_auth vs as_authentication → choose as_authentication (explicit)\n- as_invoice_generation vs as_order_management → choose as_order_management (broader)\n</naming_rules>\n\n<canonical_patterns>\n| Capability | Identifier | Name |\n|------------|------------|------|\n| Login, sessions, tokens, password reset | as_authentication | Authentication Service |\n| User CRUD, profiles, accounts, preferences | as_user_management | User Management Service |\n| Payment processing, billing, refunds | as_payment | Payment Service |\n| Order lifecycle, checkout, invoicing | as_order_management | Order Management Service |\n| Email, SMS, push notifications | as_notification | Notification Service |\n| Search, indexing, queries | as_search | Search Service |\n| File upload, storage, retrieval | as_file_management | File Management Service |\n| Reports, analytics, dashboards, exports | as_reporting | Reporting Service |\n| Core domain data operations | as_data_management | Data Management Service |\n| Scheduling, jobs, workflows | as_scheduling | Scheduling Service |\n</canonical_patterns>\n\n<selection_criteria>\nINCLUDE services that:\n- Provide distinct business capabilities\n- Can be explained without technical jargon\n- Are reusable across multiple consumers\n- Have clear input/output contracts\n- Serve external business needs\n\nEXCLUDE:\n- Internal utilities and helpers\n- Framework-specific handlers\n- Configuration loaders\n- Test utilities\n- Infrastructure services (caching, logging, metrics)\n</selection_criteria>\n\n<granularity_rules>\nTARGET: 3-8 ApplicationServices per repository\n\nESCALATION RULES:\n- If > 8 candidates: merge into broader capabilities until <= 8\n- If < 3 candidates: reassess for missing cross-cutting capabilities:\n  - Authentication (if login/security code exists)\n  - Notification (if email/messaging code exists)\n  - Reporting (if analytics/export code exists)\n</granularity_rules>\n\n<realization_constraint>\nEach ApplicationService must be realizable by at least one ApplicationComponent inferred from the repository.\n\nIf no plausible realizing component exists, do not create the service.\n</realization_constraint>\n\n<determinism>\nORDERING: Sort elements alphabetically by identifier.\n\nCONFIDENCE BANDS (fixed):\n- 0.9-1.0: Canonical patterns with clear code evidence\n- 0.8-0.89: Clear derived capabilities with strong signals\n- 0.7-0.79: Inferred or ambiguous cases\n\nCONSISTENCY:\n- Do not invent synonyms across runs\n- Use identical identifiers for identical capabilities\n- Given identical input, produce identical output\n</determinism>\n\n<output_format>\nJSON with \"elements\" array containing:\n- identifier: as_ prefix + capability noun (snake_case)\n- name: Title Case service name\n- documentation: One sentence describing business outcome (not technical implementation)\n- source: Source node ID\n- confidence: Per confidence bands above\n</output_format>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_manage_entity\",\n      \"name\": \"Entity Management Service\",\n      \"documentation\": \"CRUD operations on business entities - creating, reading, updating, and deleting business data\",\n      \"source\": \"method_create_item\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_authenticate_user\",\n      \"name\": \"User Authentication Service\",\n      \"documentation\": \"Handles user login, logout, and session management\",\n      \"source\": \"method_login\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": "{\"temperature\": 0.0}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T21:53:30.297336"
  },
  {
    "id": 330,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 7,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<application_service_derivation>\nYou are deriving ApplicationService elements from methods in a software repository.\n\n<definition>\nAn ApplicationService represents an externally visible unit of functionality provided by an application. In ArchiMate, ApplicationServices are behavioral elements named with VERB PHRASES describing the business action.\n</definition>\n\n<selection_criteria>\nInclude methods that:\n- Have high in_degree (called by multiple components) or high pagerank\n- Are HTTP route handlers or public API endpoints\n- Perform distinct business operations\n\nExclude methods that:\n- Are internal utilities (low structural importance)\n- Are framework lifecycle hooks\n- Are pure data access (use TechnologyService)\n</selection_criteria>\n\n<naming_patterns>\nIdentifier format: as_<verb>_<noun>\n\nUse these verb categories consistently:\n- manage: CRUD operations on business entities\n- validate: input/data validation\n- generate: document/report creation\n- export: data export/download\n- process: data transformation/workflow\n- search: query/filter operations\n\nNaming principles:\n1. Lowercase snake_case: as_manage_order\n2. Singular nouns: as_manage_order (not as_manage_orders)\n3. Group related operations: multiple validation methods → single validation service\n4. Prefer domain terms over technical terms\n</naming_patterns>\n\n<consistency_guidance>\nWhen naming, ask: \"If I saw this same functionality in a different repository, would I use the same name?\"\n\nConsistent: as_validate_data (generic, reusable pattern)\nInconsistent: as_validate_invoice_data (too specific to one domain)\n\nThe goal is names that work across any repository while still being meaningful.\n</consistency_guidance>\n\n<constraints>\n- Maximum 4-6 ApplicationService elements\n- Each service should represent a distinct business capability\n- When uncertain, choose the more general form\n</constraints>\n</application_service_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_create_entity\",\n      \"name\": \"Create Entity Service\",\n      \"documentation\": \"Web endpoint for creating new entities through a form interface\",\n      \"source\": \"method_create_form\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_export_document\",\n      \"name\": \"Document Export Service\",\n      \"documentation\": \"Endpoint for generating and exporting documents\",\n      \"source\": \"method_export\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T07:55:15.953396"
  },
  {
    "id": 375,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 16,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<application_service_derivation>\n\n<definition>\nAn ApplicationService represents exposed application behavior - functionality that serves users or other systems.\n</definition>\n\n<canonical_identifiers>\nYou MUST use ONLY these exact identifiers. Select the ones that apply:\n\n| Category | Identifier | Name | When to Use |\n|----------|------------|------|-------------|\n| Entity CRUD | as_manage_entity | Entity Management Service | Any create/read/update/delete on business data |\n| Validation | as_validate_data | Data Validation Service | Any input validation, form checking |\n| Document Generation | as_generate_document | Document Generation Service | PDF, report, export file creation |\n| Authentication | as_authenticate_user | User Authentication Service | Login, logout, session management |\n| Notification | as_send_notification | Notification Service | Email, SMS, push notifications |\n\nCRITICAL RULES:\n1. Use EXACTLY these identifiers - do not invent variants\n2. as_manage_entity covers ALL CRUD operations (not as_manage_user, as_manage_item)\n3. as_authenticate_user covers ALL auth operations (not as_handle_authentication)\n4. Maximum 3-4 services per application\n</canonical_identifiers>\n\n<selection>\nInclude methods that:\n- Are HTTP route handlers or API endpoints\n- Have high in_degree (called by multiple places)\n- Perform distinct business operations\n\nExclude:\n- Internal utilities (formatters, helpers)\n- Framework lifecycle methods\n- Data access layer methods\n</selection>\n\n<output>\nJSON with \"elements\" array. Each element has:\n- identifier: EXACTLY from the table above\n- name: EXACTLY from the table above\n- documentation: Business purpose description\n- source: Source node ID\n- confidence: 0.8-1.0\n</output>\n\n</application_service_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_manage_entity\",\n      \"name\": \"Entity Management Service\",\n      \"documentation\": \"CRUD operations on business entities - creating, reading, updating, and deleting business data\",\n      \"source\": \"method_create_item\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_authenticate_user\",\n      \"name\": \"User Authentication Service\",\n      \"documentation\": \"Handles user login, logout, and session management\",\n      \"source\": \"method_login\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": "{\"temperature\": 0.0}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T19:06:20.361310"
  },
  {
    "id": 336,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 13,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<application_service_derivation>\n\n<definition>\nAn ApplicationService represents exposed application behavior - functionality that serves users or other systems. Per ArchiMate, name services with verb phrases.\n</definition>\n\n<derivation_approach>\nAnalyze the methods to identify DISTINCT CATEGORIES of exposed functionality. Group related operations under a single service.\n\nKey question for each method: \"What TYPE of operation is this?\"\n- CRUD operations → group under entity management\n- Input checking → group under validation\n- Report/PDF generation → group under document generation\n- Download/export → group under data export\n</derivation_approach>\n\n<naming>\nFormat: as_<action>_<category>\n- Use generic category names (data, entity, document) rather than domain-specific names\n- Lowercase snake_case for identifier\n- Title Case with \"Service\" suffix for name\n\nThe goal: if this same method existed in a different application, would the service name still make sense?\n</naming>\n\n<constraints>\n- 3-4 distinct services maximum\n- One service per category of behavior\n- Omit internal utilities, formatters, and framework methods\n</constraints>\n\n</application_service_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_manage_entity\",\n      \"name\": \"Entity Management Service\",\n      \"documentation\": \"CRUD operations on business entities - creating, reading, updating, and deleting business data\",\n      \"source\": \"method_create_item\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_validate_data\",\n      \"name\": \"Data Validation Service\",\n      \"documentation\": \"Validates input data and business rules before processing\",\n      \"source\": \"method_validate_input\",\n      \"confidence\": 0.85\n    },\n    {\n      \"identifier\": \"as_generate_document\",\n      \"name\": \"Document Generation Service\",\n      \"documentation\": \"Generates reports, PDFs, and other output documents\",\n      \"source\": \"method_render_pdf\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T08:09:10.058621"
  },
  {
    "id": 335,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 12,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<application_service_derivation>\n\n<task>\nDerive ApplicationService elements from the provided methods. An ApplicationService represents exposed application behavior that serves users or other systems.\n</task>\n\n<abstraction_principle>\nThe key to consistent derivation is choosing the RIGHT ABSTRACTION LEVEL.\n\nExample - if you see methods like:\n- validate_invoice_input()\n- validate_order_data()\n- check_customer_info()\n\nThese are all VALIDATION operations. Derive ONE service: as_validate_data\n\nDo NOT create as_validate_invoice, as_validate_order - these are too specific and will vary between repositories.\n</abstraction_principle>\n\n<naming_format>\nIdentifier: as_<action>_<category>\n\nCommon categories (use these generic terms):\n- data: for any business data operations\n- document: for reports, PDFs, exports\n- entity: for CRUD operations on business objects\n\nFormat: lowercase_snake_case\nName: Title Case with \"Service\" suffix\n</naming_format>\n\n<constraints>\n- Maximum 3-4 services\n- Each service = one category of behavior\n- Ignore internal utilities and formatting helpers\n</constraints>\n\n<output>\nJSON array of elements with: identifier, name, documentation, source, confidence\n</output>\n\n</application_service_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_create_entity\",\n      \"name\": \"Create Entity Service\",\n      \"documentation\": \"Web endpoint for creating new entities through a form interface\",\n      \"source\": \"method_create_form\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_export_document\",\n      \"name\": \"Document Export Service\",\n      \"documentation\": \"Endpoint for generating and exporting documents\",\n      \"source\": \"method_export\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T08:08:35.624334"
  },
  {
    "id": 334,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 11,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\n  AND (n.in_degree >= 2 OR n.pagerank > 0.01)\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties\nORDER BY n.pagerank DESC\nLIMIT 20",
    "input_model_query": null,
    "instruction": "<application_service_derivation>\n\n<task>\nDerive ApplicationService elements from the provided methods. An ApplicationService represents exposed application behavior that serves users or other systems.\n</task>\n\n<abstraction_principle>\nThe key to consistent derivation is choosing the RIGHT ABSTRACTION LEVEL.\n\nExample - if you see methods like:\n- validate_invoice_input()\n- validate_order_data()\n- check_customer_info()\n\nThese are all VALIDATION operations. Derive ONE service: as_validate_data\n\nDo NOT create as_validate_invoice, as_validate_order - these are too specific and will vary between repositories.\n</abstraction_principle>\n\n<naming_format>\nIdentifier: as_<action>_<category>\n\nCommon categories (use these generic terms):\n- data: for any business data operations\n- document: for reports, PDFs, exports\n- entity: for CRUD operations on business objects\n\nFormat: lowercase_snake_case\nName: Title Case with \"Service\" suffix\n</naming_format>\n\n<constraints>\n- Maximum 3-4 services\n- Each service = one category of behavior\n- Ignore internal utilities and formatting helpers\n</constraints>\n\n<output>\nJSON array of elements with: identifier, name, documentation, source, confidence\n</output>\n\n</application_service_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_create_entity\",\n      \"name\": \"Create Entity Service\",\n      \"documentation\": \"Web endpoint for creating new entities through a form interface\",\n      \"source\": \"method_create_form\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_export_document\",\n      \"name\": \"Document Export Service\",\n      \"documentation\": \"Endpoint for generating and exporting documents\",\n      \"source\": \"method_export\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T08:07:13.868775"
  },
  {
    "id": 349,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 14,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<application_service_derivation>\n\n<definition>\nAn ApplicationService represents exposed application behavior - functionality that serves users or other systems.\n</definition>\n\n<canonical_identifiers>\nYou MUST use ONLY these exact identifiers. Select the ones that apply:\n\n| Category | Identifier | Name | When to Use |\n|----------|------------|------|-------------|\n| Entity CRUD | as_manage_entity | Entity Management Service | Any create/read/update/delete on business data |\n| Validation | as_validate_data | Data Validation Service | Any input validation, form checking |\n| Document Generation | as_generate_document | Document Generation Service | PDF, report, export file creation |\n| Authentication | as_authenticate_user | User Authentication Service | Login, logout, session management |\n| Notification | as_send_notification | Notification Service | Email, SMS, push notifications |\n\nCRITICAL RULES:\n1. Use EXACTLY these identifiers - do not invent variants\n2. as_manage_entity covers ALL CRUD operations (not as_manage_user, as_manage_item)\n3. as_authenticate_user covers ALL auth operations (not as_handle_authentication)\n4. Maximum 3-4 services per application\n</canonical_identifiers>\n\n<selection>\nInclude methods that:\n- Are HTTP route handlers or API endpoints\n- Have high in_degree (called by multiple places)\n- Perform distinct business operations\n\nExclude:\n- Internal utilities (formatters, helpers)\n- Framework lifecycle methods\n- Data access layer methods\n</selection>\n\n<output>\nJSON with \"elements\" array. Each element has:\n- identifier: EXACTLY from the table above\n- name: EXACTLY from the table above\n- documentation: Business purpose description\n- source: Source node ID\n- confidence: 0.8-1.0\n</output>\n\n</application_service_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_manage_entity\",\n      \"name\": \"Entity Management Service\",\n      \"documentation\": \"CRUD operations on business entities - creating, reading, updating, and deleting business data\",\n      \"source\": \"method_create_item\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_authenticate_user\",\n      \"name\": \"User Authentication Service\",\n      \"documentation\": \"Handles user login, logout, and session management\",\n      \"source\": \"method_login\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T17:16:09.576334"
  },
  {
    "id": 381,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 17,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<persona>\nYou are a senior enterprise architect with 15+ years of ArchiMate 3.2 expertise. You value semantic precision and consistent terminology above all else. You identify application services based on business capabilities, not code structure.\n</persona>\n\n<definition>\nAn ApplicationService represents a coherent piece of functionality that fulfills a specific business need. Services expose behavior through interfaces and are realized by application components.\n</definition>\n\n<semantic_exclusions>\nAn ApplicationService is NOT:\n- An ApplicationFunction (internal behavior, not exposed)\n- An ApplicationProcess (sequence of activities, not a capability)\n- A technical API endpoint (unless it represents a business-facing capability)\n- A CRUD operation (create/read/update/delete is not a service)\n\nDO NOT:\n- Create multiple ApplicationServices for the same capability exposed via different protocols\n- Model internal utility functions as services\n- Create services for framework lifecycle methods\n</semantic_exclusions>\n\n<capability_test>\nVALIDATION RULE (apply to every candidate):\nA candidate ApplicationService must answer \"What business outcome does this enable?\" in one sentence WITHOUT referring to technical mechanisms.\n\nREJECT or MERGE if the description:\n- Starts with \"manages\", \"handles\", or \"provides access to\" without a business outcome\n- Describes technical implementation rather than business value\n- Cannot be explained to a business stakeholder\n\nExample VALID: \"Enables customers to place and track orders\"\nExample INVALID: \"Handles HTTP requests for user data\"\n</capability_test>\n\n<naming_rules>\nIDENTIFIER FORMAT (MANDATORY):\n- Prefix: as_\n- Format: as_<capability_noun>\n- Style: lowercase snake_case\n- NEVER include repository name\n\nNORMALIZATION PRECEDENCE (apply in order):\n1. Prefer canonical patterns over derived names\n2. Prefer broader capability names over sub-capabilities\n3. Prefer nouns over verbs in identifiers\n4. Prefer industry-standard terms when available\n\nCONFLICT RESOLUTION:\n- as_user_profile vs as_user_management → choose as_user_management (broader)\n- as_send_email vs as_notification → choose as_notification (standard term)\n- as_auth vs as_authentication → choose as_authentication (explicit)\n</naming_rules>\n\n<canonical_patterns>\n| Capability | Identifier | Name |\n|------------|------------|------|\n| Login, sessions, tokens | as_authentication | Authentication Service |\n| User CRUD, profiles, accounts | as_user_management | User Management Service |\n| Payment processing, billing | as_payment | Payment Service |\n| Order lifecycle, checkout | as_order_management | Order Management Service |\n| Email, SMS, push notifications | as_notification | Notification Service |\n| Search, indexing, queries | as_search | Search Service |\n| File upload, storage, retrieval | as_file_management | File Management Service |\n| Reports, analytics, dashboards | as_reporting | Reporting Service |\n| Data CRUD for domain entities | as_data_management | Data Management Service |\n| Scheduling, jobs, workflows | as_scheduling | Scheduling Service |\n</canonical_patterns>\n\n<selection_criteria>\nINCLUDE services that:\n- Provide distinct business capabilities\n- Can be explained without technical jargon\n- Are reusable across multiple consumers\n- Have clear input/output contracts\n\nEXCLUDE:\n- Internal utilities and helpers\n- Framework-specific handlers\n- Configuration loaders\n- Test utilities\n</selection_criteria>\n\n<granularity_rules>\nTARGET: 3-8 ApplicationServices per repository\n\nESCALATION RULES:\n- If > 8 candidates: merge weakest until <= 8, preferring broader capabilities\n- If < 3 candidates: reassess for missing cross-cutting capabilities:\n  - Authentication (if login/security code exists)\n  - Notification (if email/messaging code exists)\n  - Reporting (if analytics/export code exists)\n</granularity_rules>\n\n<realization_constraint>\nEach ApplicationService must be realizable by at least one ApplicationComponent inferred from the repository.\n\nIf no plausible realizing component exists, do not create the service.\n</realization_constraint>\n\n<determinism>\nORDERING: Sort elements alphabetically by identifier.\n\nCONFIDENCE BANDS (fixed):\n- 0.9-1.0: Canonical patterns with clear code evidence\n- 0.8-0.89: Clear derived capabilities with strong signals\n- 0.7-0.79: Inferred or ambiguous cases\n\nCONSISTENCY:\n- Do not invent synonyms across runs\n- Use identical identifiers for identical capabilities\n- Given identical input, produce identical output\n</determinism>\n\n<output_format>\nJSON with \"elements\" array containing:\n- identifier: as_ prefix + capability noun (snake_case)\n- name: Title Case service name\n- documentation: One sentence describing business outcome\n- source: Source node ID\n- confidence: Per confidence bands above\n</output_format>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_manage_entity\",\n      \"name\": \"Entity Management Service\",\n      \"documentation\": \"CRUD operations on business entities - creating, reading, updating, and deleting business data\",\n      \"source\": \"method_create_item\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_authenticate_user\",\n      \"name\": \"User Authentication Service\",\n      \"documentation\": \"Handles user login, logout, and session management\",\n      \"source\": \"method_login\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": "{\"temperature\": 0.0}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T21:46:13.705211"
  },
  {
    "id": 366,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 15,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<application_service_derivation>\n\n<definition>\nAn ApplicationService represents exposed application behavior - functionality that serves users or other systems.\n</definition>\n\n<canonical_identifiers>\nYou MUST use ONLY these exact identifiers. Select the ones that apply:\n\n| Category | Identifier | Name | When to Use |\n|----------|------------|------|-------------|\n| Entity CRUD | as_manage_entity | Entity Management Service | Any create/read/update/delete on business data |\n| Validation | as_validate_data | Data Validation Service | Any input validation, form checking |\n| Document Generation | as_generate_document | Document Generation Service | PDF, report, export file creation |\n| Authentication | as_authenticate_user | User Authentication Service | Login, logout, session management |\n| Notification | as_send_notification | Notification Service | Email, SMS, push notifications |\n\nCRITICAL RULES:\n1. Use EXACTLY these identifiers - do not invent variants\n2. as_manage_entity covers ALL CRUD operations (not as_manage_user, as_manage_item)\n3. as_authenticate_user covers ALL auth operations (not as_handle_authentication)\n4. Maximum 3-4 services per application\n</canonical_identifiers>\n\n<selection>\nInclude methods that:\n- Are HTTP route handlers or API endpoints\n- Have high in_degree (called by multiple places)\n- Perform distinct business operations\n\nExclude:\n- Internal utilities (formatters, helpers)\n- Framework lifecycle methods\n- Data access layer methods\n</selection>\n\n<output>\nJSON with \"elements\" array. Each element has:\n- identifier: EXACTLY from the table above\n- name: EXACTLY from the table above\n- documentation: Business purpose description\n- source: Source node ID\n- confidence: 0.8-1.0\n</output>\n\n</application_service_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_manage_entity\",\n      \"name\": \"Entity Management Service\",\n      \"documentation\": \"CRUD operations on business entities - creating, reading, updating, and deleting business data\",\n      \"source\": \"method_create_item\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_authenticate_user\",\n      \"name\": \"User Authentication Service\",\n      \"documentation\": \"Handles user login, logout, and session management\",\n      \"source\": \"method_login\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": "{\"temperature\": 0.0}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T16:40:57.642370"
  },
  {
    "id": 323,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 3,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying ApplicationService elements from service implementations.\n\nAn ApplicationService represents an externally visible unit of functionality provided by the application.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include services with in_degree >= 2 (used by multiple clients)\n2. Include services with high pagerank (core functionality)\n3. Prefer services in k-core >= 2 (central to application)\n4. Exclude services with out_degree = 0 (unused)\n\nINCLUDE:\n- Business logic services\n- Data processing services\n- Integration services (external API wrappers)\n- Document/report generation services\n\nEXCLUDE:\n- Low-level utilities\n- Framework-provided services\n- Database access layers (use TechnologyService)\n\nNAMING RULES (MANDATORY):\n1. Identifier: as_<verb>_<noun>\n2. Use lowercase snake_case\n3. Use action-oriented names: as_generate_report, as_validate_data\n4. Group related operations under single service\n\nLIMIT: Maximum 4-6 ApplicationService elements.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_create_entity\",\n      \"name\": \"Create Entity Service\",\n      \"documentation\": \"Web endpoint for creating new entities through a form interface\",\n      \"source\": \"method_create_form\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_export_document\",\n      \"name\": \"Document Export Service\",\n      \"documentation\": \"Endpoint for generating and exporting documents\",\n      \"source\": \"method_export\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-09T22:58:44.646606"
  },
  {
    "id": 333,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 10,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\n  AND (n.in_degree >= 2 OR n.pagerank > 0.01)\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties\nORDER BY n.pagerank DESC\nLIMIT 20",
    "input_model_query": null,
    "instruction": "<application_service_derivation>\n\n<context>\nYou are deriving ArchiMate ApplicationService elements from method signatures in a code repository.\n\nAn ApplicationService represents exposed application behavior - the functionality that users or other systems consume. Per ArchiMate naming conventions, use verb phrases (e.g., \"Invoice Processing\" or \"Payment Service\").\n</context>\n\n<input_data>\nYou receive method information including:\n- Method name and signature\n- Graph metrics: in_degree, pagerank (higher = more central/important)\n- Parent class context\n</input_data>\n\n<selection_criteria>\nInclude methods with HIGH structural importance:\n- in_degree >= 2 (multiple callers = exposed functionality)\n- High pagerank (central to application)\n- HTTP route handlers\n\nExclude:\n- Internal utilities (low in_degree, low pagerank)\n- Framework lifecycle methods\n- Data access operations (these belong to TechnologyService)\n</selection_criteria>\n\n<naming_approach>\nFormat: as_<verb>_<noun> in lowercase_snake_case\n\nThe key to consistency is ABSTRACTION LEVEL:\n- TOO SPECIFIC: as_validate_invoice_input, as_validate_order_data (varies by domain)\n- CORRECT LEVEL: as_validate_data (generalizes across domains)\n\nApply this abstraction principle:\n- Data validation → as_validate_data\n- CRUD on business entities → as_manage_data\n- Document generation → as_generate_document\n- Data export → as_export_data\n\nWhen you encounter domain-specific operations, ask: \"What is the GENERAL category of operation?\" Use that general category as the service name.\n</naming_approach>\n\n<constraints>\n- Output 3-4 ApplicationService elements maximum\n- Each service represents a DISTINCT category of behavior\n- Prefer fewer, broader services over many specific ones\n</constraints>\n\n<output_format>\nJSON with \"elements\" array:\n{\n  \"identifier\": \"as_verb_noun\",\n  \"name\": \"Verb Noun Service\",\n  \"documentation\": \"Business purpose\",\n  \"source\": \"source_node_id\",\n  \"confidence\": 0.8-1.0\n}\n</output_format>\n\n</application_service_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_create_entity\",\n      \"name\": \"Create Entity Service\",\n      \"documentation\": \"Web endpoint for creating new entities through a form interface\",\n      \"source\": \"method_create_form\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_export_document\",\n      \"name\": \"Document Export Service\",\n      \"documentation\": \"Endpoint for generating and exporting documents\",\n      \"source\": \"method_export\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T08:06:51.428419"
  },
  {
    "id": 332,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 9,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<application_service_derivation>\n\n<context>\nYou are deriving ArchiMate ApplicationService elements from method signatures in a code repository.\n\nAn ApplicationService represents exposed application behavior - the functionality that users or other systems consume. Per ArchiMate naming conventions, use verb phrases (e.g., \"Invoice Processing\" or \"Payment Service\").\n</context>\n\n<input_data>\nYou receive method information including:\n- Method name and signature\n- Graph metrics: in_degree, pagerank (higher = more central/important)\n- Parent class context\n</input_data>\n\n<selection_criteria>\nInclude methods with HIGH structural importance:\n- in_degree >= 2 (multiple callers = exposed functionality)\n- High pagerank (central to application)\n- HTTP route handlers\n\nExclude:\n- Internal utilities (low in_degree, low pagerank)\n- Framework lifecycle methods\n- Data access operations (these belong to TechnologyService)\n</selection_criteria>\n\n<naming_approach>\nFormat: as_<verb>_<noun> in lowercase_snake_case\n\nThe key to consistency is ABSTRACTION LEVEL:\n- TOO SPECIFIC: as_validate_invoice_input, as_validate_order_data (varies by domain)\n- CORRECT LEVEL: as_validate_data (generalizes across domains)\n\nApply this abstraction principle:\n- Data validation → as_validate_data\n- CRUD on business entities → as_manage_data\n- Document generation → as_generate_document\n- Data export → as_export_data\n\nWhen you encounter domain-specific operations, ask: \"What is the GENERAL category of operation?\" Use that general category as the service name.\n</naming_approach>\n\n<constraints>\n- Output 3-4 ApplicationService elements maximum\n- Each service represents a DISTINCT category of behavior\n- Prefer fewer, broader services over many specific ones\n</constraints>\n\n<output_format>\nJSON with \"elements\" array:\n{\n  \"identifier\": \"as_verb_noun\",\n  \"name\": \"Verb Noun Service\",\n  \"documentation\": \"Business purpose\",\n  \"source\": \"source_node_id\",\n  \"confidence\": 0.8-1.0\n}\n</output_format>\n\n</application_service_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_create_entity\",\n      \"name\": \"Create Entity Service\",\n      \"documentation\": \"Web endpoint for creating new entities through a form interface\",\n      \"source\": \"method_create_form\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_export_document\",\n      \"name\": \"Document Export Service\",\n      \"documentation\": \"Endpoint for generating and exporting documents\",\n      \"source\": \"method_export\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T08:05:01.745797"
  },
  {
    "id": 331,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 8,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<application_service_derivation>\n\n<archimate_definition>\nAn ApplicationService represents \"explicitly defined exposed application behavior\" - the functionality that an application component makes available to its environment through interfaces.\n\nPer ArchiMate conventions, services should be named using either:\n- Verb-ending format: \"ing\" suffix (e.g., \"Invoice Processing\")\n- Explicit service naming: include \"Service\" (e.g., \"Payment Service\")\n</archimate_definition>\n\n<derivation_task>\nYou are analyzing method signatures from a software repository to identify which methods represent externally exposed services versus internal implementation details.\n\nYour input includes:\n- Method names and signatures\n- Graph metrics: in_degree (callers), out_degree (callees), pagerank (centrality)\n- Parent class/module context\n</derivation_task>\n\n<selection_heuristics>\nMethods likely representing ApplicationServices:\n- High in_degree: called by multiple consumers (exposed functionality)\n- HTTP handlers: @route, @get, @post decorators (web endpoints)\n- Public APIs: explicit interface boundaries\n- High pagerank: central to application flow\n\nMethods that are NOT ApplicationServices:\n- Low in_degree + low pagerank: internal utilities\n- Pure data access: belongs to TechnologyService layer\n- Framework callbacks: __init__, setup, teardown\n- Private methods: implementation details\n</selection_heuristics>\n\n<naming_guidance>\nIdentifier: as_<verb_phrase> using lowercase_snake_case\n\nDerive the verb phrase from the method's BUSINESS PURPOSE:\n- Data entry methods → as_manage_data or as_<verb>_<domain_noun>\n- Validation methods → as_validate_<what>\n- Generation methods → as_generate_<output>\n- Export methods → as_export_<format>\n\nConsistency principle: When multiple methods serve the same business purpose, group them under one service. Ask: \"What business capability does this expose?\"\n</naming_guidance>\n\n<output_requirements>\nReturn JSON with an \"elements\" array. Each element:\n{\n  \"identifier\": \"as_<verb_phrase>\",\n  \"name\": \"<Verb Phrase> Service\",  // Title case with \"Service\" suffix\n  \"documentation\": \"<What business value this service provides>\",\n  \"source\": \"<source_node_id>\",\n  \"confidence\": 0.0-1.0\n}\n\nAim for 3-5 distinct ApplicationServices that represent the application's key capabilities.\n</output_requirements>\n\n<determinism>\nApply consistent reasoning: given the same method signatures and graph metrics, produce identical services. When facing ambiguity, prefer the interpretation that generalizes across repositories.\n</determinism>\n\n</application_service_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_create_entity\",\n      \"name\": \"Create Entity Service\",\n      \"documentation\": \"Web endpoint for creating new entities through a form interface\",\n      \"source\": \"method_create_form\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_export_document\",\n      \"name\": \"Document Export Service\",\n      \"documentation\": \"Endpoint for generating and exporting documents\",\n      \"source\": \"method_export\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T08:03:02.657655"
  },
  {
    "id": 327,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 4,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<application_service_derivation>\nYou are deriving ApplicationService elements from methods in a software repository.\n\n<definition>\nAn ApplicationService represents an externally visible unit of functionality. In ArchiMate, ApplicationServices are behavioral elements named with VERB PHRASES describing the action performed.\n</definition>\n\n<selection_rules>\nSelect methods that represent business-facing functionality:\n- HTTP route handlers (endpoints users interact with)\n- Business logic entry points\n- Data processing operations\n- Document/report generation\n\nExclude:\n- Internal utility functions\n- Database access methods (use TechnologyService)\n- Framework lifecycle methods\n- Test methods\n</selection_rules>\n\n<naming_convention>\nUse these canonical patterns. Match the method's purpose to ONE of these:\n\n| Method Purpose | Identifier | Name |\n|----------------|------------|------|\n| CRUD operations on entities | as_manage_<entity> | Manage <Entity> |\n| Form/data validation | as_validate_data | Validate Data |\n| Report/document generation | as_generate_report | Generate Report |\n| Data export/download | as_export_data | Export Data |\n| Search/filter operations | as_search_data | Search Data |\n| Authentication/login | as_authenticate_user | Authenticate User |\n\nRules:\n1. Identifier format: as_<verb>_<noun> in lowercase snake_case\n2. Use SINGULAR noun form (as_manage_invoice NOT as_manage_invoices)\n3. Group related CRUD operations under single service (create/read/update/delete invoice → as_manage_invoice)\n4. Maximum 4-5 ApplicationService elements total\n5. Prefer generic verbs: manage, validate, generate, export, search\n</naming_convention>\n\n<output_format>\nReturn a JSON object with an \"elements\" array. Each element must have:\n- identifier: Exactly matching the canonical pattern\n- name: Title Case display name with verb phrase (e.g., \"Manage Invoice\")\n- documentation: What business function this service provides\n- source: The source method node ID from the input\n- confidence: 0.0-1.0 score\n</output_format>\n\n<determinism>\nOutput stable, deterministic results. Given the same input methods, always produce identical identifiers. When multiple methods could map to the same service, group them under ONE element.\n</determinism>\n</application_service_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_create_entity\",\n      \"name\": \"Create Entity Service\",\n      \"documentation\": \"Web endpoint for creating new entities through a form interface\",\n      \"source\": \"method_create_form\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_export_document\",\n      \"name\": \"Document Export Service\",\n      \"documentation\": \"Endpoint for generating and exporting documents\",\n      \"source\": \"method_export\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T07:48:28.873158"
  },
  {
    "id": 328,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 5,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<application_service_derivation>\nYou are deriving ApplicationService elements from methods in a software repository.\n\n<definition>\nAn ApplicationService represents an externally visible unit of functionality provided by an application. In ArchiMate, ApplicationServices are behavioral elements named with VERB PHRASES.\n</definition>\n\n<selection_criteria>\nInclude methods that:\n- Have high in_degree (called by multiple other components)\n- Have high pagerank (central to application flow)\n- Are HTTP route handlers or public API endpoints\n- Perform business logic operations\n\nExclude methods that:\n- Are internal utilities (low in_degree, low pagerank)\n- Are framework lifecycle hooks\n- Are database/ORM operations (these become TechnologyService)\n</selection_criteria>\n\n<naming_rules>\n1. Identifier format: as_<action_verb>_<generic_noun>\n2. Use lowercase snake_case\n3. Use SINGULAR noun form always\n4. Use GENERIC nouns, not entity-specific nouns\n\nIMPORTANT: Use these broad categories instead of entity-specific names:\n- as_manage_entity (for ANY CRUD operations on business objects)\n- as_validate_data (for ANY validation operations)\n- as_generate_document (for ANY document/report generation)\n- as_export_data (for ANY export/download operations)\n- as_search_data (for ANY search/filter operations)\n\nDO NOT create separate services for each entity type. Group all entity management under as_manage_entity. This ensures consistency across different repositories.\n</naming_rules>\n\n<constraints>\n- Maximum 4-5 ApplicationService elements\n- Derive names from the method's business PURPOSE, not its technical name\n- When uncertain between variants, choose the more generic form\n</constraints>\n\n<determinism>\nGiven identical input, always produce identical output. Prefer stability over precision - use consistent canonical names rather than varying descriptive names.\n</determinism>\n</application_service_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_create_entity\",\n      \"name\": \"Create Entity Service\",\n      \"documentation\": \"Web endpoint for creating new entities through a form interface\",\n      \"source\": \"method_create_form\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_export_document\",\n      \"name\": \"Document Export Service\",\n      \"documentation\": \"Endpoint for generating and exporting documents\",\n      \"source\": \"method_export\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T07:51:10.544150"
  },
  {
    "id": 103,
    "step_name": "ApplicationInterface",
    "phase": "generate",
    "version": 1,
    "sequence": 3,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND f.fileType = \"source\" AND (f.fileName CONTAINS \"route\" OR f.fileName CONTAINS \"api\" OR f.fileName CONTAINS \"endpoint\" OR f.fileName CONTAINS \"controller\") RETURN f.id as id, f.fileName as name, f.filePath as path",
    "input_model_query": null,
    "instruction": "Derive ApplicationInterface elements from API interfaces, routes, endpoints.\nInterfaces are the access points to application services.",
    "example": "{\"elements\": [{\"identifier\": \"app-int:api\", \"name\": \"REST API Interface\", \"confidence\": 0.8}]}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.091465"
  },
  {
    "id": 209,
    "step_name": "ApplicationInterface",
    "phase": "generate",
    "version": 2,
    "sequence": 3,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND f.fileType = \"source\" AND (f.fileName CONTAINS \"route\" OR f.fileName CONTAINS \"api\" OR f.fileName CONTAINS \"endpoint\" OR f.fileName CONTAINS \"controller\") RETURN f.id as id, f.fileName as name, f.filePath as path",
    "input_model_query": null,
    "instruction": "You are identifying ApplicationInterface elements from source code files.\n\nAn ApplicationInterface is a point of access where application services are made available:\n- REST API definitions (OpenAPI, Swagger)\n- GraphQL schemas\n- RPC interfaces (gRPC, SOAP)\n- WebSocket endpoints\n- CLI command interfaces\n\nEach candidate includes file information and graph metrics.\n\nReview each candidate and decide which should become ApplicationInterface elements.\n\nINCLUDE files that:\n- Define API routes or endpoints\n- Contain interface specifications\n- Export service contracts\n- Define command-line interfaces\n\nEXCLUDE files that:\n- Are internal routing helpers\n- Contain only implementation (no interface definition)\n- Are test files or mocks\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: app_int_<name>\n2. Use Title Case for display name\n3. Keep names generic (e.g., \"REST API\" not \"Flask REST API v2\")\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"app_int_rest_api\",\n      \"name\": \"REST API\",\n      \"documentation\": \"HTTP REST interface exposing application services\",\n      \"source\": \"file_api_routes\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"app_int_web_forms\",\n      \"name\": \"Web Forms Interface\",\n      \"documentation\": \"HTML form-based interface for user input\",\n      \"source\": \"file_forms\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-08T13:05:57.675500"
  },
  {
    "id": 348,
    "step_name": "ApplicationInterface",
    "phase": "generate",
    "version": 4,
    "sequence": 3,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND f.fileType = \"source\" AND (f.fileName CONTAINS \"route\" OR f.fileName CONTAINS \"api\" OR f.fileName CONTAINS \"endpoint\" OR f.fileName CONTAINS \"controller\") RETURN f.id as id, f.fileName as name, f.filePath as path",
    "input_model_query": null,
    "instruction": "You are identifying ApplicationInterface elements from API endpoints and interfaces.\n\nAn ApplicationInterface represents a point of access to application services.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include endpoints with in_degree >= 1 (called by external clients)\n2. Prefer endpoints with high pagerank (frequently used)\n3. Exclude internal-only endpoints (private APIs)\n\nINCLUDE:\n- REST API endpoints (routes, views)\n- GraphQL resolvers\n- RPC service methods\n- WebSocket handlers\n\nEXCLUDE:\n- Internal helper routes\n- Health check endpoints\n- Static file serving\n- Admin-only debug endpoints\n\nNAMING RULES (MANDATORY):\n1. Identifier: ai_<http_method>_<resource>\n2. Use lowercase snake_case\n3. Extract resource from URL path\n4. Group related endpoints under single interface if same resource\n\nLIMIT: Maximum 6-10 ApplicationInterface elements.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"ai_rest_api\",\n      \"name\": \"REST API\",\n      \"documentation\": \"HTTP REST interface exposing application services\",\n      \"source\": \"file_api_routes\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"ai_web_forms\",\n      \"name\": \"Web Forms Interface\",\n      \"documentation\": \"HTML form-based interface for user input\",\n      \"source\": \"file_forms\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T17:15:14.080956"
  },
  {
    "id": 361,
    "step_name": "ApplicationInterface",
    "phase": "generate",
    "version": 5,
    "sequence": 3,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND f.fileType = \"source\" AND (f.fileName CONTAINS \"route\" OR f.fileName CONTAINS \"api\" OR f.fileName CONTAINS \"endpoint\" OR f.fileName CONTAINS \"controller\") RETURN f.id as id, f.fileName as name, f.filePath as path",
    "input_model_query": null,
    "instruction": "<application_interface_derivation>\nYou are identifying ApplicationInterface elements from API endpoints and interfaces.\n\n<definition>\nAn ApplicationInterface represents a point of access to application services - the \"entry points\" that external systems use.\n</definition>\n\n<canonical_identifiers>\nUse EXACTLY these identifiers. Choose the BEST match for each endpoint group:\n\n| Pattern | Identifier | Name |\n|---------|------------|------|\n| REST API routes, HTTP endpoints | ai_rest_api | REST API |\n| GraphQL endpoint | ai_graphql_api | GraphQL API |\n| WebSocket handlers | ai_websocket_api | WebSocket API |\n| gRPC services | ai_grpc_api | gRPC API |\n| CLI commands | ai_command_line | Command Line Interface |\n| Web forms, HTML inputs | ai_web_forms | Web Forms Interface |\n| Message queue consumers | ai_message_consumer | Message Consumer Interface |\n| File import/export | ai_file_exchange | File Exchange Interface |\n\n</canonical_identifiers>\n\n<rules>\n1. Use ONLY identifiers from the table above\n2. Group all REST endpoints under ai_rest_api (not one per endpoint)\n3. Maximum 4-6 ApplicationInterface elements per repository\n4. Never include internal/private APIs\n5. Never include health check or debug endpoints\n</rules>\n\n<output_requirements>\n- Use SINGULAR form always\n- Use EXACT identifiers from the table\n- Include source file reference\n- Include confidence score (0.8-1.0)\n</output_requirements>\n</application_interface_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"ai_rest_api\",\n      \"name\": \"REST API\",\n      \"documentation\": \"HTTP REST interface exposing application services to external clients\",\n      \"source\": \"file_api_routes\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"ai_web_forms\",\n      \"name\": \"Web Forms Interface\",\n      \"documentation\": \"HTML form-based interface for user input and data submission\",\n      \"source\": \"file_forms\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0, \"max_candidates\": 20, \"batch_size\": 5}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T16:39:40.898421"
  },
  {
    "id": 384,
    "step_name": "ApplicationInterface",
    "phase": "generate",
    "version": 6,
    "sequence": 3,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND f.fileType = \"source\" AND (f.fileName CONTAINS \"route\" OR f.fileName CONTAINS \"api\" OR f.fileName CONTAINS \"endpoint\" OR f.fileName CONTAINS \"controller\") RETURN f.id as id, f.fileName as name, f.filePath as path",
    "input_model_query": null,
    "instruction": "<persona>\nYou are a senior enterprise architect with 15+ years of ArchiMate 3.2 expertise. You value semantic precision and consistent terminology above all else. You identify application interfaces based on their exposed contract, not implementation details.\n</persona>\n\n<definition>\nAn ApplicationInterface represents a point of access where application services are made available to external consumers. These are the inbound contracts through which the system exposes capabilities.\n</definition>\n\n<semantic_exclusions>\nAn ApplicationInterface is NOT:\n- An outbound integration (external APIs the system consumes)\n- An internal method signature (not exposed externally)\n- A data model or schema (that's a DataObject)\n- A service implementation (that's an ApplicationService)\n\nDO NOT:\n- Create separate interfaces for each protocol exposing the same capability\n- Model internal function calls as interfaces\n- Create interfaces for framework-generated endpoints (health checks, metrics)\n</semantic_exclusions>\n\n<scope_constraint>\nINBOUND ONLY: Only model interfaces that THIS system exposes to external consumers.\n\nDO NOT model:\n- External APIs the system calls (those belong to external systems)\n- Third-party service integrations\n- Database connections (those are technology-level)\n</scope_constraint>\n\n<protocol_merging>\nSINGLE INTERFACE PER CAPABILITY: When the same capability is exposed via multiple protocols (REST + GraphQL, HTTP + gRPC), create ONE ApplicationInterface element.\n\nExample:\n- REST /api/users AND GraphQL users query → ONE ai_user_api\n- Document all protocols in the description field\n</protocol_merging>\n\n<interface_test>\nVALIDATION RULE (apply to every candidate):\nA candidate ApplicationInterface must answer \"What external consumer uses this to access what capability?\" in one sentence.\n\nREJECT if:\n- No external consumer can be identified\n- The interface is purely internal\n- It duplicates another interface's capability\n</interface_test>\n\n<naming_rules>\nIDENTIFIER FORMAT (MANDATORY):\n- Prefix: ai_\n- Format: ai_<interface_description>\n- Style: lowercase snake_case\n- NEVER include repository name or protocol in identifier\n\nNORMALIZATION PRECEDENCE:\n1. Prefer canonical patterns over derived names\n2. Prefer capability-based names over protocol-based names\n3. Prefer singular over plural\n4. Prefer industry-standard terms when available\n\nCONFLICT RESOLUTION:\n- ai_rest_api vs ai_api → choose ai_api (protocol-agnostic)\n- ai_users_endpoint vs ai_user_api → choose ai_user_api (standard)\n</naming_rules>\n\n<canonical_patterns>\n| Interface Type | Identifier | Name |\n|----------------|------------|------|\n| Primary system API | ai_api | System API |\n| User-related endpoints | ai_user_api | User API |\n| Authentication endpoints | ai_auth_api | Authentication API |\n| Admin/management endpoints | ai_admin_api | Admin API |\n| Public/external API | ai_public_api | Public API |\n| WebSocket/realtime | ai_realtime | Realtime Interface |\n| CLI commands | ai_cli | CLI Interface |\n| Message queue consumer | ai_message_consumer | Message Consumer Interface |\n| File import interface | ai_file_import | File Import Interface |\n</canonical_patterns>\n\n<selection_criteria>\nINCLUDE interfaces that:\n- Expose functionality to external consumers\n- Have defined contracts (OpenAPI, GraphQL schema, etc.)\n- Represent system boundaries\n- Are documented or self-describing\n\nEXCLUDE:\n- Internal method calls\n- Private utility functions\n- Framework-generated endpoints (health, metrics)\n- Test endpoints\n</selection_criteria>\n\n<granularity_rules>\nTARGET: 2-5 ApplicationInterfaces per repository\n\nESCALATION RULES:\n- If > 5 candidates: merge by capability until <= 5\n- If < 2 candidates: verify system has no external API (some libs/tools don't)\n- If 0 candidates: this may be correct for libraries with no exposed API\n</granularity_rules>\n\n<realization_constraint>\nEach ApplicationInterface must be associated with at least one ApplicationService that provides the capability.\n\nIf no underlying service exists, do not create the interface.\n</realization_constraint>\n\n<determinism>\nORDERING: Sort elements alphabetically by identifier.\n\nCONFIDENCE BANDS (fixed):\n- 0.9-1.0: Canonical patterns with clear code evidence (routes, controllers)\n- 0.8-0.89: Clear derived interfaces with API definitions\n- 0.7-0.79: Inferred interfaces from code structure\n\nCONSISTENCY:\n- Do not invent synonyms across runs\n- Use identical identifiers for identical interfaces\n- Given identical input, produce identical output\n</determinism>\n\n<output_format>\nJSON with \"elements\" array containing:\n- identifier: ai_ prefix + interface description (snake_case)\n- name: Title Case interface name\n- documentation: One sentence describing what external consumers access and how\n- source: Source node ID\n- confidence: Per confidence bands above\n</output_format>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"ai_rest_api\",\n      \"name\": \"REST API\",\n      \"documentation\": \"HTTP REST interface exposing application services to external clients\",\n      \"source\": \"file_api_routes\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"ai_web_forms\",\n      \"name\": \"Web Forms Interface\",\n      \"documentation\": \"HTML form-based interface for user input and data submission\",\n      \"source\": \"file_forms\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T21:53:46.167133"
  },
  {
    "id": 315,
    "step_name": "ApplicationInterface",
    "phase": "generate",
    "version": 3,
    "sequence": 3,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND f.fileType = \"source\" AND (f.fileName CONTAINS \"route\" OR f.fileName CONTAINS \"api\" OR f.fileName CONTAINS \"endpoint\" OR f.fileName CONTAINS \"controller\") RETURN f.id as id, f.fileName as name, f.filePath as path",
    "input_model_query": null,
    "instruction": "You are identifying ApplicationInterface elements from API endpoints and interfaces.\n\nAn ApplicationInterface represents a point of access to application services.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include endpoints with in_degree >= 1 (called by external clients)\n2. Prefer endpoints with high pagerank (frequently used)\n3. Exclude internal-only endpoints (private APIs)\n\nINCLUDE:\n- REST API endpoints (routes, views)\n- GraphQL resolvers\n- RPC service methods\n- WebSocket handlers\n\nEXCLUDE:\n- Internal helper routes\n- Health check endpoints\n- Static file serving\n- Admin-only debug endpoints\n\nNAMING RULES (MANDATORY):\n1. Identifier: ai_<http_method>_<resource>\n2. Use lowercase snake_case\n3. Extract resource from URL path\n4. Group related endpoints under single interface if same resource\n\nLIMIT: Maximum 6-10 ApplicationInterface elements.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"app_int_rest_api\",\n      \"name\": \"REST API\",\n      \"documentation\": \"HTTP REST interface exposing application services\",\n      \"source\": \"file_api_routes\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"app_int_web_forms\",\n      \"name\": \"Web Forms Interface\",\n      \"documentation\": \"HTML form-based interface for user input\",\n      \"source\": \"file_forms\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-09T22:57:28.406232"
  },
  {
    "id": 104,
    "step_name": "DataObject",
    "phase": "generate",
    "version": 1,
    "sequence": 4,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true RETURN f.id as id, f.fileName as name, f.filePath as path, f.fileType as fileType",
    "input_model_query": null,
    "instruction": "Analyze these code files and derive ArchiMate DataObject elements.\nDataObjects represent data structures, configuration files, templates, and data artifacts.\n\nGuidelines:\n- Group related files into logical DataObjects\n- CSS/style files -> \"Stylesheets\" DataObject\n- HTML template files -> \"Templates\" DataObject  \n- Configuration files (.env, .json, .yaml) -> \"Configuration\" DataObject\n- Database files -> \"Database\" DataObject\n- Use descriptive names that reflect the data purpose\n- Each DataObject should represent a cohesive set of data",
    "example": "{\"elements\": [\n  {\"identifier\": \"data-obj:stylesheets\", \"name\": \"Application Stylesheets\", \"documentation\": \"CSS styling files\", \"source\": \"File:*.css\", \"confidence\": 0.8},\n  {\"identifier\": \"data-obj:templates\", \"name\": \"HTML Templates\", \"documentation\": \"Jinja2 template files\", \"source\": \"File:*.html\", \"confidence\": 0.8}\n]}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.094176"
  },
  {
    "id": 208,
    "step_name": "DataObject",
    "phase": "generate",
    "version": 2,
    "sequence": 4,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:File`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.fileName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying DataObject elements from files in a codebase.\n\nA DataObject represents data structured for automated processing:\n- Database files (SQLite, SQL scripts)\n- Configuration files (JSON, YAML, ENV)\n- Schema definitions\n- Data exchange formats\n\nEach candidate includes file information and graph metrics.\n\nReview each candidate and decide which should become DataObject elements.\n\nINCLUDE files that:\n- Store application data (databases, data files)\n- Define configuration (settings, environment)\n- Define data schemas or structures\n- Are used for data exchange\n\nEXCLUDE files that:\n- Are source code (Python, JavaScript, etc.)\n- Are templates (HTML, Jinja)\n- Are documentation (README, docs)\n- Are static assets (images, CSS)\n\nWhen naming:\n- Use descriptive names (e.g., \"Application Database\" not \"database.db\")\n- Indicate the data's purpose\n\nNAMING RULES REMINDER:\n- Use lowercase snake_case for identifiers\n- Use consistent prefix for element type\n- Keep names generic and stable\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"do_application_database\",\n      \"name\": \"Application Database\",\n      \"documentation\": \"SQLite database storing invoices, customers, and line items\",\n      \"source\": \"file_database.db\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"do_app_configuration\",\n      \"name\": \"Application Configuration\",\n      \"documentation\": \"Environment configuration for Flask application settings\",\n      \"source\": \"file_.flaskenv\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-03T10:17:20.456812"
  },
  {
    "id": 216,
    "step_name": "DataObject",
    "phase": "generate",
    "version": 3,
    "sequence": 4,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:File`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.fileName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying DataObject elements from files in a codebase.\n\nA DataObject represents data structured for automated processing:\n- Database files (SQLite, SQL scripts)\n- Configuration files (JSON, YAML, ENV)\n- Schema definitions\n- Data exchange formats\n\nEach candidate includes file information and graph metrics.\n\nReview each candidate and decide which should become DataObject elements.\n\nINCLUDE files that:\n- Store application data (databases, data files)\n- Define configuration (settings, environment variables)\n- Contain schema definitions\n- Are data interchange formats\n\nEXCLUDE files that:\n- Are source code (those inform other elements)\n- Are documentation\n- Are test data or fixtures\n- Are build artifacts\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: do_<name>\n2. Use Title Case for display name\n3. Use GENERIC names based on purpose, not filename:\n   - \"Application Database\" (NEVER: \"database.db\", \"sqlite_db\")\n   - \"Application Configuration\" (NEVER: \"config.json\", \"settings.yaml\", \"app_config\")\n   - \"Environment Configuration\" (NEVER: \".env\", \".flaskenv\", \"flask_env\")\n4. ONE DataObject per logical purpose - don't create duplicates for variants\n\nCANONICAL NAMES (always use these exact identifiers):\n- do_application_database: Main application database\n- do_application_configuration: App config (any format)\n- do_environment_configuration: Environment variables\n- do_requirements: Package dependencies\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"do_application_database\",\n      \"name\": \"Application Database\",\n      \"documentation\": \"SQLite database storing application data\",\n      \"source\": \"file_database.db\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"do_environment_configuration\",\n      \"name\": \"Environment Configuration\",\n      \"documentation\": \"Environment variables for application settings\",\n      \"source\": \"file_.flaskenv\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-08T13:12:36.940665"
  },
  {
    "id": 370,
    "step_name": "DataObject",
    "phase": "generate",
    "version": 6,
    "sequence": 4,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:File`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.fileName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<data_object_derivation>\nYou are deriving DataObject elements from configuration and data files in a software repository.\n\n<definition>\nA DataObject represents passive data used for storage or configuration. In ArchiMate, DataObjects are structural elements named with SINGULAR NOUN PHRASES.\n</definition>\n\n<selection_rules>\nSelect files that represent persistent data or configuration:\n- Environment/config files (.env, .flaskenv, config.json, settings.yaml)\n- Dependency manifests (requirements.txt, package.json, pyproject.toml)\n- Database files (.db, .sqlite)\n- Static data files (CSV, JSON data)\n- Documentation (README.md, docs)\n- Version control config (.gitignore)\n</selection_rules>\n\n<naming_convention>\nUse these EXACT canonical identifiers. Choose the single best match for each file:\n\n| File Pattern | Identifier | Name |\n|--------------|------------|------|\n| .env, .flaskenv, config.* | do_environment_configuration | Environment Configuration |\n| requirements.txt, package.json, pyproject.toml | do_dependency_manifest | Dependency Manifest |\n| *.db, *.sqlite | do_application_database | Application Database |\n| .gitignore | do_version_control_configuration | Version Control Configuration |\n| README.md, docs/* | do_project_documentation | Project Documentation |\n| templates/*.html | do_user_interface_template | User Interface Template |\n| static/css/* | do_stylesheet | Stylesheet |\n| static/js/* | do_client_script | Client Script |\n\nRules:\n1. Use SINGULAR form always (Template not Templates)\n2. Identifier format: do_<descriptive_name> in lowercase snake_case\n3. Group related files under ONE element (all .html templates → do_user_interface_template)\n4. Maximum 5-6 DataObject elements total\n</naming_convention>\n\n<output_format>\nReturn a JSON object with an \"elements\" array. Each element must have:\n- identifier: Exactly matching the canonical form above\n- name: Title Case display name\n- documentation: Brief description of what data this represents\n- source: The source node ID from the input\n- confidence: 0.0-1.0 score\n</output_format>\n\n<determinism>\nOutput stable, deterministic results. Given the same input files, always produce identical identifiers and element counts.\n</determinism>\n</data_object_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"do_application_database\",\n      \"name\": \"Application Database\",\n      \"documentation\": \"SQLite database storing application data\",\n      \"source\": \"file_database.db\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"do_environment_configuration\",\n      \"name\": \"Environment Configuration\",\n      \"documentation\": \"Environment variables for application settings\",\n      \"source\": \"file_.flaskenv\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T16:41:00.601086"
  },
  {
    "id": 316,
    "step_name": "DataObject",
    "phase": "generate",
    "version": 4,
    "sequence": 4,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:File`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.fileName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying DataObject elements from data structures and file types.\n\nA DataObject represents a passive element used for storage or transmission of data.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include data files with in_degree >= 1 (referenced by code)\n2. Prefer files with high pagerank (frequently accessed)\n3. Exclude temporary or generated files\n\nINCLUDE:\n- Configuration files (JSON, YAML, TOML, INI)\n- Data files (CSV, XML, static data)\n- Environment files (.env)\n- Requirements/dependency manifests\n\nEXCLUDE:\n- Source code files (use ApplicationComponent)\n- Test data fixtures\n- Log files\n- Cache files\n\nNAMING RULES (MANDATORY):\n1. Identifier: do_<descriptive_name>\n2. Use lowercase snake_case\n3. Extract name from file purpose, not filename\n4. Group related configs under single object\n\nLIMIT: Maximum 4-6 DataObject elements.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"do_application_database\",\n      \"name\": \"Application Database\",\n      \"documentation\": \"SQLite database storing application data\",\n      \"source\": \"file_database.db\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"do_environment_configuration\",\n      \"name\": \"Environment Configuration\",\n      \"documentation\": \"Environment variables for application settings\",\n      \"source\": \"file_.flaskenv\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-09T22:57:38.346990"
  },
  {
    "id": 390,
    "step_name": "DataObject",
    "phase": "generate",
    "version": 7,
    "sequence": 4,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:File`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.fileName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<persona>\nYou are a senior enterprise architect with 15+ years of ArchiMate 3.2 expertise. You value semantic precision and consistent terminology above all else. You identify data objects based on their content purpose and domain significance.\n</persona>\n\n<definition>\nA DataObject represents data structured for automated processing. These are the technical artifacts that store persistent data - databases, configuration files, schemas, data files.\n</definition>\n\n<semantic_exclusions>\nA DataObject is NOT:\n- A BusinessObject (business concept, not technical storage)\n- A runtime cache or session store\n- A message queue or stream\n- Source code or executable files\n\nDO NOT:\n- Model Redis/Memcached caches as DataObjects\n- Model message queues (Kafka topics, RabbitMQ queues)\n- Model session stores\n- Model source code files (*.py, *.js)\n</semantic_exclusions>\n\n<scope_constraint>\nFILE-BASED ARTIFACTS ONLY: Only model files and file-like persistent stores.\n\nVALID (file-based):\n- Databases (*.db, *.sqlite)\n- Configuration files (*.json, *.yaml, *.env)\n- Schema definitions\n- Data files (*.csv, *.xml)\n- Build definitions (Dockerfile, Makefile)\n\nINVALID (runtime):\n- Redis cache\n- Message queues\n- Session stores\n- In-memory caches\n</scope_constraint>\n\n<naming_constraint>\nDOMAIN-DERIVED NAMES: Name based on content purpose, not just file type.\n\nVALID (purpose-based):\n- do_user_schema (schema defining user structure)\n- do_order_config (configuration for order processing)\n- do_invoice_data (data file containing invoices)\n\nAVOID (generic):\n- do_json_file (too generic)\n- do_config (which config?)\n- do_data (which data?)\n\nException: For standard infrastructure files, use standard names:\n- do_requirements, do_dockerfile, do_makefile\n</naming_constraint>\n\n<object_test>\nVALIDATION RULE (apply to every candidate):\nA candidate DataObject must answer \"What data does this store and for what purpose?\" in one sentence.\n\nREJECT if:\n- Purpose cannot be articulated\n- It's source code, not data\n- It's a runtime/ephemeral store\n</object_test>\n\n<naming_rules>\nIDENTIFIER FORMAT (MANDATORY):\n- Prefix: do_\n- Format: do_<purpose>_<type> or do_<standard_name>\n- Style: lowercase snake_case\n\nNORMALIZATION PRECEDENCE:\n1. Prefer purpose-based names over file-type names\n2. Prefer standard names for infrastructure files\n3. Prefer singular over plural\n4. Prefer specific over generic\n\nCONFLICT RESOLUTION:\n- do_config vs do_app_config → choose do_app_config (specific)\n- do_database vs do_order_database → choose do_order_database (purpose)\n- do_yml vs do_deployment_config → choose do_deployment_config (purpose)\n</naming_rules>\n\n<canonical_infrastructure>\nUse these standard identifiers for common infrastructure files:\n\n| File Pattern | Identifier | Name |\n|--------------|------------|------|\n| requirements*.txt, Pipfile | do_python_requirements | Python Requirements |\n| package.json | do_node_packages | Node Package Config |\n| Dockerfile, docker-compose* | do_docker_config | Docker Configuration |\n| Makefile | do_makefile | Build Makefile |\n| *.env, .env* | do_environment | Environment Variables |\n| *.db, *.sqlite | do_<purpose>_database | <Purpose> Database |\n</canonical_infrastructure>\n\n<selection_criteria>\nINCLUDE data objects that:\n- Store persistent data\n- Define schemas or structures\n- Configure application behavior\n- Contain significant data files\n\nEXCLUDE:\n- Source code files (*.py, *.js, *.go)\n- Test fixtures (unless significant)\n- Documentation files\n- Temporary files\n- Runtime caches\n</selection_criteria>\n\n<granularity_rules>\nTARGET: 3-8 DataObjects per repository\n\nESCALATION RULES:\n- If > 8 candidates: keep most significant data artifacts\n- If < 3 candidates: verify data files exist (pure logic libs may have few)\n- If 0 candidates: acceptable for stateless utility libraries\n</granularity_rules>\n\n<determinism>\nORDERING: Sort elements alphabetically by identifier.\n\nCONFIDENCE BANDS (fixed):\n- 0.9-1.0: Explicit data files with clear purpose\n- 0.8-0.89: Inferred data artifacts from usage patterns\n- 0.7-0.79: Configuration files with uncertain scope\n\nCONSISTENCY:\n- Do not invent synonyms across runs\n- Use identical identifiers for identical files\n- Given identical input, produce identical output\n</determinism>\n\n<output_format>\nJSON with \"elements\" array containing:\n- identifier: do_ prefix + purpose-based name (snake_case)\n- name: Title Case data object name\n- documentation: One sentence describing data content and purpose\n- source: Source file node ID\n- confidence: Per confidence bands above\n</output_format>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"do_application_database\",\n      \"name\": \"Application Database\",\n      \"documentation\": \"SQLite database storing application data\",\n      \"source\": \"file_database.db\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"do_environment_configuration\",\n      \"name\": \"Environment Configuration\",\n      \"documentation\": \"Environment variables for application settings\",\n      \"source\": \"file_.flaskenv\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T22:08:57.144509"
  },
  {
    "id": 326,
    "step_name": "DataObject",
    "phase": "generate",
    "version": 5,
    "sequence": 4,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:File`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.fileName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<data_object_derivation>\nYou are deriving DataObject elements from configuration and data files in a software repository.\n\n<definition>\nA DataObject represents passive data used for storage or configuration. In ArchiMate, DataObjects are structural elements named with SINGULAR NOUN PHRASES.\n</definition>\n\n<selection_rules>\nSelect files that represent persistent data or configuration:\n- Environment/config files (.env, .flaskenv, config.json, settings.yaml)\n- Dependency manifests (requirements.txt, package.json, pyproject.toml)\n- Database files (.db, .sqlite)\n- Static data files (CSV, JSON data)\n- Documentation (README.md, docs)\n- Version control config (.gitignore)\n</selection_rules>\n\n<naming_convention>\nUse these EXACT canonical identifiers. Choose the single best match for each file:\n\n| File Pattern | Identifier | Name |\n|--------------|------------|------|\n| .env, .flaskenv, config.* | do_environment_configuration | Environment Configuration |\n| requirements.txt, package.json, pyproject.toml | do_dependency_manifest | Dependency Manifest |\n| *.db, *.sqlite | do_application_database | Application Database |\n| .gitignore | do_version_control_configuration | Version Control Configuration |\n| README.md, docs/* | do_project_documentation | Project Documentation |\n| templates/*.html | do_user_interface_template | User Interface Template |\n| static/css/* | do_stylesheet | Stylesheet |\n| static/js/* | do_client_script | Client Script |\n\nRules:\n1. Use SINGULAR form always (Template not Templates)\n2. Identifier format: do_<descriptive_name> in lowercase snake_case\n3. Group related files under ONE element (all .html templates → do_user_interface_template)\n4. Maximum 5-6 DataObject elements total\n</naming_convention>\n\n<output_format>\nReturn a JSON object with an \"elements\" array. Each element must have:\n- identifier: Exactly matching the canonical form above\n- name: Title Case display name\n- documentation: Brief description of what data this represents\n- source: The source node ID from the input\n- confidence: 0.0-1.0 score\n</output_format>\n\n<determinism>\nOutput stable, deterministic results. Given the same input files, always produce identical identifiers and element counts.\n</determinism>\n</data_object_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"do_application_database\",\n      \"name\": \"Application Database\",\n      \"documentation\": \"SQLite database storing application data\",\n      \"source\": \"file_database.db\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"do_environment_configuration\",\n      \"name\": \"Environment Configuration\",\n      \"documentation\": \"Environment variables for application settings\",\n      \"source\": \"file_.flaskenv\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T07:45:53.321389"
  },
  {
    "id": 223,
    "step_name": "BusinessProcess",
    "phase": "generate",
    "version": 3,
    "sequence": 5,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying BusinessProcess elements from source code methods.\n\nA BusinessProcess represents a sequence of business behaviors that achieves a specific outcome:\n- Complete business activities that deliver value to stakeholders\n- Workflows that involve multiple steps or decisions\n- Processes that would appear in business process documentation\n\nReview each candidate and ONLY create BusinessProcess for HIGH-LEVEL business operations.\n\nINCLUDE methods that:\n- Represent complete business transactions (Create, Update, Fulfill, Process)\n- Would appear in a business process diagram\n- Orchestrate multiple steps to achieve a business outcome\n- Are meaningful to business analysts, not just developers\n\nEXCLUDE methods that:\n- Are purely technical (setup, init, config, database migrations)\n- Are utility functions or helpers\n- Are single CRUD operations on records (those are ApplicationService)\n- Are internal implementation details\n- Generate documents (PDF, reports) - those are ApplicationService\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: bp_<verb>_<entity>\n2. Use Title Case for display name with verb + noun format\n3. Focus on OUTCOMES not operations (e.g., 'Create Order' not 'Insert Order Record')\n4. Derive process names from the domain, not from repo-specific terminology\n\nSTRICT RULES:\n1. Max 2-4 BusinessProcess elements per small application\n2. Only include processes with clear business value\n3. Group related operations into single processes\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bp_create_order\",\n      \"name\": \"Create Order\",\n      \"documentation\": \"Business process of creating a new order with line items and customer details\",\n      \"source\": \"method_insert_order\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bp_process_payment\",\n      \"name\": \"Process Payment\",\n      \"documentation\": \"Business process of handling payment transactions\",\n      \"source\": \"method_handle_payment\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-08T13:52:51.467260"
  },
  {
    "id": 105,
    "step_name": "BusinessProcess",
    "phase": "generate",
    "version": 1,
    "sequence": 5,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying BusinessProcess elements from source code methods.\n\nA BusinessProcess represents a sequence of business behaviors that achieves\na specific outcome. It is NOT just any function - it represents a complete\nbusiness activity that delivers value.\n\nEach candidate includes graph metrics to help assess importance:\n- pagerank: How central/important the method is\n- in_degree/out_degree: How connected it is\n\nReview each candidate and decide which should become BusinessProcess elements.\n\nINCLUDE methods that:\n- Represent complete business activities (Create Invoice, Process Payment)\n- Coordinate multiple steps to achieve a business outcome\n- Would be meaningful to a business analyst\n- Are named with verbs indicating business actions\n\nEXCLUDE methods that:\n- Are purely technical (validation, parsing, formatting)\n- Are framework lifecycle methods (__init__, setup, etc.)\n- Are simple getters/setters\n- Are utility/helper functions\n- Only do one small technical step\n\nWhen naming:\n- Use business-friendly verb phrases (e.g., \"Create Invoice\" not \"create_invoice\")\n- Focus on the business outcome, not technical implementation\n\nNAMING RULES REMINDER:\n- Use lowercase snake_case for identifiers\n- Use consistent prefix for element type\n- Keep names generic and stable\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bp_create_invoice\",\n      \"name\": \"Create Invoice\",\n      \"documentation\": \"Process of generating a new invoice with line items and customer details\",\n      \"source\": \"method_invoice_form\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bp_process_payment\",\n      \"name\": \"Process Payment\",\n      \"documentation\": \"Handles payment submission and validation for customer orders\",\n      \"source\": \"method_handle_payment\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.100610"
  },
  {
    "id": 219,
    "step_name": "BusinessProcess",
    "phase": "generate",
    "version": 2,
    "sequence": 5,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying BusinessProcess elements from source code methods.\n\nA BusinessProcess represents a sequence of business behaviors that achieves a specific outcome:\n- Complete business activities (Create Invoice, Process Payment)\n- Workflows that deliver value (Order Fulfillment, User Registration)\n- NOT just any function - it must represent a complete business activity\n\nEach candidate includes graph metrics to help assess importance:\n- pagerank: How central/important the method is\n- in_degree/out_degree: How connected it is\n\nReview each candidate and ONLY create BusinessProcess for HIGH-LEVEL business operations.\n\nINCLUDE methods that:\n- Represent complete business transactions\n- Would appear in a business process diagram\n- Create, update, or finalize business entities\n- Are orchestration points (call multiple other methods)\n\nEXCLUDE methods that:\n- Are technical helpers (setup, init, config)\n- Are utility functions\n- Are CRUD operations on single records (those are ApplicationService)\n- Are internal implementation details\n\nSTRICT RULES:\n1. Max 3-5 BusinessProcess elements per application\n2. Focus on OUTCOMES not operations\n3. Database setup/init are NOT business processes\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: bp_<process>\n2. Use Title Case for display name\n3. Use verb + noun format: \"Create Invoice\", \"Process Payment\"\n4. CANONICAL PROCESSES (for invoice app):\n   - bp_create_invoice: Creating a new invoice with details\n   - bp_update_invoice: Modifying existing invoice\n   - bp_generate_pdf: PDF generation process\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bp_create_invoice\",\n      \"name\": \"Create Invoice\",\n      \"documentation\": \"Business process of generating a new invoice with line items and customer details\",\n      \"source\": \"method_insert_invoice_details\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bp_update_invoice\",\n      \"name\": \"Update Invoice\",\n      \"documentation\": \"Business process of modifying an existing invoice\",\n      \"source\": \"method_update_invoice_details\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-08T13:16:56.060538"
  },
  {
    "id": 389,
    "step_name": "BusinessProcess",
    "phase": "generate",
    "version": 9,
    "sequence": 5,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<persona>\nYou are a senior enterprise architect with 15+ years of ArchiMate 3.2 expertise. You value semantic precision and consistent terminology above all else. You identify business processes based on business value, at whatever granularity they exist in the code.\n</persona>\n\n<definition>\nA BusinessProcess represents a sequence of business behaviors that achieves a specific outcome. Processes transform inputs into outputs and produce value for stakeholders.\n</definition>\n\n<semantic_exclusions>\nA BusinessProcess is NOT:\n- A technical workflow (CI/CD, deployment, build)\n- A framework lifecycle method\n- An internal utility function\n- A single CRUD operation without business context\n\nDO NOT:\n- Model CI/CD pipelines as business processes\n- Model deployment workflows\n- Model database migrations\n- Model technical maintenance tasks\n</semantic_exclusions>\n\n<scope_constraint>\nBUSINESS WORKFLOWS ONLY: Only model processes with business value.\n\nVALID (business value):\n- bp_process_order, bp_validate_payment, bp_generate_invoice\n- bp_register_customer, bp_approve_refund, bp_calculate_pricing\n\nINVALID (technical):\n- bp_deploy_application, bp_run_tests, bp_backup_database\n- bp_migrate_schema, bp_clear_cache, bp_rotate_logs\n</scope_constraint>\n\n<granularity_constraint>\nALL IDENTIFIABLE STEPS: Model business steps at whatever granularity they exist in the code.\n\nInclude:\n- End-to-end flows (bp_process_order)\n- Major steps (bp_validate_order)\n- Individual activities (bp_calculate_total)\n\nAs long as they have business meaning and can be identified in code.\n</granularity_constraint>\n\n<process_test>\nVALIDATION RULE (apply to every candidate):\nA candidate BusinessProcess must answer \"What business outcome does this produce?\" in one sentence.\n\nREJECT if:\n- The outcome is purely technical\n- No business value can be articulated\n- It's a framework or infrastructure concern\n</process_test>\n\n<naming_rules>\nIDENTIFIER FORMAT (MANDATORY):\n- Prefix: bp_\n- Format: bp_<verb>_<object>\n- Style: lowercase snake_case\n- Use imperative verb phrases\n\nNORMALIZATION PRECEDENCE:\n1. Prefer canonical patterns over derived names\n2. Prefer imperative verbs (process, validate, create)\n3. Prefer specific actions over generic (validate_order not check_order)\n4. Prefer business terminology\n\nCONFLICT RESOLUTION:\n- bp_order_processing vs bp_process_order → choose bp_process_order (imperative)\n- bp_do_payment vs bp_process_payment → choose bp_process_payment (standard)\n- bp_handle_customer vs bp_register_customer → choose bp_register_customer (specific)\n</naming_rules>\n\n<canonical_patterns>\n| Process Type | Identifier Pattern | Examples |\n|--------------|-------------------|----------|\n| Creation | bp_create_<entity> | bp_create_order, bp_create_account |\n| Processing | bp_process_<entity> | bp_process_payment, bp_process_claim |\n| Validation | bp_validate_<entity> | bp_validate_order, bp_validate_payment |\n| Approval | bp_approve_<entity> | bp_approve_request, bp_approve_refund |\n| Registration | bp_register_<entity> | bp_register_customer, bp_register_device |\n| Generation | bp_generate_<output> | bp_generate_report, bp_generate_invoice |\n| Calculation | bp_calculate_<value> | bp_calculate_total, bp_calculate_tax |\n| Notification | bp_notify_<recipient> | bp_notify_customer, bp_notify_admin |\n| Fulfillment | bp_fulfill_<entity> | bp_fulfill_order, bp_ship_order |\n</canonical_patterns>\n\n<selection_criteria>\nINCLUDE processes that:\n- Produce business outcomes\n- Transform business objects\n- Can be triggered by events or actors\n- Have identifiable steps in code\n\nEXCLUDE:\n- Technical workflows (CI/CD, deployment)\n- Framework lifecycle methods\n- Pure CRUD without business context\n- Internal utility operations\n</selection_criteria>\n\n<granularity_rules>\nTARGET: 4-12 BusinessProcesses per repository\n\nESCALATION RULES:\n- If > 12 candidates: keep the most significant, document others\n- If < 4 candidates: verify business logic exists\n- If 0 candidates: acceptable for pure infrastructure repositories\n</granularity_rules>\n\n<event_linkage>\nProcesses should either:\n- Be triggered by a BusinessEvent, OR\n- Produce a BusinessEvent\n\nIf neither applies, verify the process has business significance.\n</event_linkage>\n\n<determinism>\nORDERING: Sort elements alphabetically by identifier.\n\nCONFIDENCE BANDS (fixed):\n- 0.9-1.0: Explicit process/workflow classes or methods\n- 0.8-0.89: Inferred from service method patterns\n- 0.7-0.79: Identified from control flow analysis\n\nCONSISTENCY:\n- Do not invent synonyms across runs\n- Use identical identifiers for identical processes\n- Given identical input, produce identical output\n</determinism>\n\n<output_format>\nJSON with \"elements\" array containing:\n- identifier: bp_ prefix + verb + object (snake_case)\n- name: Title Case process name\n- documentation: One sentence describing business outcome\n- source: Source node ID\n- confidence: Per confidence bands above\n</output_format>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bp_create_entity\",\n      \"name\": \"Create Entity\",\n      \"documentation\": \"Business process for creating new business entities\",\n      \"source\": \"method_create_record\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bp_update_entity\",\n      \"name\": \"Update Entity\",\n      \"documentation\": \"Business process for modifying existing entities\",\n      \"source\": \"method_update_record\",\n      \"confidence\": 0.85\n    },\n    {\n      \"identifier\": \"bp_generate_output\",\n      \"name\": \"Generate Output\",\n      \"documentation\": \"Business process for generating documents and reports\",\n      \"source\": \"method_render_report\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T22:06:33.292159"
  },
  {
    "id": 369,
    "step_name": "BusinessProcess",
    "phase": "generate",
    "version": 8,
    "sequence": 5,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<business_process_derivation>\n\n<definition>\nA BusinessProcess represents a sequence of business activities that achieve a specific outcome. In ArchiMate, processes are behavioral elements named with VERB PHRASES.\n</definition>\n\n<selection_criteria>\nFrom the provided methods, identify those that represent BUSINESS WORKFLOWS:\n- Methods that orchestrate multiple operations\n- Methods triggered by business events\n- Methods with high in_degree (called by multiple places)\n\nExclude:\n- Utility functions (formatting, validation helpers)\n- Data access methods (CRUD operations)\n- Framework lifecycle methods (setup, init, teardown)\n</selection_criteria>\n\n<naming_approach>\nFormat: bp_<verb>_<noun> in lowercase_snake_case\n\nUse GENERIC process categories:\n\n| Method Pattern | Process | Identifier |\n|----------------|---------|------------|\n| Methods that create/add new entities | Create Entity | bp_create_entity |\n| Methods that update/modify entities | Update Entity | bp_update_entity |\n| Methods that delete/remove entities | Delete Entity | bp_delete_entity |\n| Methods that process/transform data | Process Data | bp_process_data |\n| Methods that generate outputs | Generate Output | bp_generate_output |\n\nGroup similar operations: all create methods → bp_create_entity (not bp_create_invoice, bp_create_order)\n</naming_approach>\n\n<constraints>\n- Maximum 3-4 BusinessProcess elements\n- One process per CATEGORY of operation\n- Use verb phrases (Create, Update, Process, Generate)\n</constraints>\n\n<determinism>\nGiven identical input methods, produce identical processes. When multiple methods perform the same category of operation, group them under ONE process.\n</determinism>\n\n</business_process_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bp_create_entity\",\n      \"name\": \"Create Entity\",\n      \"documentation\": \"Business process for creating new business entities\",\n      \"source\": \"method_create_record\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bp_update_entity\",\n      \"name\": \"Update Entity\",\n      \"documentation\": \"Business process for modifying existing entities\",\n      \"source\": \"method_update_record\",\n      \"confidence\": 0.85\n    },\n    {\n      \"identifier\": \"bp_generate_output\",\n      \"name\": \"Generate Output\",\n      \"documentation\": \"Business process for generating documents and reports\",\n      \"source\": \"method_render_report\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T16:40:59.878204"
  },
  {
    "id": 306,
    "step_name": "BusinessProcess",
    "phase": "generate",
    "version": 4,
    "sequence": 5,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying BusinessProcess elements from source code methods.\n\nA BusinessProcess represents a sequence of business behaviors that achieves a specific outcome.\n\nCRITICAL: Only derive 2 BusinessProcess elements for this application.\n\nNAMING RULES (MANDATORY - FOLLOW EXACTLY):\n1. Identifier format: bp_<verb>_<primary_entity>\n2. Use ONLY these verbs: create, update, delete, process, manage\n3. Use the MAIN entity name (singular form): invoice, order, customer, payment\n4. NEVER include detail suffixes like \"_details\" or \"_items\"\n\nEXAMPLES OF CORRECT NAMING:\n- bp_create_invoice (NOT bp_create_invoice_details)\n- bp_update_invoice (NOT bp_update_invoice_form)\n- bp_manage_order (NOT bp_manage_order_items)\n\nSELECTION CRITERIA (graph-based):\n1. Prefer methods with higher pagerank scores (more structurally important)\n2. Prefer methods with in_degree > 0 (called by other methods)\n3. Exclude methods with out_degree = 0 AND pagerank < 0.01 (isolated utilities)\n\nINCLUDE methods that:\n- Represent complete business transactions (Create, Update operations)\n- Are the MAIN entry points for business operations\n- Have business-meaningful names (not technical setup/teardown)\n\nEXCLUDE methods that:\n- Are database setup/teardown (db_drop_and_create_all, setup_db)\n- Are utility formatters (currencyFormat, date_format)\n- Are form validators or field processors\n- Are PDF/report generators (use ApplicationService instead)\n\nLIMIT: Maximum 2 BusinessProcess elements. If more candidates exist, select the 2 with highest pagerank.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bp_create_order\",\n      \"name\": \"Create Order\",\n      \"documentation\": \"Business process of creating a new order with line items and customer details\",\n      \"source\": \"method_insert_order\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bp_process_payment\",\n      \"name\": \"Process Payment\",\n      \"documentation\": \"Business process of handling payment transactions\",\n      \"source\": \"method_handle_payment\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-09T22:24:17.897834"
  },
  {
    "id": 309,
    "step_name": "BusinessProcess",
    "phase": "generate",
    "version": 5,
    "sequence": 5,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying BusinessProcess elements from source code methods.\n\nA BusinessProcess represents a sequence of business behaviors that achieves a specific outcome.\n\nSELECTION CRITERIA (GRAPH-BASED - Generic):\n1. ONLY include methods with:\n   - pagerank > median (more important than average)\n   - OR in_degree >= 2 (called by multiple other methods)\n2. PREFER methods that:\n   - Are in k-core >= 2 (core business logic)\n   - Have names containing action verbs (create, update, process, handle, manage)\n3. EXCLUDE methods with:\n   - out_degree = 0 AND in_degree = 0 (isolated utility)\n   - Names starting with: setup, init, config, migrate, seed, drop\n   - Names containing: test, mock, stub, fixture\n\nNAMING RULES (Generic):\n1. Identifier: bp_<verb>_<entity>\n2. Extract verb from method name (first action word)\n3. Extract entity from method name (primary noun)\n4. Use SINGULAR form for entity\n5. Do NOT include suffixes like _details, _items, _form\n6. Do NOT include repository-specific prefixes\n\nLIMIT: Use graph metrics to select top 2-4 candidates by pagerank.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bp_create_order\",\n      \"name\": \"Create Order\",\n      \"documentation\": \"Business process of creating a new order with line items and customer details\",\n      \"source\": \"method_insert_order\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bp_process_payment\",\n      \"name\": \"Process Payment\",\n      \"documentation\": \"Business process of handling payment transactions\",\n      \"source\": \"method_handle_payment\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-09T22:29:18.576555"
  },
  {
    "id": 312,
    "step_name": "BusinessProcess",
    "phase": "generate",
    "version": 6,
    "sequence": 5,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying BusinessProcess elements from source code methods.\n\nA BusinessProcess represents a sequence of business behaviors that achieves a specific outcome.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include methods with pagerank > median (structurally important)\n2. Include methods with in_degree >= 2 (called by multiple methods)\n3. Prefer methods in k-core >= 2 (core business logic)\n4. Exclude methods with out_degree = 0 AND in_degree = 0 (isolated)\n\nMETHOD NAME PATTERNS TO INCLUDE:\n- Names containing: create, update, delete, process, handle, manage, submit, approve, complete\n- Names that are verbs followed by nouns\n\nMETHOD NAME PATTERNS TO EXCLUDE:\n- Names starting with: setup, init, config, migrate, seed, drop, get, set, is, has\n- Names containing: test, mock, stub, fixture, helper, util\n\nNAMING RULES (MANDATORY):\n1. Identifier: bp_<verb>_<entity>\n2. Extract verb from method name (first action word)\n3. Extract entity from method name (primary noun)\n4. Use SINGULAR form for entity\n5. Remove suffixes: _details, _items, _form, _data, _info\n6. Remove prefixes: get_, set_, do_, perform_\n\nLIMIT: Select top 2-4 methods by pagerank.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bp_create_order\",\n      \"name\": \"Create Order\",\n      \"documentation\": \"Business process of creating a new order with line items and customer details\",\n      \"source\": \"method_insert_order\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bp_process_payment\",\n      \"name\": \"Process Payment\",\n      \"documentation\": \"Business process of handling payment transactions\",\n      \"source\": \"method_handle_payment\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-09T22:50:33.024709"
  },
  {
    "id": 342,
    "step_name": "BusinessProcess",
    "phase": "generate",
    "version": 7,
    "sequence": 5,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<business_process_derivation>\n\n<definition>\nA BusinessProcess represents a sequence of business activities that achieve a specific outcome. In ArchiMate, processes are behavioral elements named with VERB PHRASES.\n</definition>\n\n<selection_criteria>\nFrom the provided methods, identify those that represent BUSINESS WORKFLOWS:\n- Methods that orchestrate multiple operations\n- Methods triggered by business events\n- Methods with high in_degree (called by multiple places)\n\nExclude:\n- Utility functions (formatting, validation helpers)\n- Data access methods (CRUD operations)\n- Framework lifecycle methods (setup, init, teardown)\n</selection_criteria>\n\n<naming_approach>\nFormat: bp_<verb>_<noun> in lowercase_snake_case\n\nUse GENERIC process categories:\n\n| Method Pattern | Process | Identifier |\n|----------------|---------|------------|\n| Methods that create/add new entities | Create Entity | bp_create_entity |\n| Methods that update/modify entities | Update Entity | bp_update_entity |\n| Methods that delete/remove entities | Delete Entity | bp_delete_entity |\n| Methods that process/transform data | Process Data | bp_process_data |\n| Methods that generate outputs | Generate Output | bp_generate_output |\n\nGroup similar operations: all create methods → bp_create_entity (not bp_create_invoice, bp_create_order)\n</naming_approach>\n\n<constraints>\n- Maximum 3-4 BusinessProcess elements\n- One process per CATEGORY of operation\n- Use verb phrases (Create, Update, Process, Generate)\n</constraints>\n\n<determinism>\nGiven identical input methods, produce identical processes. When multiple methods perform the same category of operation, group them under ONE process.\n</determinism>\n\n</business_process_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bp_create_entity\",\n      \"name\": \"Create Entity\",\n      \"documentation\": \"Business process for creating new business entities\",\n      \"source\": \"method_create_record\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bp_update_entity\",\n      \"name\": \"Update Entity\",\n      \"documentation\": \"Business process for modifying existing entities\",\n      \"source\": \"method_update_record\",\n      \"confidence\": 0.85\n    },\n    {\n      \"identifier\": \"bp_generate_output\",\n      \"name\": \"Generate Output\",\n      \"documentation\": \"Business process for generating documents and reports\",\n      \"source\": \"method_render_report\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T08:40:14.203025"
  },
  {
    "id": 215,
    "step_name": "BusinessObject",
    "phase": "generate",
    "version": 4,
    "sequence": 6,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying BusinessObject elements from source code type definitions.\n\nA BusinessObject represents a passive element that has business relevance:\n- Data entities that the business cares about (Customer, Order, Invoice)\n- Domain concepts that appear in business conversations\n- Information structures that would appear in business documentation\n\nEach candidate includes graph metrics to help assess importance:\n- pagerank: How central/important the type is\n- community: Which cluster of related code it belongs to\n\nReview each candidate and decide which should become BusinessObject elements.\n\nINCLUDE types that:\n- Represent business data entities\n- Would appear in database schemas or API responses\n- Are nouns that stakeholders understand\n- Have high pagerank (central to the domain)\n\nEXCLUDE types that:\n- Are utility/helper classes\n- Are UI components or views\n- Are actors/users (those are BusinessActor)\n- Are technical infrastructure\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use SINGULAR form ALWAYS: \"Invoice\" not \"Invoices\", \"Position\" not \"Positions\"\n2. Use lowercase snake_case for identifier: bo_<name>\n3. Use Title Case for display name\n4. MANDATORY CANONICAL NAMES (always use these exact names):\n   - Customer (NEVER: Client, User, Buyer, Account)\n   - Invoice (NEVER: Bill, Receipt)\n   - Position (NEVER: LineItem, Item, Line, Entry)\n   - Order (NEVER: Purchase, Transaction)\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bo_invoice\",\n      \"name\": \"Invoice\",\n      \"documentation\": \"A commercial document issued by a seller to a buyer\",\n      \"source\": \"type_Invoice\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"bo_position\",\n      \"name\": \"Position\",\n      \"documentation\": \"A line item within an invoice representing a product or service\",\n      \"source\": \"type_Position\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bo_customer\",\n      \"name\": \"Customer\",\n      \"documentation\": \"External party who receives invoices and makes payments\",\n      \"source\": \"type_Client\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-08T13:12:34.252425"
  },
  {
    "id": 222,
    "step_name": "BusinessObject",
    "phase": "generate",
    "version": 5,
    "sequence": 6,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying BusinessObject elements from source code type definitions.\n\nA BusinessObject represents a passive element that has business relevance:\n- Data entities that the business cares about (Order, Customer, Product, etc.)\n- Domain concepts that appear in business conversations\n\nReview each candidate and decide which should become BusinessObject elements.\n\nINCLUDE types that:\n- Represent business data entities\n- Would appear in database schemas or API responses\n- Are nouns that stakeholders understand\n\nEXCLUDE types that:\n- Are utility/helper classes\n- Are UI components or views\n- Are actors/users (those are BusinessActor)\n- Are technical infrastructure\n\nNAMING RULES (MANDATORY - FOLLOW EXACTLY):\n1. Use SINGULAR form ALWAYS: bo_position NOT bo_positions, bo_invoice NOT bo_invoices\n2. Use lowercase snake_case: bo_<name>\n3. NEVER use plural forms in identifiers\n4. CANONICAL NAMES (use these exact identifiers for common concepts):\n   - Invoice data: bo_invoice\n   - Line items/positions: bo_position\n   - Customer data: bo_customer\n   - Order data: bo_order\n\nSTRICT LIMITS:\n- Maximum 3-4 BusinessObject elements\n- Focus only on core domain entities\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bo_invoice\",\n      \"name\": \"Invoice\",\n      \"documentation\": \"A business document representing a billing transaction\",\n      \"source\": \"type_Invoice\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"bo_position\",\n      \"name\": \"Position\",\n      \"documentation\": \"A line item within an invoice or order\",\n      \"source\": \"type_Position\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bo_customer\",\n      \"name\": \"Customer\",\n      \"documentation\": \"External party who purchases goods or services\",\n      \"source\": \"type_Customer\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": 0.0,
    "max_tokens": null,
    "created_at": "2026-01-08T13:44:56.418124"
  },
  {
    "id": 106,
    "step_name": "BusinessObject",
    "phase": "generate",
    "version": 1,
    "sequence": 6,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (b:`Graph:BusinessConcept`) WHERE b.active = true RETURN b.id as id, b.name as name, b.concept_type as conceptType",
    "input_model_query": null,
    "instruction": "Derive BusinessObject elements from business concepts.\nBusinessObjects represent business entities like Invoice, Customer, Product.",
    "example": "{\"elements\": [{\"identifier\": \"bus-obj:invoice\", \"name\": \"Invoice\", \"confidence\": 0.8}]}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.103300"
  },
  {
    "id": 207,
    "step_name": "BusinessObject",
    "phase": "generate",
    "version": 3,
    "sequence": 6,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying BusinessObject elements from source code type definitions.\n\nA BusinessObject represents a passive element that has business relevance:\n- Data entities that the business cares about (Customer, Order, Invoice)\n- Domain concepts that appear in business conversations\n- Information structures that would appear in business documentation\n\nEach candidate includes graph metrics to help assess importance:\n- pagerank: How central/important the type is\n- community: Which cluster of related types it belongs to\n- in_degree: How many other types reference it (higher = more important)\n\nReview each candidate and decide which should become BusinessObject elements.\n\nINCLUDE types that:\n- Represent real-world business concepts (Customer, Order, Product)\n- Are data entities that store business information\n- Would be meaningful to a business analyst (not just a developer)\n- Have names that are nouns representing \"things\" the business cares about\n\nEXCLUDE types that:\n- Are purely technical (handlers, adapters, decorators)\n- Are framework/library classes (BaseModel, FlaskForm)\n- Are utility classes (StringHelper, DateUtils)\n- Are internal implementation details\n- Are exceptions or error types\n- Are configuration or settings classes\n\nWhen naming:\n- Use business-friendly names (e.g., \"Invoice\" not \"InvoiceModel\")\n- Capitalize appropriately (e.g., \"Customer Order\" not \"customer_order\")\n\nNAMING RULES REMINDER:\n- Use lowercase snake_case for identifiers\n- Use consistent prefix for element type\n- Keep names generic and stable\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bo_invoice\",\n      \"name\": \"Invoice\",\n      \"documentation\": \"A commercial document issued by a seller to a buyer, indicating products, quantities, and prices\",\n      \"source\": \"type_Invoice\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"bo_customer\",\n      \"name\": \"Customer\",\n      \"documentation\": \"A person or organization that purchases goods or services\",\n      \"source\": \"type_Customer\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bo_line_item\",\n      \"name\": \"Line Item\",\n      \"documentation\": \"An individual entry on an invoice representing a product or service with quantity and price\",\n      \"source\": \"type_Position\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-03T09:58:10.598831"
  },
  {
    "id": 204,
    "step_name": "BusinessObject",
    "phase": "generate",
    "version": 2,
    "sequence": 6,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (b:`Graph:BusinessConcept`) WHERE b.active = true RETURN b.id as id, b.name as name, b.concept_type as conceptType",
    "input_model_query": null,
    "instruction": "Derive ArchiMate BusinessObject elements from business concepts.\n\nA BusinessObject represents a passive business entity - something the business deals with (Invoice, Order, Customer, Product, Payment).\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use SINGULAR form always (Invoice not Invoices, Customer not Customers)\n2. Use lowercase snake_case for identifier (bus_obj_invoice, bus_obj_customer)\n3. Use Title Case for display name (Invoice, Customer)\n4. Avoid synonyms - pick ONE canonical name:\n   - Customer (not Client, not User, not Buyer)\n   - Order (not Purchase, not Transaction)\n   - Position (not Line Item, not Order Line)\n   - Payment (not Transaction)\n\nINCLUDE: Core business entities that are manipulated by business processes\nEXCLUDE: Technical concepts (templates, configs), UI elements, process steps\n\nOutput stable, deterministic results - same input should always produce same output.",
    "example": "{\"elements\": [{\"identifier\": \"bus-obj:invoice\", \"name\": \"Invoice\", \"confidence\": 0.8}]}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-03T09:55:31.063431"
  },
  {
    "id": 311,
    "step_name": "BusinessObject",
    "phase": "generate",
    "version": 6,
    "sequence": 6,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying BusinessObject elements from source code type definitions.\n\nA BusinessObject represents a passive element that has business relevance:\n- Data entities that the business cares about\n- Domain concepts that appear in business conversations\n\nReview each candidate and decide which should become BusinessObject elements.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. PREFER types with:\n   - pagerank > median (structurally important)\n   - in_degree >= 2 (referenced by multiple other types)\n2. EXCLUDE types with:\n   - pagerank < 0.005 (peripheral types)\n   - Names containing: Base, Mixin, Abstract, Interface, Exception, Error\n\nINCLUDE types that:\n- Represent business data entities\n- Would appear in database schemas or API responses\n- Are nouns that stakeholders understand\n\nEXCLUDE types that:\n- Are utility/helper classes\n- Are UI components or views\n- Are actors/users (those are BusinessActor)\n- Are technical infrastructure (Config, Settings, Handler)\n\nNAMING RULES (MANDATORY):\n1. Use SINGULAR form: bo_<entity> NOT bo_<entities>\n2. Use lowercase snake_case\n3. Extract entity name from class name, remove prefixes/suffixes\n4. Do NOT include framework-specific prefixes (Model, Schema, Form)\n\nLIMIT: Maximum 3-4 BusinessObject elements based on pagerank ranking.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bo_invoice\",\n      \"name\": \"Invoice\",\n      \"documentation\": \"A business document representing a billing transaction\",\n      \"source\": \"type_Invoice\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"bo_position\",\n      \"name\": \"Position\",\n      \"documentation\": \"A line item within an invoice or order\",\n      \"source\": \"type_Position\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bo_customer\",\n      \"name\": \"Customer\",\n      \"documentation\": \"External party who purchases goods or services\",\n      \"source\": \"type_Customer\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": 0.0,
    "max_tokens": null,
    "created_at": "2026-01-09T22:47:14.601184"
  },
  {
    "id": 339,
    "step_name": "BusinessObject",
    "phase": "generate",
    "version": 8,
    "sequence": 6,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<business_object_derivation>\n\n<definition>\nA BusinessObject represents a passive data entity with business relevance - the \"things\" that the business operates on. Examples: Customer, Order, Invoice, Product.\n</definition>\n\n<selection_criteria>\nFrom the provided type definitions, identify classes/types that:\n- Represent persistent business data\n- Would appear in database schemas\n- Are nouns that business stakeholders understand\n\nExclude:\n- Technical types (Config, Settings, Handler, Manager)\n- UI types (View, Form, Template)\n- Actor types (User, Admin → BusinessActor instead)\n- Utility types (Helper, Utils, Base, Mixin)\n</selection_criteria>\n\n<naming_approach>\nFormat: bo_<entity_name> in lowercase_snake_case\n\nCRITICAL: Use SINGULAR form always\n- bo_invoice (not bo_invoices)\n- bo_customer (not bo_customers)\n- bo_order (not bo_orders)\n\nStrip framework suffixes:\n- InvoiceModel → bo_invoice\n- CustomerSchema → bo_customer\n- OrderForm → bo_order\n</naming_approach>\n\n<abstraction>\nUse GENERIC business terms, not domain-specific names:\n\n| Domain-Specific | Generic Term | Identifier |\n|-----------------|--------------|------------|\n| InvoiceDetail, OrderLine, Position | Line Item | bo_line_item |\n| Client, Buyer, Account | Customer | bo_customer |\n| Sale, Purchase, Transaction | Order | bo_order |\n| SKU, Item, Merchandise | Product | bo_product |\n| Bill, Receipt, Statement | Invoice | bo_invoice |\n\nALWAYS use the generic term from the right column, regardless of what the source code calls it.\n</abstraction>\n\n<constraints>\n- Maximum 3-4 BusinessObject elements\n- One element per distinct business concept\n- Prefer types with higher pagerank (structurally important)\n</constraints>\n\n</business_object_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bo_order\",\n      \"name\": \"Order\",\n      \"documentation\": \"A business transaction representing a customer purchase\",\n      \"source\": \"typedef_order_model\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"bo_line_item\",\n      \"name\": \"Line Item\",\n      \"documentation\": \"Individual items within an order or transaction\",\n      \"source\": \"typedef_order_detail\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bo_customer\",\n      \"name\": \"Customer\",\n      \"documentation\": \"A business entity that purchases products or services\",\n      \"source\": \"typedef_client_model\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": 0.0,
    "max_tokens": null,
    "created_at": "2026-01-10T08:28:26.924716"
  },
  {
    "id": 340,
    "step_name": "BusinessObject",
    "phase": "generate",
    "version": 9,
    "sequence": 6,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<business_object_derivation>\n\n<definition>\nA BusinessObject represents a passive data entity with business relevance - the \"things\" that the business operates on. Examples: Customer, Order, Invoice, Product.\n</definition>\n\n<selection_criteria>\nFrom the provided type definitions, identify classes/types that:\n- Represent persistent business data\n- Would appear in database schemas\n- Are nouns that business stakeholders understand\n\nExclude:\n- Technical types (Config, Settings, Handler, Manager)\n- UI types (View, Form, Template)\n- Actor types (User, Admin → BusinessActor instead)\n- Utility types (Helper, Utils, Base, Mixin)\n</selection_criteria>\n\n<naming_approach>\nFormat: bo_<entity_name> in lowercase_snake_case\n\nCRITICAL: Use SINGULAR form always\n- bo_invoice (not bo_invoices)\n- bo_customer (not bo_customers)\n- bo_order (not bo_orders)\n\nStrip framework suffixes:\n- InvoiceModel → bo_invoice\n- CustomerSchema → bo_customer\n- OrderForm → bo_order\n</naming_approach>\n\n<abstraction>\nUse GENERIC business terms, not domain-specific names:\n\n| Domain-Specific | Generic Term | Identifier |\n|-----------------|--------------|------------|\n| InvoiceDetail, OrderLine, Position | Line Item | bo_line_item |\n| Client, Buyer, Account | Customer | bo_customer |\n| Sale, Purchase, Transaction | Order | bo_order |\n| SKU, Item, Merchandise | Product | bo_product |\n| Bill, Receipt, Statement | Invoice | bo_invoice |\n\nALWAYS use the generic term from the right column, regardless of what the source code calls it.\n</abstraction>\n\n<constraints>\n- Maximum 3-4 BusinessObject elements\n- One element per distinct business concept\n- Prefer types with higher pagerank (structurally important)\n</constraints>\n\n<determinism>\nSTRICT RULES for consistent output:\n1. NEVER use plural forms (bo_invoice_details is WRONG, bo_line_item is CORRECT)\n2. ALWAYS use the generic term from the abstraction table above\n3. If a type maps to \"Line Item\" in the table, output bo_line_item EXACTLY\n4. Given identical input types, always produce identical output\n</determinism>\n\n</business_object_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bo_order\",\n      \"name\": \"Order\",\n      \"documentation\": \"A business transaction representing a customer purchase\",\n      \"source\": \"typedef_order_model\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"bo_line_item\",\n      \"name\": \"Line Item\",\n      \"documentation\": \"Individual items within an order or transaction\",\n      \"source\": \"typedef_order_detail\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bo_customer\",\n      \"name\": \"Customer\",\n      \"documentation\": \"A business entity that purchases products or services\",\n      \"source\": \"typedef_client_model\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": 0.0,
    "max_tokens": null,
    "created_at": "2026-01-10T08:35:11.274353"
  },
  {
    "id": 341,
    "step_name": "BusinessObject",
    "phase": "generate",
    "version": 10,
    "sequence": 6,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<business_object_derivation>\n\n<definition>\nA BusinessObject represents a passive data entity with business relevance - the \"things\" that the business operates on. Examples: Customer, Order, Invoice, Product.\n</definition>\n\n<selection_criteria>\nFrom the provided type definitions, identify classes/types that:\n- Represent persistent business data\n- Would appear in database schemas\n- Are nouns that business stakeholders understand\n\nExclude:\n- Technical types (Config, Settings, Handler, Manager)\n- UI types (View, Form, Template)\n- Actor types (User, Admin → BusinessActor instead)\n- Utility types (Helper, Utils, Base, Mixin)\n</selection_criteria>\n\n<naming_approach>\nFormat: bo_<entity_name> in lowercase_snake_case\n\nCRITICAL: Use SINGULAR form always\n- bo_invoice (not bo_invoices)\n- bo_customer (not bo_customers)\n- bo_order (not bo_orders)\n\nStrip framework suffixes:\n- InvoiceModel → bo_invoice\n- CustomerSchema → bo_customer\n- OrderForm → bo_order\n</naming_approach>\n\n<abstraction>\nMap source type names to GENERIC identifiers:\n\nIf the type represents line items, details, or positions → bo_line_item\nIf the type represents clients, buyers, or accounts → bo_customer\nIf the type represents sales, purchases, or transactions → bo_order\nIf the type represents bills, receipts, or statements → bo_invoice\nIf the type represents products, items, or merchandise → bo_product\n\nUse EXACTLY these identifiers. No variations. No plurals.\n</abstraction>\n\n<constraints>\n- Maximum 3-4 BusinessObject elements\n- One element per distinct business concept\n- Prefer types with higher pagerank (structurally important)\n</constraints>\n\n<determinism>\nSTRICT RULES for consistent output:\n1. NEVER use plural forms (bo_invoice_details is WRONG, bo_line_item is CORRECT)\n2. ALWAYS use the generic term from the abstraction table above\n3. If a type maps to \"Line Item\" in the table, output bo_line_item EXACTLY\n4. Given identical input types, always produce identical output\n</determinism>\n\n</business_object_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bo_order\",\n      \"name\": \"Order\",\n      \"documentation\": \"A business transaction representing a customer purchase\",\n      \"source\": \"typedef_order_model\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"bo_line_item\",\n      \"name\": \"Line Item\",\n      \"documentation\": \"Individual items within an order or transaction\",\n      \"source\": \"typedef_order_detail\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bo_customer\",\n      \"name\": \"Customer\",\n      \"documentation\": \"A business entity that purchases products or services\",\n      \"source\": \"typedef_client_model\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": 0.0,
    "max_tokens": null,
    "created_at": "2026-01-10T08:37:13.836135"
  },
  {
    "id": 376,
    "step_name": "BusinessObject",
    "phase": "generate",
    "version": 12,
    "sequence": 6,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<business_object_derivation>\n\n<definition>\nA BusinessObject represents a passive data entity with business relevance - the \"things\" that the business operates on.\n</definition>\n\n<canonical_identifiers>\nUse EXACTLY these identifiers. Choose the BEST match for each type definition:\n\n| Pattern | Identifier | Name |\n|---------|------------|------|\n| Order, Sale, Purchase, Transaction | bo_order | Order |\n| Customer, Client, Buyer, Account | bo_customer | Customer |\n| Product, Item, Merchandise, Good | bo_product | Product |\n| Invoice, Bill, Receipt, Statement | bo_invoice | Invoice |\n| LineItem, OrderDetail, OrderLine | bo_line_item | Line Item |\n| Document, File, Attachment | bo_document | Document |\n| Message, Email, Notification | bo_message | Message |\n| Process, Workflow, Case | bo_process_instance | Process Instance |\n| Configuration, Setting, Preference | bo_configuration | Configuration |\n| Metadata, Schema, Definition | bo_metadata | Metadata |\n\n</canonical_identifiers>\n\n<rules>\n1. Use ONLY identifiers from the table above\n2. If no match found, DO NOT derive a BusinessObject\n3. Map ALL similar concepts to the SAME identifier (Client → bo_customer, Buyer → bo_customer)\n4. Maximum 3-4 BusinessObject elements per repository\n5. Use SINGULAR form always\n6. Never include User, Admin (these are BusinessActor)\n</rules>\n\n<output_requirements>\n- identifier: EXACT match from table above\n- name: Human readable name from table\n- documentation: Brief description of what this object represents\n- source: Reference to source type definition\n- confidence: 0.8-1.0\n</output_requirements>\n</business_object_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bo_order\",\n      \"name\": \"Order\",\n      \"documentation\": \"A business transaction representing a purchase or request\",\n      \"source\": \"typedef_order_model\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"bo_customer\",\n      \"name\": \"Customer\",\n      \"documentation\": \"A business entity that interacts with the system\",\n      \"source\": \"typedef_client_schema\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0, \"max_candidates\": 15, \"batch_size\": 5}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": 0.0,
    "max_tokens": null,
    "created_at": "2026-01-14T19:07:46.662136"
  },
  {
    "id": 388,
    "step_name": "BusinessObject",
    "phase": "generate",
    "version": 13,
    "sequence": 6,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<persona>\nYou are a senior enterprise architect with 15+ years of ArchiMate 3.2 expertise. You value semantic precision and consistent terminology above all else. You identify business objects based on their domain significance as aggregate roots.\n</persona>\n\n<definition>\nA BusinessObject represents a concept used within a particular business domain. These are the core domain entities that have business meaning independent of their technical implementation.\n</definition>\n\n<semantic_exclusions>\nA BusinessObject is NOT:\n- A DataObject (technical representation, not business concept)\n- A DTO or ViewModel (technical data transfer)\n- A child/detail entity (part of an aggregate)\n- A configuration or setting (technical artifact)\n\nDO NOT:\n- Model technical DTOs (OrderDTO, CustomerModel)\n- Model child entities within aggregates (OrderLine, InvoiceItem)\n- Model framework entities (Session, Request, Response)\n- Model internal value objects (Address, Money) as separate objects\n</semantic_exclusions>\n\n<aggregate_constraint>\nAGGREGATE ROOTS ONLY: Only model the root entity of a domain aggregate.\n\nVALID (aggregate roots):\n- bo_order (not bo_order_line)\n- bo_invoice (not bo_invoice_item)\n- bo_customer (not bo_customer_address)\n\nChild entities are implementation details of the aggregate root.\n</aggregate_constraint>\n\n<object_test>\nVALIDATION RULE (apply to every candidate):\nA candidate BusinessObject must answer \"What business concept does this represent that stakeholders discuss?\" in one sentence.\n\nREJECT if:\n- Only technical/developer audience understands it\n- It's a child entity of another object\n- It's a data transfer mechanism, not a domain concept\n</object_test>\n\n<naming_rules>\nIDENTIFIER FORMAT (MANDATORY):\n- Prefix: bo_\n- Format: bo_<domain_entity>\n- Style: lowercase snake_case, SINGULAR form\n- Use domain terminology, not technical names\n\nNORMALIZATION PRECEDENCE:\n1. Prefer canonical patterns over derived names\n2. Prefer singular over plural (order not orders)\n3. Prefer business terms over technical (customer not user_account)\n4. Prefer simple nouns over compound names\n\nCONFLICT RESOLUTION:\n- bo_orders vs bo_order → choose bo_order (singular)\n- bo_user_account vs bo_customer → choose bo_customer (business term)\n- bo_order_entity vs bo_order → choose bo_order (simple)\n</naming_rules>\n\n<canonical_patterns>\n| Domain Concept | Identifier | Name |\n|----------------|------------|------|\n| Order, purchase, transaction | bo_order | Order |\n| Customer, client, buyer | bo_customer | Customer |\n| Invoice, bill | bo_invoice | Invoice |\n| Product, item, goods | bo_product | Product |\n| Payment, transaction | bo_payment | Payment |\n| User, account | bo_user | User |\n| Employee, staff | bo_employee | Employee |\n| Contract, agreement | bo_contract | Contract |\n| Report, document | bo_report | Report |\n| Project, initiative | bo_project | Project |\n</canonical_patterns>\n\n<selection_criteria>\nINCLUDE entities that:\n- Are aggregate roots in DDD terms\n- Have clear business meaning to stakeholders\n- Are discussed in business requirements\n- Have lifecycle (created, modified, archived)\n\nEXCLUDE:\n- Child entities (OrderLine, InvoiceItem)\n- DTOs and ViewModels\n- Framework entities\n- Configuration objects\n- Value objects (Address, Money)\n</selection_criteria>\n\n<granularity_rules>\nTARGET: 3-8 BusinessObjects per repository\n\nESCALATION RULES:\n- If > 8 candidates: verify all are aggregate roots, merge related concepts\n- If < 3 candidates: verify domain model exists (utility libs may have none)\n- If 0 candidates: acceptable for infrastructure repositories\n</granularity_rules>\n\n<process_linkage>\nEach BusinessObject should be accessed or modified by at least one BusinessProcess.\n\nIf no process interaction exists, reconsider whether it's truly a business object.\n</process_linkage>\n\n<determinism>\nORDERING: Sort elements alphabetically by identifier.\n\nCONFIDENCE BANDS (fixed):\n- 0.9-1.0: Explicit domain model classes with persistence\n- 0.8-0.89: Inferred from service/repository patterns\n- 0.7-0.79: Referenced in documentation or API contracts\n\nCONSISTENCY:\n- Do not invent synonyms across runs\n- Use identical identifiers for identical domain concepts\n- Given identical input, produce identical output\n</determinism>\n\n<output_format>\nJSON with \"elements\" array containing:\n- identifier: bo_ prefix + singular entity name (snake_case)\n- name: Title Case entity name (singular)\n- documentation: One sentence describing business meaning\n- source: Source node ID\n- confidence: Per confidence bands above\n</output_format>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bo_order\",\n      \"name\": \"Order\",\n      \"documentation\": \"A business transaction representing a purchase or request\",\n      \"source\": \"typedef_order_model\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"bo_customer\",\n      \"name\": \"Customer\",\n      \"documentation\": \"A business entity that interacts with the system\",\n      \"source\": \"typedef_client_schema\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": 0.0,
    "max_tokens": null,
    "created_at": "2026-01-14T22:04:44.527999"
  },
  {
    "id": 363,
    "step_name": "BusinessObject",
    "phase": "generate",
    "version": 11,
    "sequence": 6,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<business_object_derivation>\nYou are identifying BusinessObject elements from domain models and data entities.\n\n<definition>\nA BusinessObject represents a passive data entity with business relevance - the \"things\" that the business operates on. Examples: Customer, Order, Invoice.\n</definition>\n\n<canonical_identifiers>\nUse EXACTLY these identifiers. Choose the BEST match:\n\n| Pattern | Identifier | Name |\n|---------|------------|------|\n| Order, Purchase, Transaction | bo_order | Order |\n| Customer, Client, Buyer | bo_customer | Customer |\n| Product, Item, Merchandise | bo_product | Product |\n| Invoice, Bill, Receipt | bo_invoice | Invoice |\n| LineItem, Detail, Position | bo_line_item | Line Item |\n| Account, Profile | bo_account | Account |\n| Message, Notification | bo_message | Message |\n| Document, File, Attachment | bo_document | Document |\n| Payment, Charge, Fee | bo_payment | Payment |\n| Subscription, Membership | bo_subscription | Subscription |\n\n</canonical_identifiers>\n\n<rules>\n1. Use ONLY identifiers from the table above\n2. Map similar concepts to the same canonical identifier\n3. Maximum 3-5 BusinessObject elements per repository\n4. Exclude technical types (Config, Handler, Service)\n5. Exclude UI types (View, Form, Template)\n6. Exclude actor types (User → use BusinessActor instead)\n</rules>\n\n<output_requirements>\n- Use SINGULAR form always (never plurals)\n- Use EXACT identifiers from the table\n- Strip framework suffixes (Model, Schema, Entity)\n- Include confidence score (0.8-1.0)\n</output_requirements>\n</business_object_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bo_order\",\n      \"name\": \"Order\",\n      \"documentation\": \"A business transaction representing a purchase or request\",\n      \"source\": \"typedef_order_model\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"bo_customer\",\n      \"name\": \"Customer\",\n      \"documentation\": \"A business entity that interacts with the system\",\n      \"source\": \"typedef_client_schema\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0, \"max_candidates\": 15, \"batch_size\": 5}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": 0.0,
    "max_tokens": null,
    "created_at": "2026-01-14T16:40:14.007303"
  },
  {
    "id": 338,
    "step_name": "BusinessObject",
    "phase": "generate",
    "version": 7,
    "sequence": 6,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<business_object_derivation>\n\n<definition>\nA BusinessObject represents a passive data entity with business relevance - the \"things\" that the business operates on. Examples: Customer, Order, Invoice, Product.\n</definition>\n\n<selection_criteria>\nFrom the provided type definitions, identify classes/types that:\n- Represent persistent business data\n- Would appear in database schemas\n- Are nouns that business stakeholders understand\n\nExclude:\n- Technical types (Config, Settings, Handler, Manager)\n- UI types (View, Form, Template)\n- Actor types (User, Admin → BusinessActor instead)\n- Utility types (Helper, Utils, Base, Mixin)\n</selection_criteria>\n\n<naming_approach>\nFormat: bo_<entity_name> in lowercase_snake_case\n\nCRITICAL: Use SINGULAR form always\n- bo_invoice (not bo_invoices)\n- bo_customer (not bo_customers)\n- bo_order (not bo_orders)\n\nStrip framework suffixes:\n- InvoiceModel → bo_invoice\n- CustomerSchema → bo_customer\n- OrderForm → bo_order\n</naming_approach>\n\n<abstraction>\nDerive names from the BUSINESS CONCEPT, not the implementation:\n- InvoiceLineItem, InvoiceDetail, Position → bo_line_item (generic term)\n- Client, Customer, Buyer → bo_customer (canonical term)\n\nAsk: \"What would this entity be called in any business domain?\"\n</abstraction>\n\n<constraints>\n- Maximum 3-4 BusinessObject elements\n- One element per distinct business concept\n- Prefer types with higher pagerank (structurally important)\n</constraints>\n\n</business_object_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bo_order\",\n      \"name\": \"Order\",\n      \"documentation\": \"A business transaction representing a customer purchase\",\n      \"source\": \"typedef_order_model\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"bo_line_item\",\n      \"name\": \"Line Item\",\n      \"documentation\": \"Individual items within an order or transaction\",\n      \"source\": \"typedef_order_detail\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bo_customer\",\n      \"name\": \"Customer\",\n      \"documentation\": \"A business entity that purchases products or services\",\n      \"source\": \"typedef_client_model\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": 0.0,
    "max_tokens": null,
    "created_at": "2026-01-10T08:27:20.122860"
  },
  {
    "id": 107,
    "step_name": "BusinessFunction",
    "phase": "generate",
    "version": 1,
    "sequence": 7,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (b:`Graph:BusinessConcept`) WHERE b.active = true AND b.conceptType IN [\"capability\", \"service\"] RETURN b.id as id, b.conceptName as name, b.conceptType as conceptType, b.description as description",
    "input_model_query": null,
    "instruction": "Identify business functions from domain concepts. Group related business behaviors by capability or responsibility area.",
    "example": "{\"identifier\":\"bf:payment\",\"name\":\"Payment Processing\",\"description\":\"Handles all payment-related operations\",\"confidence\":0.65}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.105947"
  },
  {
    "id": 210,
    "step_name": "BusinessFunction",
    "phase": "generate",
    "version": 2,
    "sequence": 7,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (b:`Graph:BusinessConcept`) WHERE b.active = true AND b.conceptType IN [\"capability\", \"service\"] RETURN b.id as id, b.conceptName as name, b.conceptType as conceptType, b.description as description",
    "input_model_query": null,
    "instruction": "You are identifying BusinessFunction elements from business concepts.\n\nA BusinessFunction represents a collection of business behavior based on a chosen set of criteria:\n- Capability areas (Payment Processing, Order Management)\n- Organizational functions (Finance, HR, Sales)\n- Domain responsibilities (Customer Service, Inventory Control)\n\nEach candidate includes concept information and graph metrics.\n\nReview each candidate and decide which should become BusinessFunction elements.\n\nINCLUDE concepts that:\n- Represent a coherent business capability\n- Group related business activities\n- Could be an organizational responsibility\n- Appear as functional areas in business documentation\n\nEXCLUDE concepts that:\n- Are too granular (single operations)\n- Are technical rather than business-oriented\n- Are data entities (those are BusinessObjects)\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: bf_<name>\n2. Use Title Case for display name\n3. Use singular nouns for capability names\n4. Keep names business-oriented, not technical\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bf_invoice_management\",\n      \"name\": \"Invoice Management\",\n      \"documentation\": \"Business capability for creating, tracking, and processing invoices\",\n      \"source\": \"concept_invoicing\",\n      \"confidence\": 0.85\n    },\n    {\n      \"identifier\": \"bf_payment_processing\",\n      \"name\": \"Payment Processing\",\n      \"documentation\": \"Business capability for handling payment transactions and reconciliation\",\n      \"source\": \"concept_payments\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-08T13:07:11.463113"
  },
  {
    "id": 358,
    "step_name": "BusinessFunction",
    "phase": "generate",
    "version": 7,
    "sequence": 7,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (b:`Graph:BusinessConcept`) WHERE b.active = true AND b.conceptType IN [\"process\", \"actor\"] RETURN b.id as id, b.conceptName as name, b.conceptType as conceptType, b.description as description",
    "input_model_query": null,
    "instruction": "You are identifying BusinessFunction elements from business process concepts.\n\nA BusinessFunction represents a collection of business behavior grouped by common purpose.\n\n<critical_rule>\nYou MUST ONLY use identifiers from the canonical table below.\nDO NOT create ANY identifier that is not in this exact list.\nIf a concept doesn't clearly map to one of these, SKIP IT - do not create an element.\n</critical_rule>\n\n<canonical_identifiers>\n| Identifier | Name | Map From These Patterns |\n|------------|------|-------------------------|\n| bf_entity_management | Entity Management | CRUD, data operations, entities, records |\n| bf_integration | Integration | APIs, external systems, connections, webhooks |\n| bf_reporting | Reporting | reports, analytics, dashboards, metrics |\n| bf_user_management | User Management | auth, login, users, accounts, passwords, access |\n| bf_process_orchestration | Process Orchestration | workflows, pipelines, jobs, scheduling |\n| bf_communication | Communication | notifications, email, messaging, alerts |\n</canonical_identifiers>\n\n<examples>\nCORRECT mappings:\n- \"User Authentication\" -> bf_user_management\n- \"Password Recovery\" -> bf_user_management  \n- \"API Gateway\" -> bf_integration\n- \"Email Service\" -> bf_communication\n- \"Order Processing\" -> bf_entity_management\n\nWRONG (do not create these):\n- bf_password_recovery (use bf_user_management instead)\n- bf_security_management (use bf_user_management instead)\n- bf_order_processing (use bf_entity_management instead)\n</examples>\n\nSELECTION: Include only concepts that clearly map to a canonical identifier.\nLIMIT: Maximum 3 BusinessFunction elements per repository.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bf_entity_management\",\n      \"name\": \"Entity Management\",\n      \"documentation\": \"Business capability for managing data entities and records\",\n      \"source\": \"concept_data_operations\",\n      \"confidence\": 0.85\n    },\n    {\n      \"identifier\": \"bf_user_management\",\n      \"name\": \"User Management\",\n      \"documentation\": \"Business capability for user authentication and account management\",\n      \"source\": \"concept_auth\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.1}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-12T22:44:06.707280"
  },
  {
    "id": 368,
    "step_name": "BusinessFunction",
    "phase": "generate",
    "version": 8,
    "sequence": 7,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (b:`Graph:BusinessConcept`) WHERE b.active = true AND b.conceptType IN [\"process\", \"actor\"] RETURN b.id as id, b.conceptName as name, b.conceptType as conceptType, b.description as description",
    "input_model_query": null,
    "instruction": "You are identifying BusinessFunction elements from business process concepts.\n\nA BusinessFunction represents a collection of business behavior grouped by common purpose.\n\n<critical_rule>\nYou MUST ONLY use identifiers from the canonical table below.\nDO NOT create ANY identifier that is not in this exact list.\nIf a concept doesn't clearly map to one of these, SKIP IT - do not create an element.\n</critical_rule>\n\n<canonical_identifiers>\n| Identifier | Name | Map From These Patterns |\n|------------|------|-------------------------|\n| bf_entity_management | Entity Management | CRUD, data operations, entities, records |\n| bf_integration | Integration | APIs, external systems, connections, webhooks |\n| bf_reporting | Reporting | reports, analytics, dashboards, metrics |\n| bf_user_management | User Management | auth, login, users, accounts, passwords, access |\n| bf_process_orchestration | Process Orchestration | workflows, pipelines, jobs, scheduling |\n| bf_communication | Communication | notifications, email, messaging, alerts |\n</canonical_identifiers>\n\n<examples>\nCORRECT mappings:\n- \"User Authentication\" -> bf_user_management\n- \"Password Recovery\" -> bf_user_management  \n- \"API Gateway\" -> bf_integration\n- \"Email Service\" -> bf_communication\n- \"Order Processing\" -> bf_entity_management\n\nWRONG (do not create these):\n- bf_password_recovery (use bf_user_management instead)\n- bf_security_management (use bf_user_management instead)\n- bf_order_processing (use bf_entity_management instead)\n</examples>\n\nSELECTION: Include only concepts that clearly map to a canonical identifier.\nLIMIT: Maximum 3 BusinessFunction elements per repository.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bf_entity_management\",\n      \"name\": \"Entity Management\",\n      \"documentation\": \"Business capability for managing data entities and records\",\n      \"source\": \"concept_data_operations\",\n      \"confidence\": 0.85\n    },\n    {\n      \"identifier\": \"bf_user_management\",\n      \"name\": \"User Management\",\n      \"documentation\": \"Business capability for user authentication and account management\",\n      \"source\": \"concept_auth\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T16:40:59.141494"
  },
  {
    "id": 387,
    "step_name": "BusinessFunction",
    "phase": "generate",
    "version": 9,
    "sequence": 7,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (b:`Graph:BusinessConcept`) WHERE b.active = true AND b.conceptType IN [\"process\", \"actor\"] RETURN b.id as id, b.conceptName as name, b.conceptType as conceptType, b.description as description",
    "input_model_query": null,
    "instruction": "<persona>\nYou are a senior enterprise architect with 15+ years of ArchiMate 3.2 expertise. You value semantic precision and consistent terminology above all else. You identify business functions based on organizational capabilities, not code structure.\n</persona>\n\n<definition>\nA BusinessFunction represents a collection of business behavior based on a chosen set of criteria (typically required business resources and/or competencies). Functions are ongoing organizational capabilities, not one-time activities.\n</definition>\n\n<semantic_exclusions>\nA BusinessFunction is NOT:\n- A BusinessProcess (function is capability, process is sequence)\n- An ApplicationService (function is business, service is application)\n- A specific activity or task (too granular)\n- A technical capability (that belongs to Application or Technology layer)\n\nDO NOT:\n- Model individual activities as functions\n- Create technical functions (logging, caching)\n- Duplicate ApplicationService capabilities at business level\n- Create functions with no identifiable processes\n</semantic_exclusions>\n\n<abstraction_constraint>\nCAPABILITY LEVEL: Model what the organization CAN do as ongoing capabilities.\n\nVALID (capabilities):\n- bf_customer_management, bf_order_fulfillment, bf_financial_management\n\nINVALID (too specific):\n- bf_handle_complaint, bf_process_refund, bf_send_invoice\n(These are processes, not functions)\n</abstraction_constraint>\n\n<function_test>\nVALIDATION RULE (apply to every candidate):\nA candidate BusinessFunction must answer \"What ongoing organizational capability does this represent?\" in one sentence using nouns, not verbs.\n\nREJECT if:\n- Description uses verbs (handles, processes, sends)\n- No ongoing capability can be identified\n- It describes a single activity rather than a capability area\n</function_test>\n\n<source_evidence>\nUSE BOTH CODE AND DOCUMENTATION as evidence:\n\nCode signals:\n- Module/package organization\n- Service groupings\n- Domain model structure\n\nDocumentation signals:\n- README sections\n- Domain descriptions\n- Business requirements\n- API documentation\n\nFunctions must have evidence from at least one source.\n</source_evidence>\n\n<naming_rules>\nIDENTIFIER FORMAT (MANDATORY):\n- Prefix: bf_\n- Format: bf_<capability_noun>\n- Style: lowercase snake_case\n- Use nouns or noun phrases (capabilities, not actions)\n\nNORMALIZATION PRECEDENCE:\n1. Prefer canonical patterns over derived names\n2. Prefer industry-standard capability names\n3. Prefer nouns over verbs (management, not manage)\n4. Prefer broader capabilities over narrow ones\n\nCONFLICT RESOLUTION:\n- bf_manage_customers vs bf_customer_management → choose bf_customer_management\n- bf_orders vs bf_order_fulfillment → choose bf_order_fulfillment (more complete)\n- bf_billing vs bf_financial_management → choose bf_financial_management (broader)\n</naming_rules>\n\n<canonical_patterns>\n| Capability Area | Identifier | Name |\n|-----------------|------------|------|\n| Customer/client operations | bf_customer_management | Customer Management |\n| Order/transaction processing | bf_order_fulfillment | Order Fulfillment |\n| Financial/accounting operations | bf_financial_management | Financial Management |\n| Inventory/stock operations | bf_inventory_control | Inventory Control |\n| Sales/marketing operations | bf_sales_marketing | Sales and Marketing |\n| Human resources | bf_human_resources | Human Resources |\n| IT/technology operations | bf_it_operations | IT Operations |\n| Compliance/legal | bf_compliance | Compliance |\n| Product/service management | bf_product_management | Product Management |\n| Partner/vendor management | bf_partner_management | Partner Management |\n</canonical_patterns>\n\n<selection_criteria>\nINCLUDE functions that:\n- Represent ongoing organizational capabilities\n- Group multiple related business processes\n- Require specific competencies or resources\n- Align with business domain structure\n\nEXCLUDE:\n- One-time projects\n- Technical utilities\n- Individual process steps\n- Implementation details\n</selection_criteria>\n\n<granularity_rules>\nTARGET: 2-5 BusinessFunctions per repository\n\nESCALATION RULES:\n- If > 5 candidates: merge into broader capabilities until <= 5\n- If < 2 candidates: verify business domain exists (pure technical libs may have none)\n- If 0 candidates: acceptable for infrastructure/utility repositories\n</granularity_rules>\n\n<process_linkage>\nEach BusinessFunction should group multiple BusinessProcesses.\n\nIf a function has only one process, consider:\n- Merging the function with another\n- The \"function\" may actually be a process\n</process_linkage>\n\n<determinism>\nORDERING: Sort elements alphabetically by identifier.\n\nCONFIDENCE BANDS (fixed):\n- 0.9-1.0: Clear domain structure with multiple processes\n- 0.8-0.89: Inferred from service organization\n- 0.7-0.79: Mentioned in documentation only\n\nCONSISTENCY:\n- Do not invent synonyms across runs\n- Use identical identifiers for identical capabilities\n- Given identical input, produce identical output\n</determinism>\n\n<output_format>\nJSON with \"elements\" array containing:\n- identifier: bf_ prefix + capability noun (snake_case)\n- name: Title Case capability name\n- documentation: One sentence describing the organizational capability\n- source: Source node ID (if derivable)\n- confidence: Per confidence bands above\n</output_format>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bf_entity_management\",\n      \"name\": \"Entity Management\",\n      \"documentation\": \"Business capability for managing data entities and records\",\n      \"source\": \"concept_data_operations\",\n      \"confidence\": 0.85\n    },\n    {\n      \"identifier\": \"bf_user_management\",\n      \"name\": \"User Management\",\n      \"documentation\": \"Business capability for user authentication and account management\",\n      \"source\": \"concept_auth\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T22:03:18.214872"
  },
  {
    "id": 317,
    "step_name": "BusinessFunction",
    "phase": "generate",
    "version": 3,
    "sequence": 7,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (b:`Graph:BusinessConcept`) WHERE b.active = true AND b.conceptType IN [\"capability\", \"service\"] RETURN b.id as id, b.conceptName as name, b.conceptType as conceptType, b.description as description",
    "input_model_query": null,
    "instruction": "You are identifying BusinessFunction elements from high-level capabilities.\n\nA BusinessFunction represents a collection of business behavior grouped by common purpose.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include modules with high pagerank (core capabilities)\n2. Include modules with multiple related methods (cohesive function)\n3. Prefer modules in k-core >= 2 (central to application)\n\nINCLUDE:\n- Major application capabilities (authentication, reporting, data management)\n- Domain-specific functions (billing, inventory, user management)\n- Integration functions (external API communication)\n\nEXCLUDE:\n- Low-level utility functions\n- Framework-provided capabilities\n- Infrastructure functions (logging, caching)\n\nNAMING RULES (MANDATORY):\n1. Identifier: bf_<capability_name>\n2. Use lowercase snake_case\n3. Use business terminology, not technical terms\n4. Keep names concise (1-3 words)\n\nLIMIT: Maximum 3-5 BusinessFunction elements.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bf_invoice_management\",\n      \"name\": \"Invoice Management\",\n      \"documentation\": \"Business capability for creating, tracking, and processing invoices\",\n      \"source\": \"concept_invoicing\",\n      \"confidence\": 0.85\n    },\n    {\n      \"identifier\": \"bf_payment_processing\",\n      \"name\": \"Payment Processing\",\n      \"documentation\": \"Business capability for handling payment transactions and reconciliation\",\n      \"source\": \"concept_payments\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-09T22:57:48.177988"
  },
  {
    "id": 352,
    "step_name": "BusinessFunction",
    "phase": "generate",
    "version": 4,
    "sequence": 7,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (b:`Graph:BusinessConcept`) WHERE b.active = true AND b.conceptType IN [\"process\", \"actor\"] RETURN b.id as id, b.conceptName as name, b.conceptType as conceptType, b.description as description",
    "input_model_query": null,
    "instruction": "You are identifying BusinessFunction elements from high-level capabilities.\n\nA BusinessFunction represents a collection of business behavior grouped by common purpose.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include modules with high pagerank (core capabilities)\n2. Include modules with multiple related methods (cohesive function)\n3. Prefer modules in k-core >= 2 (central to application)\n\nINCLUDE:\n- Major application capabilities (authentication, reporting, data management)\n- Domain-specific functions (billing, inventory, user management)\n- Integration functions (external API communication)\n\nEXCLUDE:\n- Low-level utility functions\n- Framework-provided capabilities\n- Infrastructure functions (logging, caching)\n\nNAMING RULES (MANDATORY):\n1. Identifier: bf_<capability_name>\n2. Use lowercase snake_case\n3. Use business terminology, not technical terms\n4. Keep names concise (1-3 words)\n\nLIMIT: Maximum 3-5 BusinessFunction elements.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bf_invoice_management\",\n      \"name\": \"Invoice Management\",\n      \"documentation\": \"Business capability for creating, tracking, and processing invoices\",\n      \"source\": \"concept_invoicing\",\n      \"confidence\": 0.85\n    },\n    {\n      \"identifier\": \"bf_payment_processing\",\n      \"name\": \"Payment Processing\",\n      \"documentation\": \"Business capability for handling payment transactions and reconciliation\",\n      \"source\": \"concept_payments\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T20:31:53.005180"
  },
  {
    "id": 353,
    "step_name": "BusinessFunction",
    "phase": "generate",
    "version": 5,
    "sequence": 7,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (b:`Graph:BusinessConcept`) WHERE b.active = true AND b.conceptType IN [\"process\", \"actor\"] RETURN b.id as id, b.conceptName as name, b.conceptType as conceptType, b.description as description",
    "input_model_query": null,
    "instruction": "You are identifying BusinessFunction elements from business process concepts.\n\nA BusinessFunction represents a collection of business behavior grouped by common purpose.\n\n<critical_rule>\nYou MUST ONLY use identifiers from the canonical table below.\nDO NOT create ANY identifier that is not in this exact list.\nIf a concept doesn't clearly map to one of these, SKIP IT - do not create an element.\n</critical_rule>\n\n<canonical_identifiers>\n| Identifier | Name | Map From These Patterns |\n|------------|------|-------------------------|\n| bf_entity_management | Entity Management | CRUD, data operations, entities, records |\n| bf_integration | Integration | APIs, external systems, connections, webhooks |\n| bf_reporting | Reporting | reports, analytics, dashboards, metrics |\n| bf_user_management | User Management | auth, login, users, accounts, passwords, access |\n| bf_process_orchestration | Process Orchestration | workflows, pipelines, jobs, scheduling |\n| bf_communication | Communication | notifications, email, messaging, alerts |\n</canonical_identifiers>\n\n<examples>\nCORRECT mappings:\n- \"User Authentication\" -> bf_user_management\n- \"Password Recovery\" -> bf_user_management  \n- \"API Gateway\" -> bf_integration\n- \"Email Service\" -> bf_communication\n- \"Order Processing\" -> bf_entity_management\n\nWRONG (do not create these):\n- bf_password_recovery (use bf_user_management instead)\n- bf_security_management (use bf_user_management instead)\n- bf_order_processing (use bf_entity_management instead)\n</examples>\n\nSELECTION: Include only concepts that clearly map to a canonical identifier.\nLIMIT: Maximum 3 BusinessFunction elements per repository.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bf_invoice_management\",\n      \"name\": \"Invoice Management\",\n      \"documentation\": \"Business capability for creating, tracking, and processing invoices\",\n      \"source\": \"concept_invoicing\",\n      \"confidence\": 0.85\n    },\n    {\n      \"identifier\": \"bf_payment_processing\",\n      \"name\": \"Payment Processing\",\n      \"documentation\": \"Business capability for handling payment transactions and reconciliation\",\n      \"source\": \"concept_payments\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T20:36:23.288497"
  },
  {
    "id": 354,
    "step_name": "BusinessFunction",
    "phase": "generate",
    "version": 6,
    "sequence": 7,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (b:`Graph:BusinessConcept`) WHERE b.active = true AND b.conceptType IN [\"process\", \"actor\"] RETURN b.id as id, b.conceptName as name, b.conceptType as conceptType, b.description as description",
    "input_model_query": null,
    "instruction": "You are identifying BusinessFunction elements from business process concepts.\n\nA BusinessFunction represents a collection of business behavior grouped by common purpose.\n\n<critical_rule>\nYou MUST ONLY use identifiers from the canonical table below.\nDO NOT create ANY identifier that is not in this exact list.\nIf a concept doesn't clearly map to one of these, SKIP IT - do not create an element.\n</critical_rule>\n\n<canonical_identifiers>\n| Identifier | Name | Map From These Patterns |\n|------------|------|-------------------------|\n| bf_entity_management | Entity Management | CRUD, data operations, entities, records |\n| bf_integration | Integration | APIs, external systems, connections, webhooks |\n| bf_reporting | Reporting | reports, analytics, dashboards, metrics |\n| bf_user_management | User Management | auth, login, users, accounts, passwords, access |\n| bf_process_orchestration | Process Orchestration | workflows, pipelines, jobs, scheduling |\n| bf_communication | Communication | notifications, email, messaging, alerts |\n</canonical_identifiers>\n\n<examples>\nCORRECT mappings:\n- \"User Authentication\" -> bf_user_management\n- \"Password Recovery\" -> bf_user_management  \n- \"API Gateway\" -> bf_integration\n- \"Email Service\" -> bf_communication\n- \"Order Processing\" -> bf_entity_management\n\nWRONG (do not create these):\n- bf_password_recovery (use bf_user_management instead)\n- bf_security_management (use bf_user_management instead)\n- bf_order_processing (use bf_entity_management instead)\n</examples>\n\nSELECTION: Include only concepts that clearly map to a canonical identifier.\nLIMIT: Maximum 3 BusinessFunction elements per repository.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bf_invoice_management\",\n      \"name\": \"Invoice Management\",\n      \"documentation\": \"Business capability for creating, tracking, and processing invoices\",\n      \"source\": \"concept_invoicing\",\n      \"confidence\": 0.85\n    },\n    {\n      \"identifier\": \"bf_payment_processing\",\n      \"name\": \"Payment Processing\",\n      \"documentation\": \"Business capability for handling payment transactions and reconciliation\",\n      \"source\": \"concept_payments\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.1}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T20:43:06.034401"
  },
  {
    "id": 211,
    "step_name": "BusinessEvent",
    "phase": "generate",
    "version": 2,
    "sequence": 8,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:Method` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\n  AND (n.out_degree > 0 OR n.pagerank > 0.01)\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties,\n       n.pagerank as pagerank,\n       n.kcore_level as kcore_level",
    "input_model_query": null,
    "instruction": "You are identifying BusinessEvent elements from business concepts.\n\nA BusinessEvent represents an organizational state change that triggers behavior:\n- Domain events (Order Placed, Payment Received, Invoice Sent)\n- State transitions (Account Activated, Subscription Expired)\n- External triggers (Customer Request, System Alert)\n\nEach candidate includes concept information and graph metrics.\n\nReview each candidate and decide which should become BusinessEvent elements.\n\nINCLUDE concepts that:\n- Represent a point-in-time occurrence\n- Trigger subsequent business processes\n- Mark important state changes\n- Would appear in event-driven architecture\n\nEXCLUDE concepts that:\n- Are ongoing processes (those are BusinessProcess)\n- Are static data (those are BusinessObjects)\n- Are too technical or internal\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: be_<event_name>\n2. Use Title Case for display name\n3. Use past tense for completed events (e.g., \"Invoice Generated\")\n4. Use present tense for triggers (e.g., \"Payment Due\")\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"be_invoice_generated\",\n      \"name\": \"Invoice Generated\",\n      \"documentation\": \"Event triggered when a new invoice is created in the system\",\n      \"source\": \"concept_invoice_creation\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"be_payment_received\",\n      \"name\": \"Payment Received\",\n      \"documentation\": \"Event triggered when payment is successfully processed\",\n      \"source\": \"concept_payment\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-08T13:07:14.037233"
  },
  {
    "id": 108,
    "step_name": "BusinessEvent",
    "phase": "generate",
    "version": 1,
    "sequence": 8,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (b:`Graph:BusinessConcept`) WHERE b.active = true AND b.conceptType IN [\"process\", \"event\"] RETURN b.id as id, b.conceptName as name, b.conceptType as conceptType, b.description as description",
    "input_model_query": null,
    "instruction": "Map domain events to BusinessEvent elements. Focus on state changes that trigger business processes or decisions.",
    "example": "{\"identifier\":\"be:order-placed\",\"name\":\"Order Placed\",\"trigger\":\"Customer completes checkout\",\"confidence\":0.6}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.108475"
  },
  {
    "id": 374,
    "step_name": "BusinessEvent",
    "phase": "generate",
    "version": 5,
    "sequence": 8,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:Method` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\n  AND (n.out_degree > 0 OR n.pagerank > 0.01)\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties,\n       n.pagerank as pagerank,\n       n.kcore_level as kcore_level",
    "input_model_query": null,
    "instruction": "You are identifying BusinessEvent elements from event-driven patterns.\n\nA BusinessEvent represents a state change that has business significance.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include events with out_degree >= 1 (triggers other actions)\n2. Include events referenced by multiple handlers\n3. Prefer events with clear business names\n\nINCLUDE:\n- Domain events (state changes, status updates)\n- User actions with business meaning\n- Integration events (webhooks, notifications)\n\nEXCLUDE:\n- Technical events (errors, logs, metrics)\n- Framework lifecycle events\n- Internal system signals\n\nNAMING RULES (MANDATORY):\n1. Identifier: be_<noun>_<past_verb>\n2. Use lowercase snake_case\n3. Format: Entity + past tense action (e.g., order_placed, payment_received)\n4. Use business terminology\n\nLIMIT: Maximum 3-5 BusinessEvent elements.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"be_invoice_generated\",\n      \"name\": \"Invoice Generated\",\n      \"documentation\": \"Event triggered when a new invoice is created in the system\",\n      \"source\": \"concept_invoice_creation\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"be_payment_received\",\n      \"name\": \"Payment Received\",\n      \"documentation\": \"Event triggered when payment is successfully processed\",\n      \"source\": \"concept_payment\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T19:03:04.289885"
  },
  {
    "id": 386,
    "step_name": "BusinessEvent",
    "phase": "generate",
    "version": 7,
    "sequence": 8,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:Method` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\n  AND (n.out_degree > 0 OR n.pagerank > 0.01)\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties,\n       n.pagerank as pagerank,\n       n.kcore_level as kcore_level",
    "input_model_query": null,
    "instruction": "<persona>\nYou are a senior enterprise architect with 15+ years of ArchiMate 3.2 expertise. You value semantic precision and consistent terminology above all else. You identify business events based on their business significance, not technical occurrence.\n</persona>\n\n<definition>\nA BusinessEvent represents a significant occurrence that triggers or is triggered by business behavior. Events mark meaningful state changes or milestones in business processes.\n</definition>\n\n<semantic_exclusions>\nA BusinessEvent is NOT:\n- A technical exception or error (system_error, timeout)\n- A logging event (debug, info, trace)\n- A UI interaction (click, hover, scroll)\n- An internal state mutation without business meaning\n\nDO NOT:\n- Model technical errors as business events\n- Model framework lifecycle events\n- Model internal implementation signals\n- Create events that exist only in code without business meaning\n</semantic_exclusions>\n\n<scope_constraint>\nBUSINESS EVENTS ONLY: Only model events with genuine business significance.\n\nVALID events:\n- be_order_placed, be_payment_received, be_shipment_dispatched\n- be_user_registered, be_contract_signed, be_invoice_generated\n\nINVALID events (do not model):\n- SystemException, TimeoutError, ValidationFailed\n- RequestReceived, ResponseSent, CacheInvalidated\n- onClick, onLoad, onSubmit\n</scope_constraint>\n\n<process_linkage_constraint>\nSTRICT PROCESS LINKAGE: Every BusinessEvent must either:\n1. TRIGGER a BusinessProcess (event causes process to start), OR\n2. BE PRODUCED BY a BusinessProcess (process causes event to occur)\n\nIf an event has no process linkage, do not create it.\n\nExamples:\n- be_order_placed TRIGGERS bp_process_order\n- bp_generate_invoice PRODUCES be_invoice_generated\n</process_linkage_constraint>\n\n<event_test>\nVALIDATION RULE (apply to every candidate):\nA candidate BusinessEvent must answer \"What business process does this trigger or what process produces this?\" in one sentence.\n\nREJECT if:\n- No process linkage can be identified\n- The event is purely technical\n- It describes internal implementation detail\n</event_test>\n\n<naming_rules>\nIDENTIFIER FORMAT (MANDATORY):\n- Prefix: be_\n- Format: be_<entity>_<past_tense_action>\n- Style: lowercase snake_case\n- Use past tense for completed events\n\nNORMALIZATION PRECEDENCE:\n1. Prefer canonical patterns over derived names\n2. Prefer business terminology over technical terms\n3. Prefer past tense (placed, received) over present (place, receive)\n4. Prefer entity + action pattern\n\nCONFLICT RESOLUTION:\n- be_order_created vs be_order_placed → choose be_order_placed (more business-like)\n- be_new_user vs be_user_registered → choose be_user_registered (past tense)\n- be_paid vs be_payment_received → choose be_payment_received (explicit)\n</naming_rules>\n\n<canonical_patterns>\n| Event Type | Identifier Pattern | Example |\n|------------|-------------------|---------|\n| Entity creation | be_<entity>_created | be_order_created |\n| Entity placement | be_<entity>_placed | be_order_placed |\n| Entity completion | be_<entity>_completed | be_payment_completed |\n| Entity dispatch | be_<entity>_dispatched | be_shipment_dispatched |\n| Entity receipt | be_<entity>_received | be_payment_received |\n| Entity approval | be_<entity>_approved | be_request_approved |\n| Entity registration | be_<entity>_registered | be_user_registered |\n| Entity cancellation | be_<entity>_cancelled | be_order_cancelled |\n</canonical_patterns>\n\n<selection_criteria>\nINCLUDE events that:\n- Have clear business significance\n- Trigger or are produced by business processes\n- Mark state changes visible to stakeholders\n- Are published to event buses or queues (if applicable)\n\nEXCLUDE:\n- Technical exceptions and errors\n- Debug/logging events\n- UI interaction events\n- Internal implementation signals\n</selection_criteria>\n\n<granularity_rules>\nTARGET: 3-8 BusinessEvents per repository\n\nESCALATION RULES:\n- If > 8 candidates: merge related events or keep only the most significant\n- If < 3 candidates: verify if business events exist (some CRUD apps have few)\n- If 0 candidates: acceptable for pure utility libraries\n</granularity_rules>\n\n<determinism>\nORDERING: Sort elements alphabetically by identifier.\n\nCONFIDENCE BANDS (fixed):\n- 0.9-1.0: Explicit event classes or event bus publications\n- 0.8-0.89: Inferred events from process flow analysis\n- 0.7-0.79: Events mentioned in documentation\n\nCONSISTENCY:\n- Do not invent synonyms across runs\n- Use identical identifiers for identical events\n- Given identical input, produce identical output\n</determinism>\n\n<output_format>\nJSON with \"elements\" array containing:\n- identifier: be_ prefix + entity + past_tense_action (snake_case)\n- name: Title Case event name\n- documentation: One sentence describing what triggers this or what this triggers\n- source: Source node ID\n- confidence: Per confidence bands above\n</output_format>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"be_invoice_generated\",\n      \"name\": \"Invoice Generated\",\n      \"documentation\": \"Event triggered when a new invoice is created in the system\",\n      \"source\": \"concept_invoice_creation\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"be_payment_received\",\n      \"name\": \"Payment Received\",\n      \"documentation\": \"Event triggered when payment is successfully processed\",\n      \"source\": \"concept_payment\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T22:00:29.406391"
  },
  {
    "id": 318,
    "step_name": "BusinessEvent",
    "phase": "generate",
    "version": 3,
    "sequence": 8,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:Method` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\n  AND (n.out_degree > 0 OR n.pagerank > 0.01)\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties,\n       n.pagerank as pagerank,\n       n.kcore_level as kcore_level",
    "input_model_query": null,
    "instruction": "You are identifying BusinessEvent elements from event-driven patterns.\n\nA BusinessEvent represents a state change that has business significance.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include events with out_degree >= 1 (triggers other actions)\n2. Include events referenced by multiple handlers\n3. Prefer events with clear business names\n\nINCLUDE:\n- Domain events (state changes, status updates)\n- User actions with business meaning\n- Integration events (webhooks, notifications)\n\nEXCLUDE:\n- Technical events (errors, logs, metrics)\n- Framework lifecycle events\n- Internal system signals\n\nNAMING RULES (MANDATORY):\n1. Identifier: be_<noun>_<past_verb>\n2. Use lowercase snake_case\n3. Format: Entity + past tense action (e.g., order_placed, payment_received)\n4. Use business terminology\n\nLIMIT: Maximum 3-5 BusinessEvent elements.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"be_invoice_generated\",\n      \"name\": \"Invoice Generated\",\n      \"documentation\": \"Event triggered when a new invoice is created in the system\",\n      \"source\": \"concept_invoice_creation\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"be_payment_received\",\n      \"name\": \"Payment Received\",\n      \"documentation\": \"Event triggered when payment is successfully processed\",\n      \"source\": \"concept_payment\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-09T22:57:57.404342"
  },
  {
    "id": 377,
    "step_name": "BusinessEvent",
    "phase": "generate",
    "version": 6,
    "sequence": 8,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:Method` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\n  AND (n.out_degree > 0 OR n.pagerank > 0.01)\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties,\n       n.pagerank as pagerank,\n       n.kcore_level as kcore_level",
    "input_model_query": null,
    "instruction": "<business_event_derivation>\n\n<definition>\nA BusinessEvent represents a state change that has business significance - something that happened that business stakeholders care about.\n</definition>\n\n<canonical_identifiers>\nUse EXACTLY these identifiers. Choose the BEST match:\n\n| Pattern | Identifier | Name |\n|---------|------------|------|\n| Order created, placed, submitted | be_order_created | Order Created |\n| Order completed, fulfilled, shipped | be_order_completed | Order Completed |\n| Order cancelled, rejected | be_order_cancelled | Order Cancelled |\n| Payment received, processed, confirmed | be_payment_received | Payment Received |\n| Payment failed, declined | be_payment_failed | Payment Failed |\n| User registered, signed up | be_user_registered | User Registered |\n| User logged in, authenticated | be_user_logged_in | User Logged In |\n| Document uploaded, attached | be_document_uploaded | Document Uploaded |\n| Process started, initiated | be_process_started | Process Started |\n| Process completed, finished | be_process_completed | Process Completed |\n| Notification sent, dispatched | be_notification_sent | Notification Sent |\n\n</canonical_identifiers>\n\n<rules>\n1. Use ONLY identifiers from the table above\n2. If no match found, DO NOT derive a BusinessEvent\n3. Maximum 3-5 BusinessEvent elements per repository\n4. Use past tense for the verb (created, completed, received)\n5. Focus on events with BUSINESS meaning, not technical events\n</rules>\n\n<exclude>\n- Error events (error_occurred, exception_thrown)\n- Log events (log_written, metric_recorded)\n- Technical events (cache_invalidated, connection_closed)\n- Framework events (request_received, response_sent)\n</exclude>\n\n<output_requirements>\n- identifier: EXACT match from table above\n- name: Human readable name from table\n- documentation: Description of when this event occurs\n- source: Reference to source event handler or method\n- confidence: 0.8-1.0\n</output_requirements>\n</business_event_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"be_invoice_generated\",\n      \"name\": \"Invoice Generated\",\n      \"documentation\": \"Event triggered when a new invoice is created in the system\",\n      \"source\": \"concept_invoice_creation\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"be_payment_received\",\n      \"name\": \"Payment Received\",\n      \"documentation\": \"Event triggered when payment is successfully processed\",\n      \"source\": \"concept_payment\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T19:21:10.743369"
  },
  {
    "id": 367,
    "step_name": "BusinessEvent",
    "phase": "generate",
    "version": 4,
    "sequence": 8,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:Method` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\n  AND (n.out_degree > 0 OR n.pagerank > 0.01)\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties,\n       n.pagerank as pagerank,\n       n.kcore_level as kcore_level",
    "input_model_query": null,
    "instruction": "You are identifying BusinessEvent elements from event-driven patterns.\n\nA BusinessEvent represents a state change that has business significance.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include events with out_degree >= 1 (triggers other actions)\n2. Include events referenced by multiple handlers\n3. Prefer events with clear business names\n\nINCLUDE:\n- Domain events (state changes, status updates)\n- User actions with business meaning\n- Integration events (webhooks, notifications)\n\nEXCLUDE:\n- Technical events (errors, logs, metrics)\n- Framework lifecycle events\n- Internal system signals\n\nNAMING RULES (MANDATORY):\n1. Identifier: be_<noun>_<past_verb>\n2. Use lowercase snake_case\n3. Format: Entity + past tense action (e.g., order_placed, payment_received)\n4. Use business terminology\n\nLIMIT: Maximum 3-5 BusinessEvent elements.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"be_invoice_generated\",\n      \"name\": \"Invoice Generated\",\n      \"documentation\": \"Event triggered when a new invoice is created in the system\",\n      \"source\": \"concept_invoice_creation\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"be_payment_received\",\n      \"name\": \"Payment Received\",\n      \"documentation\": \"Event triggered when payment is successfully processed\",\n      \"source\": \"concept_payment\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T16:40:58.391336"
  },
  {
    "id": 217,
    "step_name": "BusinessActor",
    "phase": "generate",
    "version": 2,
    "sequence": 9,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\n  AND (n.out_degree > 0 OR n.pagerank > 0.01)\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties,\n       n.pagerank as pagerank,\n       n.kcore_level as kcore_level",
    "input_model_query": null,
    "instruction": "You are identifying BusinessActor elements from source code types and concepts.\n\nA BusinessActor represents a business entity capable of performing behavior:\n- Users and roles (Customer, Administrator, Operator)\n- Organizational units (Department, Team)\n- External parties (Supplier, Partner)\n\nEach candidate includes graph metrics to help assess importance.\n\nReview each candidate and decide which should become BusinessActor elements.\n\nINCLUDE types that:\n- Represent people or organizational roles\n- Can take actions or make decisions\n- Would appear in user stories or use cases\n- Have names ending in -er, -or, -ist, or role titles\n\nEXCLUDE types that:\n- Are data entities (those are BusinessObject) - Customer DATA is BusinessObject, Customer ROLE is BusinessActor\n- Are processes or functions\n- Are technical components\n\nIMPORTANT DISTINCTION:\n- If a type represents DATA about a customer/user → BusinessObject\n- If a type represents the ROLE/ACTOR who performs actions → BusinessActor\n- When in doubt, prefer BusinessObject for data-centric types\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: ba_<role>\n2. Use Title Case for display name\n3. Use role names, not data names:\n   - \"Invoice Creator\" (for the person creating invoices)\n   - \"System Administrator\" (for admin role)\n\nOutput stable, deterministic results. Only create BusinessActor elements when the type clearly represents an actor/role, not just data.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"ba_invoice_creator\",\n      \"name\": \"Invoice Creator\",\n      \"documentation\": \"User role responsible for creating and managing invoices\",\n      \"source\": \"concept_user\",\n      \"confidence\": 0.8\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-08T13:12:39.293693"
  },
  {
    "id": 109,
    "step_name": "BusinessActor",
    "phase": "generate",
    "version": 1,
    "sequence": 9,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying BusinessActor elements from source code types and concepts.\n\nA BusinessActor represents a business entity capable of performing behavior:\n- Users and roles (Customer, Administrator, Operator)\n- Organizational units (Department, Team)\n- External parties (Supplier, Partner)\n- System actors when they represent a logical role\n\nEach candidate includes graph metrics to help assess importance.\n\nReview each candidate and decide which should become BusinessActor elements.\n\nINCLUDE types that:\n- Represent people, roles, or organizational entities\n- Can initiate or perform business activities\n- Would appear in a business context diagram\n- Have names indicating actors (User, Customer, Manager, etc.)\n\nEXCLUDE types that:\n- Represent data/information (Invoice, Order, Report)\n- Are technical components (Controller, Handler, Service)\n- Are utility/framework classes\n- Are abstract base classes\n\nWhen naming:\n- Use role names (e.g., \"Customer\" not \"CustomerModel\")\n- Be specific about the actor's function\n\nNAMING RULES REMINDER:\n- Use lowercase snake_case for identifiers\n- Use consistent prefix for element type\n- Keep names generic and stable\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"ba_customer\",\n      \"name\": \"Customer\",\n      \"documentation\": \"External party who purchases products or services and receives invoices\",\n      \"source\": \"type_Customer\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"ba_administrator\",\n      \"name\": \"Administrator\",\n      \"documentation\": \"Internal user with elevated privileges for system management\",\n      \"source\": \"type_Admin\",\n      \"confidence\": 0.9\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "max_candidates": 20,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.110968"
  },
  {
    "id": 344,
    "step_name": "BusinessActor",
    "phase": "generate",
    "version": 5,
    "sequence": 9,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<business_actor_derivation>\n\n<task>\nAnalyze the provided code nodes and identify BusinessActor elements. BusinessActors are ORGANIZATIONAL ENTITIES - user roles, stakeholders, or external systems.\n</task>\n\n<strict_criteria>\nA valid BusinessActor MUST be:\n- An explicitly defined user ROLE (like AdminUser, CustomerAccount, OperatorRole)\n- An authentication/authorization subject\n- An external system that integrates via API\n\nA valid BusinessActor is NOT:\n- A data class or model (Invoice, Customer, Position, Order)\n- A function or method\n- A UI form or view\n- A business object or entity (these go in BusinessObject)\n</strict_criteria>\n\n<important>\nIf the input nodes are all data structures, functions, or business entities with NO explicit user roles or external systems, you MUST return:\n{\"elements\": []}\n\nThis is the correct response. Empty is valid. Do not invent actors from data objects.\n</important>\n\n<naming>\nFormat: ba_<category> (lowercase_snake_case)\n\n| Role Pattern | Identifier |\n|--------------|------------|\n| Administrator, Admin, SuperUser | ba_administrator |\n| User, EndUser, Customer | ba_end_user |\n| ExternalSystem, APIClient | ba_external_system |\n</naming>\n\n<constraints>\n- Maximum 2-3 elements\n- One per role category\n- When in doubt, exclude\n</constraints>\n\n</business_actor_derivation>\n",
    "example": "{\n  \"elements\": []\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T08:59:15.172854"
  },
  {
    "id": 362,
    "step_name": "BusinessActor",
    "phase": "generate",
    "version": 8,
    "sequence": 9,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<business_actor_derivation>\nYou are identifying BusinessActor elements from user types and organizational roles.\n\n<definition>\nA BusinessActor represents an organizational entity capable of performing behavior - the \"who\" in business processes. These are people or organizations, NOT systems.\n</definition>\n\n<canonical_identifiers>\nUse EXACTLY these identifiers. Choose the BEST match:\n\n| Pattern | Identifier | Name |\n|---------|------------|------|\n| Admin, Administrator, SuperUser | ba_administrator | Administrator |\n| User, Customer, Client | ba_end_user | End User |\n| Developer, Engineer, Programmer | ba_developer | Developer |\n| Manager, Owner, Lead | ba_manager | Manager |\n| External system, Partner API | ba_external_system | External System |\n| Anonymous, Guest, Public | ba_anonymous_user | Anonymous User |\n| Operator, Support, Helpdesk | ba_operator | Operator |\n| Auditor, Compliance, Security | ba_auditor | Auditor |\n\n</canonical_identifiers>\n\n<rules>\n1. Use ONLY identifiers from the table above\n2. Map all admin-like roles to ba_administrator\n3. Map all regular user roles to ba_end_user\n4. Maximum 3-5 BusinessActor elements per repository\n5. Exclude technical types (Handler, Service, Manager class names)\n6. Exclude test users and mock actors\n</rules>\n\n<output_requirements>\n- Use SINGULAR form always\n- Use EXACT identifiers from the table\n- Include source reference (typedef, file, or concept)\n- Include confidence score (0.8-1.0)\n</output_requirements>\n</business_actor_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"ba_end_user\",\n      \"name\": \"End User\",\n      \"documentation\": \"Primary user of the application who consumes services\",\n      \"source\": \"typedef_user_model\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"ba_administrator\",\n      \"name\": \"Administrator\",\n      \"documentation\": \"User with elevated privileges for system management\",\n      \"source\": \"typedef_admin_role\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0, \"max_candidates\": 15, \"batch_size\": 5}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T16:39:54.381206"
  },
  {
    "id": 346,
    "step_name": "BusinessActor",
    "phase": "generate",
    "version": 7,
    "sequence": 9,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<business_actor_derivation>\n\n<task>\nIdentify BusinessActor elements from the provided code nodes. BusinessActors represent organizational entities that interact with the application.\n</task>\n\n<derivation_approach>\nAnalyze the code to identify WHO interacts with the system:\n\n1. **Explicit roles**: User classes, AuthUser, AdminRole, etc.\n2. **Implicit users**: If the code has user-facing forms/views/interfaces, there is an implicit end user\n\nFor applications with user interfaces (forms, views, templates) but no explicit user roles:\n- Create ONE ba_end_user to represent the implicit user interacting with the system\n</derivation_approach>\n\n<naming>\nFormat: ba_<category> (lowercase_snake_case)\n\n| Pattern | Identifier |\n|---------|------------|\n| Administrator, Admin | ba_administrator |\n| User, EndUser (explicit or implicit) | ba_end_user |\n| ExternalSystem, API | ba_external_system |\n</naming>\n\n<constraints>\n- Maximum 2 elements\n- One per category\n- For implicit users, ALWAYS use ba_end_user (never invent specific roles)\n</constraints>\n\n<determinism>\nBe consistent: If the application has user-facing interfaces, ALWAYS include ba_end_user. If it has admin interfaces, ALWAYS include ba_administrator.\n</determinism>\n\n</business_actor_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"ba_end_user\",\n      \"name\": \"End User\",\n      \"documentation\": \"User interacting with the application interfaces\",\n      \"source\": \"form_invoice\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T09:09:50.105415"
  },
  {
    "id": 319,
    "step_name": "BusinessActor",
    "phase": "generate",
    "version": 3,
    "sequence": 9,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\n  AND (n.out_degree > 0 OR n.pagerank > 0.01)\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties,\n       n.pagerank as pagerank,\n       n.kcore_level as kcore_level",
    "input_model_query": null,
    "instruction": "You are identifying BusinessActor elements from user roles and external entities.\n\nA BusinessActor represents an organizational entity capable of performing behavior.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include actors referenced by multiple endpoints\n2. Include actors with distinct permission sets\n3. Prefer actors mentioned in authentication/authorization code\n\nINCLUDE:\n- User roles with specific permissions\n- External systems that interact with the application\n- Organizational entities (departments, teams)\n\nEXCLUDE:\n- Generic actors (User, Admin, System)\n- Technical service accounts\n- Internal system components\n\nNAMING RULES (MANDATORY):\n1. Identifier: ba_<role_name>\n2. Use lowercase snake_case\n3. Use business role names, not technical identifiers\n4. Be specific: ba_account_manager NOT ba_user\n\nLIMIT: Maximum 2-4 BusinessActor elements.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"ba_invoice_creator\",\n      \"name\": \"Invoice Creator\",\n      \"documentation\": \"User role responsible for creating and managing invoices\",\n      \"source\": \"concept_user\",\n      \"confidence\": 0.8\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-09T22:58:06.078397"
  },
  {
    "id": 345,
    "step_name": "BusinessActor",
    "phase": "generate",
    "version": 6,
    "sequence": 9,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<business_actor_derivation>\n\n<task>\nIdentify BusinessActor elements from the provided code nodes. BusinessActors represent organizational entities that interact with the application.\n</task>\n\n<derivation_approach>\nAnalyze the code to identify WHO interacts with the system:\n\n1. **Explicit roles**: User classes, AuthUser, AdminRole, etc.\n2. **Implicit users**: If the code has user-facing forms/views/interfaces, there is an implicit end user\n\nFor applications with user interfaces (forms, views, templates) but no explicit user roles:\n- Create ONE ba_end_user to represent the implicit user interacting with the system\n</derivation_approach>\n\n<naming>\nFormat: ba_<category> (lowercase_snake_case)\n\n| Pattern | Identifier |\n|---------|------------|\n| Administrator, Admin | ba_administrator |\n| User, EndUser (explicit or implicit) | ba_end_user |\n| ExternalSystem, API | ba_external_system |\n</naming>\n\n<constraints>\n- Maximum 2 elements\n- One per category\n- For implicit users, ALWAYS use ba_end_user (never invent specific roles)\n</constraints>\n\n<determinism>\nBe consistent: If the application has user-facing interfaces, ALWAYS include ba_end_user. If it has admin interfaces, ALWAYS include ba_administrator.\n</determinism>\n\n</business_actor_derivation>\n",
    "example": "{\n  \"elements\": []\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T09:09:32.909088"
  },
  {
    "id": 343,
    "step_name": "BusinessActor",
    "phase": "generate",
    "version": 4,
    "sequence": 9,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<business_actor_derivation>\n\n<definition>\nA BusinessActor represents an organizational entity capable of performing behavior - specifically user roles, stakeholders, or external systems that INTERACT with the application.\n</definition>\n\n<critical_filter>\nONLY include nodes that explicitly represent:\n- User roles (admin, user, operator, manager)\n- Authentication subjects (logged-in entities)\n- External systems (API clients, integration endpoints)\n\nDO NOT include:\n- Data structures (Invoice, Position, Customer as data)\n- Functions or methods (create_app, validate_input)\n- UI components (forms, views, templates)\n- Business objects (these belong in BusinessObject)\n- Type definitions for data models\n</critical_filter>\n\n<when_to_return_empty>\nIf none of the candidate nodes represent actual user roles or external systems, return {\"elements\": []}. This is correct behavior - not all applications have explicitly modeled BusinessActors.\n</when_to_return_empty>\n\n<naming_approach>\nFormat: ba_<role_category> in lowercase_snake_case\n\n| Source Pattern | Identifier |\n|----------------|------------|\n| Admin, Administrator, SuperUser | ba_administrator |\n| User, EndUser, Customer | ba_end_user |\n| System, ExternalAPI, Integration | ba_external_system |\n| Operator, Support | ba_operator |\n</naming_approach>\n\n<constraints>\n- Maximum 2-3 BusinessActor elements\n- One actor per CATEGORY of role\n- If uncertain whether a candidate is an actor, exclude it\n</constraints>\n\n</business_actor_derivation>\n",
    "example": "{\n  \"elements\": []\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T08:54:15.463225"
  },
  {
    "id": 385,
    "step_name": "BusinessActor",
    "phase": "generate",
    "version": 9,
    "sequence": 9,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<persona>\nYou are a senior enterprise architect with 15+ years of ArchiMate 3.2 expertise. You value semantic precision and consistent terminology above all else. You identify business actors based on their organizational role and business responsibilities.\n</persona>\n\n<definition>\nA BusinessActor represents an organizational entity capable of performing behavior. These are the human roles that interact with the system from a business perspective.\n</definition>\n\n<semantic_exclusions>\nA BusinessActor is NOT:\n- A system account (scheduler, worker, service account)\n- An ApplicationComponent or technical entity\n- A user instance (specific person like \"John\")\n- An external system (that belongs to Technology Layer)\n\nDO NOT:\n- Model technical service accounts as actors\n- Model background processes as actors\n- Create actors for test users\n- Model the same role under different names\n</semantic_exclusions>\n\n<scope_constraint>\nHUMAN ROLES ONLY: Only model organizational roles representing humans.\n\nDO NOT model as BusinessActor:\n- Scheduler, cron, background_worker\n- Service accounts, API clients\n- External systems or integrations (use TechnologyService or Node)\n- Anonymous/unauthenticated access (unless explicit guest role)\n</scope_constraint>\n\n<role_constraint>\nDISTINCT ROLES ONLY: Model each role as a separate, independent actor.\n\nDO NOT:\n- Model role hierarchies or inheritance\n- Create parent-child role relationships\n- Assume one role includes another's capabilities\n\nEach role stands alone based on its distinct business responsibilities.\n</role_constraint>\n\n<actor_test>\nVALIDATION RULE (apply to every candidate):\nA candidate BusinessActor must answer \"What business decisions or actions can this human role perform?\" in one sentence.\n\nREJECT if:\n- The role is automated/non-human\n- No distinct business responsibility can be identified\n- It duplicates another role's capabilities\n</actor_test>\n\n<naming_rules>\nIDENTIFIER FORMAT (MANDATORY):\n- Prefix: ba_\n- Format: ba_<role_name>\n- Style: lowercase snake_case\n- Use organizational role names, not technical identifiers\n\nNORMALIZATION PRECEDENCE:\n1. Prefer canonical patterns over derived names\n2. Prefer industry-standard role names\n3. Prefer singular over plural\n4. Prefer specific role over generic \"user\"\n\nCONFLICT RESOLUTION:\n- ba_user vs ba_customer → choose ba_customer (more specific)\n- ba_super_admin vs ba_administrator → choose ba_administrator (standard)\n- ba_staff vs ba_employee → choose ba_employee (standard)\n</naming_rules>\n\n<canonical_patterns>\n| Role Pattern | Identifier | Name |\n|--------------|------------|------|\n| Admin, administrator, superuser | ba_administrator | Administrator |\n| Customer, client, buyer, end user | ba_customer | Customer |\n| Manager, supervisor, team lead | ba_manager | Manager |\n| Support, helpdesk, customer service | ba_support_agent | Support Agent |\n| Developer, engineer, programmer | ba_developer | Developer |\n| Auditor, compliance officer | ba_auditor | Auditor |\n| Guest, anonymous, public | ba_guest | Guest |\n| Operator, operations staff | ba_operator | Operator |\n| Analyst, data analyst | ba_analyst | Analyst |\n</canonical_patterns>\n\n<selection_criteria>\nINCLUDE actors that:\n- Have distinct permissions or capabilities\n- Represent real organizational roles\n- Are referenced in authorization/RBAC code\n- Make business decisions or actions\n\nEXCLUDE:\n- Technical/service accounts\n- Test users\n- Deprecated/legacy roles\n- Roles with no distinct capabilities\n</selection_criteria>\n\n<granularity_rules>\nTARGET: 2-5 BusinessActors per repository\n\nESCALATION RULES:\n- If > 5 candidates: merge overlapping roles until <= 5\n- If < 2 candidates: verify if authorization exists (some systems have single role)\n- If 0 candidates: acceptable for internal tools with no user-facing features\n</granularity_rules>\n\n<determinism>\nORDERING: Sort elements alphabetically by identifier.\n\nCONFIDENCE BANDS (fixed):\n- 0.9-1.0: Explicit role definitions in code (RBAC, permissions)\n- 0.8-0.89: Inferred roles from authorization checks\n- 0.7-0.79: Roles mentioned in documentation or comments\n\nCONSISTENCY:\n- Do not invent synonyms across runs\n- Use identical identifiers for identical roles\n- Given identical input, produce identical output\n</determinism>\n\n<output_format>\nJSON with \"elements\" array containing:\n- identifier: ba_ prefix + role name (snake_case)\n- name: Title Case role name\n- documentation: One sentence describing business responsibilities\n- source: Source node ID (if derivable from code)\n- confidence: Per confidence bands above\n</output_format>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"ba_end_user\",\n      \"name\": \"End User\",\n      \"documentation\": \"Primary user of the application who consumes services\",\n      \"source\": \"typedef_user_model\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"ba_administrator\",\n      \"name\": \"Administrator\",\n      \"documentation\": \"User with elevated privileges for system management\",\n      \"source\": \"typedef_admin_role\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T21:57:30.843957"
  },
  {
    "id": 220,
    "step_name": "TechnologyService",
    "phase": "generate",
    "version": 3,
    "sequence": 10,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:ExternalDependency`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.dependencyName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying TechnologyService elements from external dependencies.\n\nA TechnologyService represents an externally visible unit of functionality provided by technology infrastructure:\n- Database services (PostgreSQL, SQLite, Redis)\n- Web frameworks (Flask, Express, Django)\n- ORM layers (SQLAlchemy, Hibernate)\n- External APIs\n\nReview each candidate dependency and create TechnologyService elements.\n\nINCLUDE dependencies that:\n- Provide infrastructure functionality\n- Are key to the application architecture\n- Would appear in a technology stack diagram\n\nEXCLUDE dependencies that:\n- Are development tools only (pytest, black, mypy)\n- Are minor utilities\n- Are transitive dependencies\n\nSTRICT RULES:\n1. ONE TechnologyService per logical service, not per package\n2. Group related packages (e.g., SQLAlchemy + Flask-SQLAlchemy = ONE service)\n3. Max 3-4 TechnologyService elements per small application\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: techsvc_<service>\n2. Use Title Case for display name\n3. CANONICAL SERVICES (use these exact identifiers):\n   - techsvc_flask: Flask web framework\n   - techsvc_sqlalchemy: SQLAlchemy ORM/database access\n   - techsvc_jinja: Jinja templating\n   - techsvc_database: Database service (when separate from ORM)\n4. NEVER include both \"flask\" and \"sqlalchemy\" separately if Flask-SQLAlchemy is used\n5. NEVER use compound names like \"flask_sqlalchemy_integration\"\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"techsvc_flask\",\n      \"name\": \"Flask Web Framework\",\n      \"documentation\": \"Python web framework providing HTTP handling and routing\",\n      \"source\": \"dep_flask\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"techsvc_sqlalchemy\",\n      \"name\": \"SQLAlchemy Database\",\n      \"documentation\": \"ORM and database access layer for Python applications\",\n      \"source\": \"dep_sqlalchemy\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-08T13:23:24.901913"
  },
  {
    "id": 206,
    "step_name": "TechnologyService",
    "phase": "generate",
    "version": 2,
    "sequence": 10,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:ExternalDependency`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.dependencyName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying TechnologyService elements from external dependencies.\n\nA TechnologyService represents an externally visible unit of functionality\nprovided by infrastructure or external systems, such as:\n- Databases (PostgreSQL, MongoDB, Redis, etc.)\n- Message queues (Kafka, RabbitMQ, etc.)\n- External APIs and HTTP clients\n- Cloud services (AWS S3, Azure Blob, etc.)\n- Authentication services\n\nReview each candidate dependency. Consider:\n- Does this provide infrastructure functionality?\n- Is it a service the application connects TO (not just a utility library)?\n- Would it appear in an architecture diagram?\n\nINCLUDE:\n- Database drivers and ORMs (sqlalchemy, psycopg2, pymongo)\n- HTTP clients for external APIs (requests, httpx, axios)\n- Message queue clients (kafka-python, pika)\n- Cloud SDK components (boto3, azure-storage)\n- Caching services (redis, memcached)\n\nEXCLUDE:\n- Standard library modules\n- Utility libraries (json parsing, date handling)\n- Testing frameworks\n- Development tools\n- Internal application modules\n\nNAMING RULES REMINDER:\n- Use lowercase snake_case for identifiers\n- Use consistent prefix for element type\n- Keep names generic and stable\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"techsvc_postgresql\",\n      \"name\": \"PostgreSQL Database\",\n      \"documentation\": \"Relational database service for persistent data storage\",\n      \"source\": \"dep_sqlalchemy\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"techsvc_redis_cache\",\n      \"name\": \"Redis Cache\",\n      \"documentation\": \"In-memory data store used for caching and session management\",\n      \"source\": \"dep_redis\",\n      \"confidence\": 0.9\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-03T09:56:11.370273"
  },
  {
    "id": 221,
    "step_name": "TechnologyService",
    "phase": "generate",
    "version": 4,
    "sequence": 10,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:ExternalDependency`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.dependencyName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying TechnologyService elements from external dependencies.\n\nA TechnologyService represents a PRIMARY technology service:\n- Web frameworks (Flask, Django, Express)\n- ORMs and database access (SQLAlchemy, TypeORM)\n- Template engines (Jinja2, Handlebars)\n\nONLY create TechnologyService for TOP-LEVEL dependencies.\n\nDO NOT create TechnologyService for:\n- Transitive dependencies\n- Development tools\n- Utility packages\n- Flask extensions (flask-sqlalchemy, flask-login) - use base package instead\n\nNAMING RULES (MANDATORY - FOLLOW EXACTLY):\n1. Use the BASE package name, not extensions:\n   - For flask-sqlalchemy: use techsvc_sqlalchemy\n   - For flask-login: use techsvc_flask (or skip if already have flask)\n2. CANONICAL NAMES (use these exact identifiers):\n   - Flask web framework: techsvc_flask\n   - SQLAlchemy ORM: techsvc_sqlalchemy\n   - Jinja2 templates: techsvc_jinja2\n3. Maximum 3 TechnologyService elements\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"techsvc_flask\",\n      \"name\": \"Flask Web Framework\",\n      \"documentation\": \"Python web framework providing HTTP handling and routing\",\n      \"source\": \"dep_flask\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"techsvc_sqlalchemy\",\n      \"name\": \"SQLAlchemy Database\",\n      \"documentation\": \"ORM and database access layer for Python applications\",\n      \"source\": \"dep_sqlalchemy\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": 0.0,
    "max_tokens": null,
    "created_at": "2026-01-08T13:35:30.804180"
  },
  {
    "id": 110,
    "step_name": "TechnologyService",
    "phase": "generate",
    "version": 1,
    "sequence": 10,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (d:`Graph:ExternalDependency`) WHERE d.active = true RETURN d.id as id, d.name as name, d.package as package, d.version as version",
    "input_model_query": null,
    "instruction": "Analyze these external dependencies and derive ArchiMate TechnologyService elements.\nTechnologyService represents external services and libraries that the application depends on.\n\nGuidelines:\n- Group related dependencies into logical services\n- Flask/web frameworks -> \"Web Framework Service\"\n- Database libraries (SQLAlchemy, etc) -> \"Database Service\"\n- Authentication libraries -> \"Authentication Service\"\n- Use descriptive names reflecting the service purpose",
    "example": "{\"elements\": [\n  {\"identifier\": \"tech-svc:web-framework\", \"name\": \"Web Framework Service\", \"documentation\": \"Flask web framework\", \"source\": \"ExternalDependency:flask\", \"confidence\": 0.8}\n]}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.113411"
  },
  {
    "id": 394,
    "step_name": "TechnologyService",
    "phase": "generate",
    "version": 10,
    "sequence": 10,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:ExternalDependency`)\nWHERE n.active = true\n  AND (n.kcore_level >= 2 OR n.pagerank > 0.01)\nRETURN n.id as id,\n       COALESCE(n.dependencyName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<persona>\nYou are a senior enterprise architect with 15+ years of ArchiMate 3.2 expertise. You value semantic precision and consistent terminology above all else. You identify technology services as capabilities provided by system software.\n</persona>\n\n<definition>\nA TechnologyService represents a technical capability that is provided by system software and consumed by applications. These are infrastructure services like database connectivity, caching, and messaging.\n</definition>\n\n<semantic_exclusions>\nA TechnologyService is NOT:\n- An ApplicationService (business capability, not technical)\n- An ApplicationInterface (application-level contract)\n- The SystemSoftware itself (software provides service)\n- A library or SDK\n\nDO NOT:\n- Model application business services as technology services\n- Model software products (model their services instead)\n- Create services without underlying system software\n- Model library features\n</semantic_exclusions>\n\n<scope_constraint>\nINFRASTRUCTURE SERVICES: Model services PROVIDED BY system software.\n\nVALID (infrastructure services):\n- Database connectivity (provided by PostgreSQL)\n- Message queuing (provided by Kafka/RabbitMQ)\n- Caching (provided by Redis)\n- Search indexing (provided by Elasticsearch)\n\nINVALID (don't model):\n- Application business services\n- HTTP API endpoints (those are ApplicationInterface)\n- Library functions\n</scope_constraint>\n\n<systemsoftware_constraint>\nSTRICT LINKAGE: Every TechnologyService must be provided by a SystemSoftware element.\n\nIf no underlying SystemSoftware exists, do not create the TechnologyService.\n\nExamples:\n- techsvc_postgresql → requires syssoft_postgresql\n- techsvc_kafka_messaging → requires syssoft_kafka\n- techsvc_redis_cache → requires syssoft_redis\n</systemsoftware_constraint>\n\n<service_test>\nVALIDATION RULE (apply to every candidate):\nA candidate TechnologyService must answer \"Which SystemSoftware provides this infrastructure capability?\" with a specific element.\n\nREJECT if:\n- No SystemSoftware provider exists\n- It's an application-level service\n- It's a library feature\n</service_test>\n\n<naming_rules>\nIDENTIFIER FORMAT (MANDATORY):\n- Prefix: techsvc_\n- Format: techsvc_<provider>_<capability> or techsvc_<provider>\n- Style: lowercase snake_case\n\nNORMALIZATION PRECEDENCE:\n1. Include provider name for clarity\n2. Add capability suffix when provider offers multiple services\n3. Prefer standard capability names\n\nExamples:\n- techsvc_postgresql (single service from PostgreSQL)\n- techsvc_redis_cache (Redis as cache)\n- techsvc_redis_pubsub (Redis as pub/sub)\n- techsvc_kafka_messaging (Kafka messaging)\n</naming_rules>\n\n<canonical_patterns>\n| Provider | Service Type | Identifier | Name |\n|----------|--------------|------------|------|\n| PostgreSQL | Database | techsvc_postgresql | PostgreSQL Database Service |\n| MySQL | Database | techsvc_mysql | MySQL Database Service |\n| MongoDB | Database | techsvc_mongodb | MongoDB Database Service |\n| Redis | Cache | techsvc_redis_cache | Redis Cache Service |\n| Redis | Pub/Sub | techsvc_redis_pubsub | Redis Pub/Sub Service |\n| Elasticsearch | Search | techsvc_elasticsearch | Elasticsearch Search Service |\n| Kafka | Messaging | techsvc_kafka | Kafka Messaging Service |\n| RabbitMQ | Messaging | techsvc_rabbitmq | RabbitMQ Messaging Service |\n</canonical_patterns>\n\n<selection_criteria>\nINCLUDE technology services that:\n- Are provided by a SystemSoftware element\n- Provide distinct infrastructure capabilities\n- Are consumed by application components\n- Represent a technical contract\n\nEXCLUDE:\n- Application business services\n- Services without SystemSoftware provider\n- Library features\n- Framework capabilities\n</selection_criteria>\n\n<granularity_rules>\nTARGET: 2-6 TechnologyServices per repository\n\nShould roughly correspond to SystemSoftware count.\n\nESCALATION RULES:\n- If > 6 candidates: verify all have SystemSoftware providers\n- If fewer than SystemSoftware count: may be correct if some SW not used as service\n- If 0 candidates: verify SystemSoftware exists\n</granularity_rules>\n\n<determinism>\nORDERING: Sort elements alphabetically by identifier.\n\nCONFIDENCE BANDS (fixed):\n- 0.9-1.0: Clear service usage with provider in infrastructure\n- 0.8-0.89: Inferred from client library usage\n- 0.7-0.79: Implicit from connection patterns\n\nCONSISTENCY:\n- Do not invent synonyms across runs\n- Use identical identifiers for identical services\n- Given identical input, produce identical output\n</determinism>\n\n<output_format>\nJSON with \"elements\" array containing:\n- identifier: techsvc_ prefix + provider + optional capability (snake_case)\n- name: Title Case service name\n- documentation: One sentence describing infrastructure capability\n- source: Source node ID\n- confidence: Per confidence bands above\n</output_format>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"techsvc_web_framework\",\n      \"name\": \"Web Framework Service\",\n      \"documentation\": \"HTTP handling, routing, and request processing infrastructure\",\n      \"source\": \"extdep_framework_package\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"techsvc_database\",\n      \"name\": \"Database Service\",\n      \"documentation\": \"Data persistence and ORM infrastructure\",\n      \"source\": \"extdep_database_package\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": 0.0,
    "max_tokens": null,
    "created_at": "2026-01-14T22:15:09.908990"
  },
  {
    "id": 313,
    "step_name": "TechnologyService",
    "phase": "generate",
    "version": 8,
    "sequence": 10,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:ExternalDependency`)\nWHERE n.active = true\n  AND (n.kcore_level >= 2 OR n.pagerank > 0.01)\nRETURN n.id as id,\n       COALESCE(n.dependencyName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying TechnologyService elements from external dependencies.\n\nA TechnologyService represents a technology infrastructure capability.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include dependencies with kcore_level >= 2 (core infrastructure)\n2. Include dependencies with pagerank > 0.01 (structurally important)\n3. Include dependencies with in_degree >= 2 (used by multiple modules)\n4. Exclude dependencies with out_degree = 0 AND in_degree <= 1 (transitive)\n\nCATEGORY-BASED INCLUSION:\n- web_framework: HTTP handling, routing, request processing\n- database: ORM, database drivers, query builders\n- cache: In-memory stores, caching layers\n- queue: Message queues, task processors\n- template: Template engines, view rendering\n\nCATEGORY-BASED EXCLUSION:\n- dev_tools: Testing, linting, formatting, type checking\n- transitive: Dependencies of dependencies (low pagerank)\n- document: PDF, report generation (use ApplicationService instead)\n- form: Form processing, validation utilities\n\nGROUPING RULES:\n- Group related packages into ONE logical service\n- Framework + extensions = 1 service\n- ORM + database driver = 1 service\n\nNAMING RULES (MANDATORY):\n1. Identifier: techsvc_<category> OR techsvc_<framework_type>\n2. Categories: web_framework, database, cache, queue, template\n3. Use lowercase snake_case\n4. Name: Title Case descriptive name\n\nLIMIT: Maximum 4 TechnologyService elements.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"techsvc_flask\",\n      \"name\": \"Flask Web Framework\",\n      \"documentation\": \"Python web framework providing HTTP handling and routing\",\n      \"source\": \"dep_flask\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"techsvc_sqlalchemy\",\n      \"name\": \"SQLAlchemy Database\",\n      \"documentation\": \"ORM and database access layer for Python applications\",\n      \"source\": \"dep_sqlalchemy\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": 0.0,
    "max_tokens": null,
    "created_at": "2026-01-09T22:50:46.127107"
  },
  {
    "id": 337,
    "step_name": "TechnologyService",
    "phase": "generate",
    "version": 9,
    "sequence": 10,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:ExternalDependency`)\nWHERE n.active = true\n  AND (n.kcore_level >= 2 OR n.pagerank > 0.01)\nRETURN n.id as id,\n       COALESCE(n.dependencyName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "<technology_service_derivation>\n\n<definition>\nA TechnologyService represents infrastructure capabilities that support application functionality - databases, web frameworks, caching, messaging, etc.\n</definition>\n\n<selection_criteria>\nInclude dependencies that provide INFRASTRUCTURE capabilities:\n- Web frameworks (HTTP handling, routing)\n- Database systems (ORM, drivers, query builders)\n- Caching layers (in-memory stores)\n- Message queues (async processing)\n\nExclude:\n- Development tools (testing, linting)\n- Transitive dependencies (low structural importance)\n- Application-level libraries (PDF generation → ApplicationService)\n</selection_criteria>\n\n<naming_approach>\nUse CATEGORY-BASED identifiers, not framework-specific names:\n\n| Category | Identifier | Covers |\n|----------|------------|--------|\n| Web framework | techsvc_web_framework | Flask, Django, FastAPI, Express |\n| Database | techsvc_database | SQLAlchemy, Prisma, TypeORM |\n| Cache | techsvc_cache | Redis, Memcached |\n| Queue | techsvc_message_queue | Celery, RabbitMQ, SQS |\n| Template | techsvc_template_engine | Jinja2, Handlebars |\n\nThis ensures the SAME identifier regardless of which specific framework is used.\n</naming_approach>\n\n<grouping>\nGroup related dependencies under ONE service:\n- Flask + Werkzeug + Jinja2 → techsvc_web_framework\n- SQLAlchemy + psycopg2 → techsvc_database\n</grouping>\n\n<constraints>\n- Maximum 3-4 TechnologyService elements\n- One service per infrastructure CATEGORY\n- Ignore framework version details\n</constraints>\n\n</technology_service_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"techsvc_web_framework\",\n      \"name\": \"Web Framework Service\",\n      \"documentation\": \"HTTP handling, routing, and request processing infrastructure\",\n      \"source\": \"extdep_framework_package\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"techsvc_database\",\n      \"name\": \"Database Service\",\n      \"documentation\": \"Data persistence and ORM infrastructure\",\n      \"source\": \"extdep_database_package\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": 0.0,
    "max_tokens": null,
    "created_at": "2026-01-10T08:22:37.612617"
  },
  {
    "id": 307,
    "step_name": "TechnologyService",
    "phase": "generate",
    "version": 5,
    "sequence": 10,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:ExternalDependency`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.dependencyName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying TechnologyService elements from external dependencies.\n\nA TechnologyService represents a technology infrastructure capability.\n\nCRITICAL: Only derive 3 TechnologyService elements. No more, no less.\n\nMANDATORY SERVICE LIST - Use EXACTLY these identifiers if present:\n1. techsvc_flask - For Flask web framework (includes Werkzeug)\n2. techsvc_sqlalchemy - For SQLAlchemy ORM (includes database access)\n3. techsvc_jinja - For Jinja2 templating\n\nTIER 1 SERVICES (ALWAYS include if dependency exists):\n- Flask → techsvc_flask\n- SQLAlchemy → techsvc_sqlalchemy\n- Django → techsvc_django\n- FastAPI → techsvc_fastapi\n- Express → techsvc_express\n\nTIER 2 SERVICES (Include if no Tier 1 fills the slot):\n- Jinja2 → techsvc_jinja\n- Redis → techsvc_redis\n- PostgreSQL → techsvc_postgres\n\nDO NOT CREATE TechnologyService for:\n- Transitive dependencies (Werkzeug, MarkupSafe, click, itsdangerous)\n- PDF libraries (WeasyPrint, ReportLab, cairocffi)\n- Development tools (pytest, black, ruff, mypy)\n- Form libraries (WTForms, Flask-WTF) - part of framework\n- Minor utilities with low pagerank\n\nGROUPING RULES:\n- Flask + Flask-SQLAlchemy + Werkzeug = techsvc_flask + techsvc_sqlalchemy (2 services)\n- Django + Django-REST = techsvc_django (1 service)\n\nNAMING FORMAT:\n- Identifier: techsvc_<lowercase_name>\n- Name: Title Case (e.g., \"Flask Web Framework\")\n\nOutput stable, deterministic results. Always produce exactly 3 elements.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"techsvc_flask\",\n      \"name\": \"Flask Web Framework\",\n      \"documentation\": \"Python web framework providing HTTP handling and routing\",\n      \"source\": \"dep_flask\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"techsvc_sqlalchemy\",\n      \"name\": \"SQLAlchemy Database\",\n      \"documentation\": \"ORM and database access layer for Python applications\",\n      \"source\": \"dep_sqlalchemy\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": 0.0,
    "max_tokens": null,
    "created_at": "2026-01-09T22:24:30.808741"
  },
  {
    "id": 308,
    "step_name": "TechnologyService",
    "phase": "generate",
    "version": 6,
    "sequence": 10,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:ExternalDependency`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.dependencyName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying TechnologyService elements from external dependencies.\n\nA TechnologyService represents a technology infrastructure capability used by the application.\n\nSELECTION CRITERIA (GRAPH-BASED - Generic):\n1. ONLY include dependencies with:\n   - in_degree > 0 (used by other nodes in the graph)\n   - OR pagerank > 0.01 (structurally important)\n2. PREFER dependencies that:\n   - Are in k-core >= 2 (core infrastructure, not peripheral)\n   - Have high betweenness centrality (bridge between modules)\n3. EXCLUDE dependencies with:\n   - out_degree = 0 AND in_degree <= 1 (isolated, transitive)\n   - pagerank < 0.005 (structurally unimportant)\n\nCATEGORY-BASED RULES (Generic):\n1. INCLUDE: web frameworks, ORMs, database drivers, caching systems, message queues\n2. EXCLUDE: \n   - dev-only tools (testing, linting, formatting, type checking)\n   - transitive dependencies (dependencies of dependencies)\n   - PDF/document generation libraries (use ApplicationService)\n   - form/validation utilities (part of web framework)\n\nGROUPING RULES:\n- Group related packages into ONE logical service\n- Web framework + its extensions = 1 service\n- ORM + database driver = 1 service\n\nNAMING FORMAT:\n- Identifier: techsvc_<category> where category is: web_framework, database, cache, queue, etc.\n- OR techsvc_<framework_name> for major frameworks\n- Name: Title Case descriptive name\n\nLIMIT: Max 4 TechnologyService elements. Select top candidates by pagerank if more exist.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"techsvc_flask\",\n      \"name\": \"Flask Web Framework\",\n      \"documentation\": \"Python web framework providing HTTP handling and routing\",\n      \"source\": \"dep_flask\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"techsvc_sqlalchemy\",\n      \"name\": \"SQLAlchemy Database\",\n      \"documentation\": \"ORM and database access layer for Python applications\",\n      \"source\": \"dep_sqlalchemy\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": 0.0,
    "max_tokens": null,
    "created_at": "2026-01-09T22:29:08.664676"
  },
  {
    "id": 310,
    "step_name": "TechnologyService",
    "phase": "generate",
    "version": 7,
    "sequence": 10,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:ExternalDependency`)\nWHERE n.active = true\n  AND (n.kcore_level >= 2 OR n.pagerank > 0.01)\nRETURN n.id as id,\n       COALESCE(n.dependencyName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying TechnologyService elements from external dependencies.\n\nA TechnologyService represents a technology infrastructure capability used by the application.\n\nSELECTION CRITERIA (GRAPH-BASED - Generic):\n1. ONLY include dependencies with:\n   - in_degree > 0 (used by other nodes in the graph)\n   - OR pagerank > 0.01 (structurally important)\n2. PREFER dependencies that:\n   - Are in k-core >= 2 (core infrastructure, not peripheral)\n   - Have high betweenness centrality (bridge between modules)\n3. EXCLUDE dependencies with:\n   - out_degree = 0 AND in_degree <= 1 (isolated, transitive)\n   - pagerank < 0.005 (structurally unimportant)\n\nCATEGORY-BASED RULES (Generic):\n1. INCLUDE: web frameworks, ORMs, database drivers, caching systems, message queues\n2. EXCLUDE: \n   - dev-only tools (testing, linting, formatting, type checking)\n   - transitive dependencies (dependencies of dependencies)\n   - PDF/document generation libraries (use ApplicationService)\n   - form/validation utilities (part of web framework)\n\nGROUPING RULES:\n- Group related packages into ONE logical service\n- Web framework + its extensions = 1 service\n- ORM + database driver = 1 service\n\nNAMING FORMAT:\n- Identifier: techsvc_<category> where category is: web_framework, database, cache, queue, etc.\n- OR techsvc_<framework_name> for major frameworks\n- Name: Title Case descriptive name\n\nLIMIT: Max 4 TechnologyService elements. Select top candidates by pagerank if more exist.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"techsvc_flask\",\n      \"name\": \"Flask Web Framework\",\n      \"documentation\": \"Python web framework providing HTTP handling and routing\",\n      \"source\": \"dep_flask\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"techsvc_sqlalchemy\",\n      \"name\": \"SQLAlchemy Database\",\n      \"documentation\": \"ORM and database access layer for Python applications\",\n      \"source\": \"dep_sqlalchemy\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": 0.0,
    "max_tokens": null,
    "created_at": "2026-01-09T22:35:54.019656"
  },
  {
    "id": 111,
    "step_name": "Node",
    "phase": "generate",
    "version": 1,
    "sequence": 11,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND (f.fileName CONTAINS \"docker\" OR f.fileName CONTAINS \"Dockerfile\" OR f.fileName CONTAINS \"compose\" OR f.fileName CONTAINS \"k8s\" OR f.fileName CONTAINS \"kubernetes\") RETURN f.id as id, f.fileName as name, f.filePath as path, f.fileType as fileType",
    "input_model_query": null,
    "instruction": "Map infrastructure resources to Node elements. Include servers, containers, cloud resources that host or execute software.",
    "example": "{\"identifier\":\"node:app-server\",\"name\":\"Application Server\",\"type\":\"virtual\",\"platform\":\"AWS EC2\",\"confidence\":0.75}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.115645"
  },
  {
    "id": 212,
    "step_name": "Node",
    "phase": "generate",
    "version": 2,
    "sequence": 11,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND (f.fileName CONTAINS \"docker\" OR f.fileName CONTAINS \"Dockerfile\" OR f.fileName CONTAINS \"compose\" OR f.fileName CONTAINS \"k8s\" OR f.fileName CONTAINS \"kubernetes\") RETURN f.id as id, f.fileName as name, f.filePath as path, f.fileType as fileType",
    "input_model_query": null,
    "instruction": "You are identifying Node elements from infrastructure files.\n\nA Node represents a computational or physical resource that hosts or executes artifacts:\n- Container definitions (Docker, Podman)\n- Orchestration configs (Kubernetes, Docker Compose)\n- Cloud resources (EC2, Azure VM, GCP Compute)\n- Server definitions\n\nEach candidate includes file information and graph metrics.\n\nReview each candidate and decide which should become Node elements.\n\nINCLUDE files that:\n- Define container images (Dockerfile)\n- Define orchestration (docker-compose, k8s manifests)\n- Define cloud infrastructure\n- Specify runtime environments\n\nEXCLUDE files that:\n- Are just configuration (env files, settings)\n- Are test or development only\n- Don't represent deployable infrastructure\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: node_<name>\n2. Use Title Case for display name\n3. Keep names generic (e.g., \"Application Container\" not \"Flask App Docker v3\")\n4. Use standard infrastructure terminology\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"node_application_container\",\n      \"name\": \"Application Container\",\n      \"documentation\": \"Docker container running the main application\",\n      \"source\": \"file_Dockerfile\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"node_database_container\",\n      \"name\": \"Database Container\",\n      \"documentation\": \"Container hosting the database service\",\n      \"source\": \"file_docker_compose\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-08T13:07:16.204294"
  },
  {
    "id": 351,
    "step_name": "Node",
    "phase": "generate",
    "version": 4,
    "sequence": 11,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND (f.fileName CONTAINS \"docker\" OR f.fileName CONTAINS \"Dockerfile\" OR f.fileName CONTAINS \"compose\" OR f.fileName CONTAINS \"k8s\" OR f.fileName CONTAINS \"kubernetes\") RETURN f.id as id, f.fileName as name, f.filePath as path, f.fileType as fileType",
    "input_model_query": null,
    "instruction": "<node_derivation>\n\n<definition>\nA Node represents a computational or physical resource that hosts, manipulates, or interacts with other elements. In ArchiMate, Nodes are technology layer elements representing deployment targets.\n</definition>\n\n<canonical_identifiers>\nYou MUST use ONLY these exact identifiers. Select the ones that apply:\n\n| File Pattern | Identifier | Name | When to Use |\n|--------------|------------|------|-------------|\n| Dockerfile, docker-compose* | node_container | Container | Docker/container deployment |\n| kubernetes/, k8s/, *.yaml (k8s) | node_cluster | Cluster | Kubernetes/orchestration |\n| nginx.conf, apache*, httpd* | node_web_server | Web Server | Reverse proxy/web server |\n| serverless*, lambda*, functions/ | node_serverless | Serverless | FaaS deployment |\n\nCRITICAL RULES:\n1. Use EXACTLY these identifiers - do not invent variants\n2. Maximum 2-3 Node elements per repository\n3. Only create nodes for EXPLICIT infrastructure config files\n4. If no infrastructure files exist, return empty elements array\n5. Do NOT create nodes for implied/assumed infrastructure\n</canonical_identifiers>\n\n<selection_criteria>\nInclude files that:\n- Explicitly define deployment infrastructure (Dockerfile, docker-compose.yml)\n- Configure hosting environments (nginx.conf, kubernetes manifests)\n\nExclude:\n- Development-only configs (docker-compose.dev.yml)\n- CI/CD pipeline files (they describe process, not deployment targets)\n- Local environment setup files\n- Files that only REFERENCE infrastructure without defining it\n</selection_criteria>\n\n<output_format>\nJSON with \"elements\" array. Each element has:\n- identifier: EXACTLY from the canonical table above\n- name: EXACTLY from the canonical table above\n- documentation: What this node hosts/provides\n- source: Source file node ID\n- confidence: 0.8-1.0\n\nIf no infrastructure config files exist, return: {\"elements\": []}\n</output_format>\n\n<determinism>\nGiven identical infrastructure files, always produce identical output. Prefer returning fewer nodes over inventing nodes for ambiguous files.\n</determinism>\n\n</node_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"node_container\",\n      \"name\": \"Container\",\n      \"documentation\": \"Docker container hosting the application services\",\n      \"source\": \"file_Dockerfile\",\n      \"confidence\": 0.95\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T18:29:08.222907"
  },
  {
    "id": 372,
    "step_name": "Node",
    "phase": "generate",
    "version": 5,
    "sequence": 11,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND (f.fileName CONTAINS \"docker\" OR f.fileName CONTAINS \"Dockerfile\" OR f.fileName CONTAINS \"compose\" OR f.fileName CONTAINS \"k8s\" OR f.fileName CONTAINS \"kubernetes\") RETURN f.id as id, f.fileName as name, f.filePath as path, f.fileType as fileType",
    "input_model_query": null,
    "instruction": "<node_derivation>\n\n<definition>\nA Node represents a computational or physical resource that hosts, manipulates, or interacts with other elements. In ArchiMate, Nodes are technology layer elements representing deployment targets.\n</definition>\n\n<canonical_identifiers>\nYou MUST use ONLY these exact identifiers. Select the ones that apply:\n\n| File Pattern | Identifier | Name | When to Use |\n|--------------|------------|------|-------------|\n| Dockerfile, docker-compose* | node_container | Container | Docker/container deployment |\n| kubernetes/, k8s/, *.yaml (k8s) | node_cluster | Cluster | Kubernetes/orchestration |\n| nginx.conf, apache*, httpd* | node_web_server | Web Server | Reverse proxy/web server |\n| serverless*, lambda*, functions/ | node_serverless | Serverless | FaaS deployment |\n\nCRITICAL RULES:\n1. Use EXACTLY these identifiers - do not invent variants\n2. Maximum 2-3 Node elements per repository\n3. Only create nodes for EXPLICIT infrastructure config files\n4. If no infrastructure files exist, return empty elements array\n5. Do NOT create nodes for implied/assumed infrastructure\n</canonical_identifiers>\n\n<selection_criteria>\nInclude files that:\n- Explicitly define deployment infrastructure (Dockerfile, docker-compose.yml)\n- Configure hosting environments (nginx.conf, kubernetes manifests)\n\nExclude:\n- Development-only configs (docker-compose.dev.yml)\n- CI/CD pipeline files (they describe process, not deployment targets)\n- Local environment setup files\n- Files that only REFERENCE infrastructure without defining it\n</selection_criteria>\n\n<output_format>\nJSON with \"elements\" array. Each element has:\n- identifier: EXACTLY from the canonical table above\n- name: EXACTLY from the canonical table above\n- documentation: What this node hosts/provides\n- source: Source file node ID\n- confidence: 0.8-1.0\n\nIf no infrastructure config files exist, return: {\"elements\": []}\n</output_format>\n\n<determinism>\nGiven identical infrastructure files, always produce identical output. Prefer returning fewer nodes over inventing nodes for ambiguous files.\n</determinism>\n\n</node_derivation>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"node_container\",\n      \"name\": \"Container\",\n      \"documentation\": \"Docker container hosting the application services\",\n      \"source\": \"file_Dockerfile\",\n      \"confidence\": 0.95\n    }\n  ]\n}",
    "params": "{\"temperature\": 0.0}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T16:41:02.067014"
  },
  {
    "id": 392,
    "step_name": "Node",
    "phase": "generate",
    "version": 6,
    "sequence": 11,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND (f.fileName CONTAINS \"docker\" OR f.fileName CONTAINS \"Dockerfile\" OR f.fileName CONTAINS \"compose\" OR f.fileName CONTAINS \"k8s\" OR f.fileName CONTAINS \"kubernetes\") RETURN f.id as id, f.fileName as name, f.filePath as path, f.fileType as fileType",
    "input_model_query": null,
    "instruction": "<persona>\nYou are a senior enterprise architect with 15+ years of ArchiMate 3.2 expertise. You value semantic precision and consistent terminology above all else. You identify nodes as deployment targets from infrastructure definitions.\n</persona>\n\n<definition>\nA Node represents a computational or physical resource that hosts, manipulates, or interacts with other computational resources. Nodes are deployment targets where application components run.\n</definition>\n\n<semantic_exclusions>\nA Node is NOT:\n- An ApplicationComponent (logical, not deployment)\n- A SystemSoftware (software running on node, not the node itself)\n- A single container or process (too granular)\n- A load balancer endpoint (that's infrastructure)\n\nDO NOT:\n- Model individual containers as nodes (model the host)\n- Model application code as nodes\n- Confuse nodes with components\n- Infer nodes from application code references\n</semantic_exclusions>\n\n<scope_constraint>\nDEPLOYMENT TARGETS: Model where application components deploy.\n\nVALID (deployment targets):\n- Web server, application server\n- Database server\n- Message broker host\n- Cloud instance (EC2, Azure VM)\n- Kubernetes cluster/namespace\n\nINVALID (too granular):\n- Individual pods\n- Single processes\n- Docker containers (unless single-container host)\n</scope_constraint>\n\n<evidence_constraint>\nINFRASTRUCTURE FILES: Derive nodes from infrastructure-as-code.\n\nVALID sources:\n- Dockerfile (implies container host)\n- docker-compose.yml (defines service nodes)\n- Kubernetes manifests (deployments, services)\n- Terraform/CloudFormation (infrastructure)\n- Ansible inventory\n\nDO NOT derive from:\n- Application code references\n- Environment variables\n- Connection strings\n- Comments or documentation\n</evidence_constraint>\n\n<node_test>\nVALIDATION RULE (apply to every candidate):\nA candidate Node must answer \"What infrastructure file defines this deployment target?\" with a specific reference.\n\nREJECT if:\n- No infrastructure file exists\n- It's an application concept, not deployment\n- Evidence is only from application code\n</node_test>\n\n<naming_rules>\nIDENTIFIER FORMAT (MANDATORY):\n- Prefix: node_\n- Format: node_<deployment_role>\n- Style: lowercase snake_case\n\nNORMALIZATION PRECEDENCE:\n1. Prefer functional role over technology name\n2. Prefer generic over specific instance names\n3. Prefer singular over plural\n\nCONFLICT RESOLUTION:\n- node_nginx vs node_web_server → choose node_web_server (role)\n- node_postgres_1 vs node_database → choose node_database (generic)\n</naming_rules>\n\n<canonical_patterns>\n| Deployment Role | Identifier | Name |\n|-----------------|------------|------|\n| Web/HTTP serving | node_web_server | Web Server |\n| Application hosting | node_app_server | Application Server |\n| Database hosting | node_database | Database Server |\n| Message broker | node_message_broker | Message Broker |\n| Cache server | node_cache | Cache Server |\n| Worker/job processing | node_worker | Worker Node |\n| API gateway | node_gateway | API Gateway |\n| Container orchestration | node_kubernetes | Kubernetes Cluster |\n</canonical_patterns>\n\n<selection_criteria>\nINCLUDE nodes that:\n- Are defined in infrastructure files\n- Host application components\n- Represent distinct deployment targets\n- Have clear deployment role\n\nEXCLUDE:\n- Application code concepts\n- Individual containers/pods\n- Development-only infrastructure\n- Inferred nodes\n</selection_criteria>\n\n<granularity_rules>\nTARGET: 1-5 Nodes per repository\n\nESCALATION RULES:\n- If > 5 candidates: merge by role (all DBs → node_database)\n- If < 1 candidate: verify infrastructure files exist\n- If 0 candidates: acceptable for libraries without deployment\n</granularity_rules>\n\n<determinism>\nORDERING: Sort elements alphabetically by identifier.\n\nCONFIDENCE BANDS (fixed):\n- 0.9-1.0: Explicit definitions in infrastructure files\n- 0.8-0.89: Strongly implied by docker-compose or similar\n- Below 0.8: Do not create - evidence too weak\n\nCONSISTENCY:\n- Do not invent synonyms across runs\n- Use identical identifiers for identical deployment roles\n- Given identical input, produce identical output\n</determinism>\n\n<output_format>\nJSON with \"elements\" array containing:\n- identifier: node_ prefix + deployment role (snake_case)\n- name: Title Case node name\n- documentation: One sentence describing deployment role\n- source: Source node ID (infrastructure file)\n- confidence: Per confidence bands above\n</output_format>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"node_container\",\n      \"name\": \"Container\",\n      \"documentation\": \"Docker container hosting the application services\",\n      \"source\": \"file_Dockerfile\",\n      \"confidence\": 0.95\n    }\n  ]\n}",
    "params": "{\"temperature\": 0.0}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T22:11:24.197243"
  },
  {
    "id": 320,
    "step_name": "Node",
    "phase": "generate",
    "version": 3,
    "sequence": 11,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND (f.fileName CONTAINS \"docker\" OR f.fileName CONTAINS \"Dockerfile\" OR f.fileName CONTAINS \"compose\" OR f.fileName CONTAINS \"k8s\" OR f.fileName CONTAINS \"kubernetes\") RETURN f.id as id, f.fileName as name, f.filePath as path, f.fileType as fileType",
    "input_model_query": null,
    "instruction": "You are identifying Node elements from infrastructure configuration.\n\nA Node represents a computational resource where artifacts are deployed.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include nodes with multiple services deployed\n2. Prefer nodes mentioned in deployment configs\n3. Exclude development-only nodes\n\nINCLUDE:\n- Production servers (web servers, app servers)\n- Database servers\n- Container hosts (Docker, Kubernetes nodes)\n- Cloud instances (EC2, VMs)\n\nEXCLUDE:\n- Local development machines\n- CI/CD runners\n- Temporary/ephemeral instances\n\nNAMING RULES (MANDATORY):\n1. Identifier: node_<purpose>_<type>\n2. Use lowercase snake_case\n3. Describe purpose: node_web_server, node_db_primary\n4. Avoid specific instance names\n\nLIMIT: Maximum 2-4 Node elements.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"node_application_container\",\n      \"name\": \"Application Container\",\n      \"documentation\": \"Docker container running the main application\",\n      \"source\": \"file_Dockerfile\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"node_database_container\",\n      \"name\": \"Database Container\",\n      \"documentation\": \"Container hosting the database service\",\n      \"source\": \"file_docker_compose\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-09T22:58:15.774792"
  },
  {
    "id": 112,
    "step_name": "Device",
    "phase": "generate",
    "version": 1,
    "sequence": 12,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND (f.fileName CONTAINS \".tf\" OR f.fileName CONTAINS \"terraform\" OR f.fileName CONTAINS \"ansible\" OR f.fileName CONTAINS \"cloudformation\" OR f.fileType = \"infrastructure\") RETURN f.id as id, f.fileName as name, f.filePath as path, f.fileType as fileType",
    "input_model_query": null,
    "instruction": "Identify physical devices from dependencies. Focus on hardware resources like servers, network equipment, or IoT devices.",
    "example": "{\"identifier\":\"dev:load-balancer\",\"name\":\"Load Balancer\",\"type\":\"network\",\"vendor\":\"F5\",\"confidence\":0.8}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.118135"
  },
  {
    "id": 213,
    "step_name": "Device",
    "phase": "generate",
    "version": 2,
    "sequence": 12,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND (f.fileName CONTAINS \".tf\" OR f.fileName CONTAINS \"terraform\" OR f.fileName CONTAINS \"ansible\" OR f.fileName CONTAINS \"cloudformation\" OR f.fileType = \"infrastructure\") RETURN f.id as id, f.fileName as name, f.filePath as path, f.fileType as fileType",
    "input_model_query": null,
    "instruction": "You are identifying Device elements from infrastructure files.\n\nA Device represents physical hardware that hosts system software or artifacts:\n- Physical servers\n- Network equipment (load balancers, firewalls)\n- Storage devices\n- IoT devices\n\nEach candidate includes file information and graph metrics.\n\nReview each candidate and decide which should become Device elements.\n\nINCLUDE files that:\n- Define physical infrastructure (Terraform, Ansible)\n- Reference hardware resources\n- Configure network devices\n- Specify physical deployment targets\n\nEXCLUDE files that:\n- Define only virtual/cloud resources (those are Nodes)\n- Are application-level configs\n- Don't represent physical hardware\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: device_<name>\n2. Use Title Case for display name\n3. Use generic hardware terms\n4. Don't include vendor names unless essential\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"device_web_server\",\n      \"name\": \"Web Server\",\n      \"documentation\": \"Physical server hosting the web application tier\",\n      \"source\": \"file_terraform_servers\",\n      \"confidence\": 0.8\n    },\n    {\n      \"identifier\": \"device_load_balancer\",\n      \"name\": \"Load Balancer\",\n      \"documentation\": \"Network device distributing traffic across servers\",\n      \"source\": \"file_infra_network\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-08T13:07:18.501994"
  },
  {
    "id": 371,
    "step_name": "Device",
    "phase": "generate",
    "version": 4,
    "sequence": 12,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND (f.fileName CONTAINS \".tf\" OR f.fileName CONTAINS \"terraform\" OR f.fileName CONTAINS \"ansible\" OR f.fileName CONTAINS \"cloudformation\" OR f.fileType = \"infrastructure\") RETURN f.id as id, f.fileName as name, f.filePath as path, f.fileType as fileType",
    "input_model_query": null,
    "instruction": "You are identifying Device elements from hardware references.\n\nA Device represents physical hardware that hosts or processes data.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include devices referenced in deployment configs\n2. Include devices with specific hardware requirements\n3. Exclude generic/virtual devices\n\nINCLUDE:\n- Specialized hardware (GPUs, TPUs, HSMs)\n- IoT devices\n- Network appliances\n- Storage arrays\n\nEXCLUDE:\n- Generic servers (use Node instead)\n- Virtual machines (use Node instead)\n- Development hardware\n\nNAMING RULES (MANDATORY):\n1. Identifier: device_<type>_<purpose>\n2. Use lowercase snake_case\n3. Describe device type and function\n4. Avoid brand names\n\nLIMIT: Maximum 2-3 Device elements.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"device_web_server\",\n      \"name\": \"Web Server\",\n      \"documentation\": \"Physical server hosting the web application tier\",\n      \"source\": \"file_terraform_servers\",\n      \"confidence\": 0.8\n    },\n    {\n      \"identifier\": \"device_load_balancer\",\n      \"name\": \"Load Balancer\",\n      \"documentation\": \"Network device distributing traffic across servers\",\n      \"source\": \"file_infra_network\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T16:41:01.343734"
  },
  {
    "id": 391,
    "step_name": "Device",
    "phase": "generate",
    "version": 5,
    "sequence": 12,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND (f.fileName CONTAINS \".tf\" OR f.fileName CONTAINS \"terraform\" OR f.fileName CONTAINS \"ansible\" OR f.fileName CONTAINS \"cloudformation\" OR f.fileType = \"infrastructure\") RETURN f.id as id, f.fileName as name, f.filePath as path, f.fileType as fileType",
    "input_model_query": null,
    "instruction": "<persona>\nYou are a senior enterprise architect with 15+ years of ArchiMate 3.2 expertise. You value semantic precision and consistent terminology above all else. You identify devices only when explicitly defined in infrastructure code.\n</persona>\n\n<definition>\nA Device represents a physical IT resource upon which system software and artifacts may be stored or deployed. These are PHYSICAL hardware components, not virtual/cloud resources.\n</definition>\n\n<semantic_exclusions>\nA Device is NOT:\n- A cloud instance (EC2, Azure VM) - model as Node\n- A container or pod - model as Node\n- A virtual machine - model as Node\n- Software running on hardware - model as SystemSoftware\n\nDO NOT:\n- Model cloud resources as devices\n- Model containers as devices\n- Infer devices from code patterns\n- Create devices without explicit infrastructure definitions\n</semantic_exclusions>\n\n<scope_constraint>\nEXPLICIT DEFINITIONS ONLY: Only model devices explicitly defined in infrastructure code.\n\nVALID sources:\n- Terraform hardware definitions\n- Ansible inventory (physical hosts)\n- Hardware configuration files\n- Network topology definitions\n\nINVALID (do not model):\n- Cloud instances (use Node)\n- Kubernetes pods (use Node)\n- Docker containers (use Node)\n- Inferred from comments or documentation\n</scope_constraint>\n\n<device_test>\nVALIDATION RULE (apply to every candidate):\nA candidate Device must answer \"Where is this physical hardware explicitly defined?\" with a specific file reference.\n\nREJECT if:\n- No explicit definition exists\n- It's a cloud/virtual resource\n- It's inferred rather than defined\n</device_test>\n\n<naming_rules>\nIDENTIFIER FORMAT (MANDATORY):\n- Prefix: device_\n- Format: device_<hardware_type>\n- Style: lowercase snake_case\n\nNORMALIZATION PRECEDENCE:\n1. Use hardware category, not instance identifiers\n2. Prefer generic types over specific models\n3. Prefer functional description over brand names\n\nExamples:\n- device_network_switch (not device_cisco_2960)\n- device_storage_array (not device_netapp_fas8200)\n</naming_rules>\n\n<canonical_patterns>\n| Hardware Type | Identifier | Name |\n|---------------|------------|------|\n| Physical server | device_server | Physical Server |\n| Network switch/router | device_network | Network Device |\n| Storage array | device_storage | Storage Device |\n| IoT/embedded device | device_iot | IoT Device |\n| Workstation | device_workstation | Workstation |\n</canonical_patterns>\n\n<selection_criteria>\nINCLUDE devices that:\n- Are explicitly defined in infrastructure code\n- Represent physical hardware\n- Host system software or nodes\n\nEXCLUDE:\n- Cloud instances (use Node)\n- Virtual machines (use Node)\n- Containers (use Node)\n- Inferred devices\n</selection_criteria>\n\n<granularity_rules>\nTARGET: 0-3 Devices per repository\n\nMost source code repositories have NO devices - this is normal.\n\nESCALATION RULES:\n- If > 3 candidates: verify they are physical hardware, not virtual\n- If 0 candidates: this is expected for most repositories\n</granularity_rules>\n\n<determinism>\nORDERING: Sort elements alphabetically by identifier.\n\nCONFIDENCE BANDS (fixed):\n- 0.9-1.0: Explicit hardware definitions in infrastructure code\n- 0.8-0.89: Referenced in deployment documentation\n- Below 0.8: Do not create - evidence too weak\n\nCONSISTENCY:\n- Do not invent synonyms across runs\n- Use identical identifiers for identical hardware\n- Given identical input, produce identical output\n</determinism>\n\n<output_format>\nJSON with \"elements\" array containing:\n- identifier: device_ prefix + hardware type (snake_case)\n- name: Title Case device name\n- documentation: One sentence describing physical hardware role\n- source: Source node ID (infrastructure file)\n- confidence: Per confidence bands above\n</output_format>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"device_web_server\",\n      \"name\": \"Web Server\",\n      \"documentation\": \"Physical server hosting the web application tier\",\n      \"source\": \"file_terraform_servers\",\n      \"confidence\": 0.8\n    },\n    {\n      \"identifier\": \"device_load_balancer\",\n      \"name\": \"Load Balancer\",\n      \"documentation\": \"Network device distributing traffic across servers\",\n      \"source\": \"file_infra_network\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T22:09:54.330294"
  },
  {
    "id": 321,
    "step_name": "Device",
    "phase": "generate",
    "version": 3,
    "sequence": 12,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND (f.fileName CONTAINS \".tf\" OR f.fileName CONTAINS \"terraform\" OR f.fileName CONTAINS \"ansible\" OR f.fileName CONTAINS \"cloudformation\" OR f.fileType = \"infrastructure\") RETURN f.id as id, f.fileName as name, f.filePath as path, f.fileType as fileType",
    "input_model_query": null,
    "instruction": "You are identifying Device elements from hardware references.\n\nA Device represents physical hardware that hosts or processes data.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include devices referenced in deployment configs\n2. Include devices with specific hardware requirements\n3. Exclude generic/virtual devices\n\nINCLUDE:\n- Specialized hardware (GPUs, TPUs, HSMs)\n- IoT devices\n- Network appliances\n- Storage arrays\n\nEXCLUDE:\n- Generic servers (use Node instead)\n- Virtual machines (use Node instead)\n- Development hardware\n\nNAMING RULES (MANDATORY):\n1. Identifier: device_<type>_<purpose>\n2. Use lowercase snake_case\n3. Describe device type and function\n4. Avoid brand names\n\nLIMIT: Maximum 2-3 Device elements.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"device_web_server\",\n      \"name\": \"Web Server\",\n      \"documentation\": \"Physical server hosting the web application tier\",\n      \"source\": \"file_terraform_servers\",\n      \"confidence\": 0.8\n    },\n    {\n      \"identifier\": \"device_load_balancer\",\n      \"name\": \"Load Balancer\",\n      \"documentation\": \"Network device distributing traffic across servers\",\n      \"source\": \"file_infra_network\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-09T22:58:24.265710"
  },
  {
    "id": 214,
    "step_name": "SystemSoftware",
    "phase": "generate",
    "version": 2,
    "sequence": 13,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (e:`Graph:ExternalDependency`) WHERE e.active = true AND e.dependencyCategory IN [\"external_database\", \"external_service\"] RETURN e.id as id, e.dependencyName as name, e.description as description, e.ecosystem as ecosystem",
    "input_model_query": null,
    "instruction": "You are identifying SystemSoftware elements from external dependencies.\n\nSystemSoftware represents software that provides execution environments or platform services:\n- Runtime environments (Python, Node.js, JVM)\n- Operating systems\n- Database servers (when seen as platform, not service)\n- Middleware (web servers, app servers)\n\nEach candidate includes dependency information and graph metrics.\n\nReview each candidate and decide which should become SystemSoftware elements.\n\nINCLUDE dependencies that:\n- Provide runtime execution environments\n- Are platform-level software\n- Enable other software to run\n- Are infrastructure middleware\n\nEXCLUDE dependencies that:\n- Are application libraries (those inform other elements)\n- Are utilities or tools\n- Don't provide platform functionality\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: syssw_<name>\n2. Use Title Case for display name\n3. Use canonical software names (e.g., \"Python Runtime\" not \"python3.11\")\n4. Group by function, not version\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"syssw_python_runtime\",\n      \"name\": \"Python Runtime\",\n      \"documentation\": \"Python interpreter providing the execution environment\",\n      \"source\": \"dep_python\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"syssw_linux_os\",\n      \"name\": \"Linux Operating System\",\n      \"documentation\": \"Operating system hosting the application\",\n      \"source\": \"file_Dockerfile\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-08T13:07:20.757555"
  },
  {
    "id": 113,
    "step_name": "SystemSoftware",
    "phase": "generate",
    "version": 1,
    "sequence": 13,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (e:`Graph:ExternalDependency`) WHERE e.active = true AND e.dependencyCategory IN [\"external_database\", \"external_service\"] RETURN e.id as id, e.dependencyName as name, e.description as description, e.ecosystem as ecosystem",
    "input_model_query": null,
    "instruction": "Map system software and platforms to SystemSoftware elements. Include runtimes, operating systems, middleware, and platform services.",
    "example": "{\"identifier\":\"sys:nodejs\",\"name\":\"Node.js Runtime\",\"version\":\"18.x\",\"category\":\"runtime\",\"confidence\":0.85}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.120450"
  },
  {
    "id": 359,
    "step_name": "SystemSoftware",
    "phase": "generate",
    "version": 4,
    "sequence": 13,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (e:`Graph:ExternalDependency`) WHERE e.active = true AND e.dependencyCategory IN [\"external_database\", \"external_service\"] RETURN e.id as id, e.dependencyName as name, e.description as description, e.ecosystem as ecosystem",
    "input_model_query": null,
    "instruction": "You are identifying SystemSoftware elements from infrastructure dependencies.\n\nA SystemSoftware represents software that provides the execution environment.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include system software with high in_degree (many services depend on it)\n2. Include software mentioned in Dockerfiles or deployment configs\n3. Exclude development-only software\n\nINCLUDE:\n- Operating systems (when specific version matters)\n- Container runtimes (Docker, containerd)\n- Database engines (PostgreSQL, MySQL, Redis)\n- Message brokers (RabbitMQ, Kafka)\n- Web servers (Nginx, Apache)\n\nEXCLUDE:\n- Application frameworks (use TechnologyService)\n- Development tools\n- CI/CD tools\n\nNAMING RULES (MANDATORY):\n1. Identifier: syssw_<software_type>\n2. Use lowercase snake_case\n3. Use generic category: syssw_database, syssw_web_server, syssw_container_runtime\n4. Avoid version numbers\n\nLIMIT: Maximum 3-5 SystemSoftware elements.\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"syssw_python_runtime\",\n      \"name\": \"Python Runtime\",\n      \"documentation\": \"Python interpreter providing the execution environment\",\n      \"source\": \"dep_python\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"syssw_linux_os\",\n      \"name\": \"Linux Operating System\",\n      \"documentation\": \"Operating system hosting the application\",\n      \"source\": \"file_Dockerfile\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-12T22:44:14.491983"
  },
  {
    "id": 373,
    "step_name": "SystemSoftware",
    "phase": "generate",
    "version": 5,
    "sequence": 13,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (e:`Graph:ExternalDependency`) WHERE e.active = true AND e.dependencyCategory IN [\"external_database\", \"external_service\"] RETURN e.id as id, e.dependencyName as name, e.description as description, e.ecosystem as ecosystem",
    "input_model_query": null,
    "instruction": "You are identifying SystemSoftware elements from infrastructure dependencies.\n\nA SystemSoftware represents software that provides the execution environment.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include system software with high in_degree (many services depend on it)\n2. Include software mentioned in Dockerfiles or deployment configs\n3. Exclude development-only software\n\nINCLUDE:\n- Operating systems (when specific version matters)\n- Container runtimes (Docker, containerd)\n- Database engines (PostgreSQL, MySQL, Redis)\n- Message brokers (RabbitMQ, Kafka)\n- Web servers (Nginx, Apache)\n\nEXCLUDE:\n- Application frameworks (use TechnologyService)\n- Development tools\n- CI/CD tools\n\nNAMING RULES (MANDATORY):\n1. Identifier: syssw_<software_type>\n2. Use lowercase snake_case\n3. Use generic category: syssw_database, syssw_web_server, syssw_container_runtime\n4. Avoid version numbers\n\nLIMIT: Maximum 3-5 SystemSoftware elements.\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"syssw_python_runtime\",\n      \"name\": \"Python Runtime\",\n      \"documentation\": \"Python interpreter providing the execution environment\",\n      \"source\": \"dep_python\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"syssw_linux_os\",\n      \"name\": \"Linux Operating System\",\n      \"documentation\": \"Operating system hosting the application\",\n      \"source\": \"file_Dockerfile\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T16:41:02.787903"
  },
  {
    "id": 393,
    "step_name": "SystemSoftware",
    "phase": "generate",
    "version": 6,
    "sequence": 13,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (e:`Graph:ExternalDependency`) WHERE e.active = true AND e.dependencyCategory IN [\"external_database\", \"external_service\"] RETURN e.id as id, e.dependencyName as name, e.description as description, e.ecosystem as ecosystem",
    "input_model_query": null,
    "instruction": "<persona>\nYou are a senior enterprise architect with 15+ years of ArchiMate 3.2 expertise. You value semantic precision and consistent terminology above all else. You identify system software as infrastructure dependencies, not application code.\n</persona>\n\n<definition>\nA SystemSoftware represents software that provides a platform for running application software. These are infrastructure dependencies like databases, message brokers, and web servers.\n</definition>\n\n<semantic_exclusions>\nA SystemSoftware is NOT:\n- A language runtime (Python, Node.js, JVM)\n- An application library (Flask, React, Django)\n- An application component\n- A framework feature\n\nDO NOT:\n- Model language runtimes (Python, Java, Node.js)\n- Model application frameworks (Django, Rails, Express)\n- Model utility libraries (lodash, numpy, pandas)\n- Model application-level packages\n</semantic_exclusions>\n\n<scope_constraint>\nINFRASTRUCTURE DEPENDENCIES ONLY: Model databases, message brokers, web servers.\n\nVALID (infrastructure):\n- Databases: PostgreSQL, MySQL, MongoDB, Redis\n- Message brokers: Kafka, RabbitMQ, Redis (as broker)\n- Web servers: Nginx, Apache, Traefik\n- Search engines: Elasticsearch, Solr\n- Cache systems: Redis, Memcached\n\nINVALID (don't model):\n- Python, Node.js, Java (runtimes)\n- Flask, Django, Express (frameworks)\n- numpy, lodash, pandas (libraries)\n</scope_constraint>\n\n<evidence_constraint>\nBOTH SOURCES: Use dependency files for client libraries, infrastructure files for servers.\n\nDependency files (client libraries):\n- requirements.txt: psycopg2 → PostgreSQL\n- package.json: redis → Redis\n- Cargo.toml: diesel → potentially PostgreSQL\n\nInfrastructure files (servers):\n- docker-compose.yml: postgres service\n- K8s manifests: StatefulSet for database\n- Terraform: RDS instance\n</evidence_constraint>\n\n<software_test>\nVALIDATION RULE (apply to every candidate):\nA candidate SystemSoftware must answer \"What infrastructure capability does this provide?\" in one sentence.\n\nREJECT if:\n- It's a language runtime\n- It's an application framework\n- It's a utility library\n- No infrastructure function can be identified\n</software_test>\n\n<naming_rules>\nIDENTIFIER FORMAT (MANDATORY):\n- Prefix: syssoft_\n- Format: syssoft_<product_name>\n- Style: lowercase snake_case\n- Use product name, not generic category\n\nNORMALIZATION PRECEDENCE:\n1. Use canonical product names\n2. Prefer lowercase product names\n3. Use singular form\n\nExamples:\n- syssoft_postgresql (not syssoft_database)\n- syssoft_redis (not syssoft_cache)\n- syssoft_kafka (not syssoft_message_broker)\n</naming_rules>\n\n<canonical_patterns>\n| Product | Identifier | Name |\n|---------|------------|------|\n| PostgreSQL | syssoft_postgresql | PostgreSQL |\n| MySQL/MariaDB | syssoft_mysql | MySQL |\n| MongoDB | syssoft_mongodb | MongoDB |\n| Redis | syssoft_redis | Redis |\n| Elasticsearch | syssoft_elasticsearch | Elasticsearch |\n| Kafka | syssoft_kafka | Apache Kafka |\n| RabbitMQ | syssoft_rabbitmq | RabbitMQ |\n| Nginx | syssoft_nginx | Nginx |\n| Docker | syssoft_docker | Docker |\n</canonical_patterns>\n\n<selection_criteria>\nINCLUDE system software that:\n- Provides infrastructure capabilities\n- Is referenced in dependencies or infrastructure\n- Runs as a separate service\n- The application connects to\n\nEXCLUDE:\n- Language runtimes\n- Application frameworks\n- Utility libraries\n- Build tools\n</selection_criteria>\n\n<granularity_rules>\nTARGET: 2-6 SystemSoftware elements per repository\n\nESCALATION RULES:\n- If > 6 candidates: keep only core infrastructure dependencies\n- If < 2 candidates: verify dependencies are analyzed\n- If 0 candidates: may be acceptable for simple applications\n</granularity_rules>\n\n<determinism>\nORDERING: Sort elements alphabetically by identifier.\n\nCONFIDENCE BANDS (fixed):\n- 0.9-1.0: Explicit in infrastructure files (docker-compose, K8s)\n- 0.8-0.89: Client library in dependencies (psycopg2, redis-py)\n- 0.7-0.79: Inferred from code patterns\n\nCONSISTENCY:\n- Do not invent synonyms across runs\n- Use identical identifiers for identical products\n- Given identical input, produce identical output\n</determinism>\n\n<output_format>\nJSON with \"elements\" array containing:\n- identifier: syssoft_ prefix + product name (snake_case)\n- name: Title Case product name\n- documentation: One sentence describing infrastructure role\n- source: Source node ID (dependency or infrastructure file)\n- confidence: Per confidence bands above\n</output_format>\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"syssw_python_runtime\",\n      \"name\": \"Python Runtime\",\n      \"documentation\": \"Python interpreter providing the execution environment\",\n      \"source\": \"dep_python\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"syssw_linux_os\",\n      \"name\": \"Linux Operating System\",\n      \"documentation\": \"Operating system hosting the application\",\n      \"source\": \"file_Dockerfile\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": "{\"temperature\": 0.0}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T22:12:27.056016"
  },
  {
    "id": 322,
    "step_name": "SystemSoftware",
    "phase": "generate",
    "version": 3,
    "sequence": 13,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (e:`Graph:ExternalDependency`) WHERE e.active = true AND e.dependencyCategory IN [\"external_database\", \"external_service\"] RETURN e.id as id, e.dependencyName as name, e.description as description, e.ecosystem as ecosystem",
    "input_model_query": null,
    "instruction": "You are identifying SystemSoftware elements from infrastructure dependencies.\n\nA SystemSoftware represents software that provides the execution environment.\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include system software with high in_degree (many services depend on it)\n2. Include software mentioned in Dockerfiles or deployment configs\n3. Exclude development-only software\n\nINCLUDE:\n- Operating systems (when specific version matters)\n- Container runtimes (Docker, containerd)\n- Database engines (PostgreSQL, MySQL, Redis)\n- Message brokers (RabbitMQ, Kafka)\n- Web servers (Nginx, Apache)\n\nEXCLUDE:\n- Application frameworks (use TechnologyService)\n- Development tools\n- CI/CD tools\n\nNAMING RULES (MANDATORY):\n1. Identifier: sys_<software_type>\n2. Use lowercase snake_case\n3. Use generic category: sys_database, sys_web_server, sys_container_runtime\n4. Avoid version numbers\n\nLIMIT: Maximum 3-5 SystemSoftware elements.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"syssw_python_runtime\",\n      \"name\": \"Python Runtime\",\n      \"documentation\": \"Python interpreter providing the execution environment\",\n      \"source\": \"dep_python\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"syssw_linux_os\",\n      \"name\": \"Linux Operating System\",\n      \"documentation\": \"Operating system hosting the application\",\n      \"source\": \"file_Dockerfile\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 5,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-09T22:58:34.830454"
  },
  {
    "id": 224,
    "step_name": "degree_centrality",
    "phase": "prep",
    "version": 1,
    "sequence": 0,
    "enabled": true,
    "llm": false,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": null,
    "example": null,
    "params": "{}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-08T14:35:52.905424"
  },
  {
    "id": 1,
    "step_name": "k_core_filter",
    "phase": "prep",
    "version": 1,
    "sequence": 1,
    "enabled": true,
    "llm": false,
    "input_graph_query": "MATCH (n:Graph) OPTIONAL MATCH (n)-[r]-() WITH n, count(r) as degree RETURN n, degree",
    "input_model_query": null,
    "instruction": null,
    "example": null,
    "params": "{\"k\": 2, \"description\": \"Remove nodes with degree < k\"}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.069926"
  },
  {
    "id": 2,
    "step_name": "scc_detection",
    "phase": "prep",
    "version": 1,
    "sequence": 2,
    "enabled": false,
    "llm": false,
    "input_graph_query": "MATCH (n:Graph)-[r]->(m:Graph) RETURN n, r, m",
    "input_model_query": null,
    "instruction": null,
    "example": null,
    "params": "{\"min_size\": 2, \"description\": \"Detect strongly connected components\"}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.076560"
  },
  {
    "id": 3,
    "step_name": "louvain_communities",
    "phase": "prep",
    "version": 1,
    "sequence": 3,
    "enabled": true,
    "llm": false,
    "input_graph_query": "MATCH (n:Graph)-[r]->(m:Graph) RETURN n, r, m",
    "input_model_query": null,
    "instruction": null,
    "example": null,
    "params": "{\"resolution\": 1.0, \"description\": \"Detect communities using Louvain algorithm\"}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.079345"
  },
  {
    "id": 4,
    "step_name": "articulation_points",
    "phase": "prep",
    "version": 1,
    "sequence": 4,
    "enabled": true,
    "llm": false,
    "input_graph_query": "MATCH (n:Graph)-[r]-(m:Graph) RETURN n, r, m",
    "input_model_query": null,
    "instruction": null,
    "example": null,
    "params": "{\"mark_critical\": true, \"description\": \"Identify articulation points (bridge nodes)\"}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.082007"
  },
  {
    "id": 5,
    "step_name": "pagerank",
    "phase": "prep",
    "version": 1,
    "sequence": 5,
    "enabled": true,
    "llm": false,
    "input_graph_query": "MATCH (n:Graph)-[r]->(m:Graph) RETURN n, r, m",
    "input_model_query": null,
    "instruction": null,
    "example": null,
    "params": "{\"damping\": 0.85, \"max_iter\": 100, \"tol\": 1e-6}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.084237"
  },
  {
    "id": 201,
    "step_name": "Completeness",
    "phase": "refine",
    "version": 1,
    "sequence": 1,
    "enabled": false,
    "llm": true,
    "input_graph_query": "MATCH (n:Graph) WHERE n.significance > 0.5 AND n.active = true RETURN n",
    "input_model_query": "MATCH (e:Model) RETURN e",
    "instruction": "Compare graph nodes with ArchiMate elements. Identify graph nodes with high significance (>0.5) that don't have corresponding ArchiMate elements. For each missing element, suggest creating an appropriate ArchiMate element with proper type, name, and relationships. Return an array of new elements to add with their confidence scores.",
    "example": "{\"new_elements\":[{\"identifier\":\"ac:payment-processor\",\"type\":\"ApplicationComponent\",\"name\":\"Payment Processor\",\"source_node\":\"Graph:PaymentService\",\"reason\":\"High-significance service node without ArchiMate representation\",\"confidence\":0.85}],\"new_relationships\":[]}",
    "params": null,
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.123083"
  },
  {
    "id": 301,
    "step_name": "duplicate_elements",
    "phase": "refine",
    "version": 1,
    "sequence": 1,
    "enabled": true,
    "llm": true,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": "Find and handle duplicate ArchiMate elements: Tier 1 (exact name+type) auto-merge, Tier 2 (fuzzy match) flag, Tier 3 (semantic via LLM) merge only with >0.95 confidence.",
    "example": null,
    "params": "{\"fuzzy_threshold\": 0.9, \"semantic_threshold\": 0.95, \"auto_merge_tier2\": true}",
    "is_active": false,
    "max_candidates": null,
    "batch_size": null,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-09T00:00:00"
  },
  {
    "id": 325,
    "step_name": "duplicate_elements",
    "phase": "refine",
    "version": 2,
    "sequence": 1,
    "enabled": true,
    "llm": true,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": "Find and handle duplicate ArchiMate elements: Tier 1 (exact name+type) auto-merge, Tier 2 (fuzzy match) flag, Tier 3 (semantic via LLM) merge only with >0.95 confidence.",
    "example": null,
    "params": "{\"use_lemmatization\": true, \"auto_merge_tier2\": true}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-10T07:35:10.290625"
  },
  {
    "id": 202,
    "step_name": "RelationshipConsistency",
    "phase": "refine",
    "version": 1,
    "sequence": 2,
    "enabled": false,
    "llm": true,
    "input_graph_query": "MATCH (source:Graph)-[r]->(target:Graph) WHERE source.significance > 0.3 AND target.significance > 0.3 AND source.active = true AND target.active = true RETURN source, type(r) as rel_type, target",
    "input_model_query": "MATCH (source:Model)-[r]->(target:Model) RETURN source, type(r) as rel_type, target",
    "instruction": "Compare relationships between graph nodes and ArchiMate elements. Identify missing or incorrect relationships in the ArchiMate model. For each discrepancy, suggest adding or updating relationships using appropriate ArchiMate relationship types (Composition, Aggregation, Serving, Realization, Access, Flow). Ensure relationship types follow ArchiMate metamodel rules. Return arrays of new and updated relationships.",
    "example": "{\"new_elements\":[],\"new_relationships\":[{\"source\":\"ac:api-gateway\",\"target\":\"as:user-service\",\"type\":\"Serving\",\"reason\":\"Graph shows API Gateway calls User Service, missing in ArchiMate\",\"confidence\":0.9}],\"updated_relationships\":[{\"source\":\"ac:database\",\"target\":\"do:user-data\",\"old_type\":\"Composition\",\"new_type\":\"Access\",\"reason\":\"Database accesses data, not composes it\",\"confidence\":0.85}]}",
    "params": null,
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.125716"
  },
  {
    "id": 302,
    "step_name": "orphan_elements",
    "phase": "refine",
    "version": 1,
    "sequence": 2,
    "enabled": true,
    "llm": false,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": "Find ArchiMate elements with no relationships. Flag them for review or propose relationships based on source graph patterns.",
    "example": null,
    "params": "{\"disable_orphans\": false, \"min_importance\": 0}",
    "is_active": true,
    "max_candidates": null,
    "batch_size": null,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-09T00:00:00"
  },
  {
    "id": 203,
    "step_name": "LayeringAbstraction",
    "phase": "refine",
    "version": 1,
    "sequence": 3,
    "enabled": false,
    "llm": true,
    "input_graph_query": "MATCH (n:Graph) WHERE n.active = true RETURN n, labels(n) as node_labels, n.category as category",
    "input_model_query": "MATCH (e:Model) RETURN e, e.type as element_type, e.layer as layer",
    "instruction": "Analyze the ArchiMate model for proper layering and abstraction. Check: 1) Elements are in correct layers (Business/Application/Technology), 2) Abstraction levels are appropriate (not too technical in business layer, not too abstract in technology layer), 3) Cross-layer relationships follow ArchiMate patterns. Suggest reclassifying elements or splitting/merging elements to improve architectural clarity. Return arrays of reclassified elements, split suggestions, and new relationships.",
    "example": "{\"reclassified_elements\":[{\"identifier\":\"ac:user-authentication\",\"current_type\":\"ApplicationComponent\",\"suggested_type\":\"ApplicationService\",\"reason\":\"Represents behavior/capability, not a structural component\",\"confidence\":0.8}],\"split_suggestions\":[{\"identifier\":\"ac:monolith-app\",\"suggested_elements\":[{\"type\":\"ApplicationComponent\",\"name\":\"User Management Module\"},{\"type\":\"ApplicationComponent\",\"name\":\"Order Processing Module\"},{\"type\":\"ApplicationComponent\",\"name\":\"Inventory Module\"}],\"reason\":\"Large monolithic component should be decomposed for clarity\",\"confidence\":0.7}],\"new_relationships\":[]}",
    "params": null,
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-02T12:41:14.128141"
  },
  {
    "id": 303,
    "step_name": "duplicate_relationships",
    "phase": "refine",
    "version": 1,
    "sequence": 3,
    "enabled": true,
    "llm": false,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": "Find and remove duplicate relationships (same source, target, type). Also check for redundant relationship pairs.",
    "example": null,
    "params": "{\"check_redundant\": true}",
    "is_active": true,
    "max_candidates": null,
    "batch_size": null,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-09T00:00:00"
  },
  {
    "id": 355,
    "step_name": "graph_relationships",
    "phase": "refine",
    "version": 1,
    "sequence": 4,
    "enabled": true,
    "llm": false,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": null,
    "example": null,
    "params": "{\"edge_types\": [\"CONTAINS\", \"DECLARES\", \"IMPLEMENTS\", \"USES\", \"CALLS\", \"IMPORTS\"]}",
    "is_active": true,
    "max_candidates": 500,
    "batch_size": 50,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-12T10:08:50.416642"
  },
  {
    "id": 304,
    "step_name": "cross_layer_coherence",
    "phase": "refine",
    "version": 1,
    "sequence": 5,
    "enabled": true,
    "llm": false,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": "Validate ArchiMate cross-layer relationships: Business->Application->Technology. Flag elements without cross-layer connections.",
    "example": null,
    "params": "{\"check_business_to_app\": true, \"check_app_to_tech\": true}",
    "is_active": true,
    "max_candidates": null,
    "batch_size": null,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-09T00:00:00"
  },
  {
    "id": 305,
    "step_name": "structural_consistency",
    "phase": "refine",
    "version": 1,
    "sequence": 6,
    "enabled": true,
    "llm": false,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": "Validate that source graph structural patterns (containment, calls) are preserved in the ArchiMate model.",
    "example": null,
    "params": "{\"check_containment\": true, \"check_calls\": true}",
    "is_active": true,
    "max_candidates": null,
    "batch_size": null,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-09T00:00:00"
  },
  {
    "id": 225,
    "step_name": "GlobalRelationships",
    "phase": "relationship",
    "version": 1,
    "sequence": 100,
    "enabled": true,
    "llm": true,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": "You are deriving ArchiMate relationships between elements.\n\nDETERMINISM REQUIREMENTS (CRITICAL):\n- Output the SAME relationships every time for the same input\n- Use ONLY the canonical relationship patterns below\n- Do NOT add speculative or uncertain relationships\n- Limit to MAX 15 relationships total\n\nCANONICAL RELATIONSHIP PATTERNS (use ONLY these patterns):\n\n1. TechnologyService → DataObject: Access\n   techsvc_* → do_* = Access (technology reads/writes data)\n\n2. ApplicationService → BusinessObject: Flow\n   as_* → bo_* = Flow (service processes business data)\n\n3. BusinessProcess → BusinessObject: Access\n   bp_* → bo_* = Access (process creates/modifies data)\n\n4. BusinessObject → BusinessObject: Composition\n   bo_invoice → bo_position = Composition (parent contains child)\n\n5. TechnologyService → ApplicationService: Serving\n   techsvc_flask → as_* = Serving (framework enables service)\n\n6. DataObject → TechnologyService: Realization\n   do_requirements → techsvc_* = Realization (config enables tech)\n\nRELATIONSHIP TYPE RULES:\n- Composition: ONLY for parent-child (Invoice contains Position)\n- Access: ONLY for read/write to DataObject targets\n- Serving: ONLY for service provision between layers\n- Flow: ONLY for data transfer\n- Realization: ONLY for implementation\n\nINVALID TYPES (NEVER use):\n- Association, Dependency, Uses, Triggers\n\nPRIORITY ORDER (stop at limit):\n1. TechnologyService → DataObject (Access)\n2. BusinessProcess → BusinessObject (Access)\n3. BusinessObject → BusinessObject (Composition)\n4. TechnologyService → ApplicationService (Serving)\n\nOutput stable, deterministic relationships only.",
    "example": "{\n  \"relationships\": [\n    {\"source\": \"techsvc_sqlalchemy\", \"target\": \"do_application_database\", \"relationship_type\": \"Access\", \"confidence\": 0.95},\n    {\"source\": \"bp_create_invoice\", \"target\": \"bo_invoice\", \"relationship_type\": \"Access\", \"confidence\": 0.9},\n    {\"source\": \"bo_invoice\", \"target\": \"bo_position\", \"relationship_type\": \"Composition\", \"confidence\": 0.9},\n    {\"source\": \"techsvc_flask\", \"target\": \"as_invoice_form\", \"relationship_type\": \"Serving\", \"confidence\": 0.85}\n  ]\n}",
    "params": null,
    "is_active": false,
    "max_candidates": 50,
    "batch_size": 20,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-08T16:07:16.061820"
  },
  {
    "id": 324,
    "step_name": "GlobalRelationships",
    "phase": "relationship",
    "version": 2,
    "sequence": 100,
    "enabled": true,
    "llm": true,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": "You are deriving ArchiMate relationships between elements based on source graph connections.\n\nRELATIONSHIP MAPPING RULES:\n1. COMPOSITION: Container relationships become Composition (parent contains child)\n2. ASSOCIATION: General connections without direction become Association\n3. FLOW: Data flow connections become Flow relationships\n4. SERVING: Service provider connections become Serving relationships\n5. ACCESS: Data access connections become Access relationships\n6. REALIZATION: Implementation connections become Realization relationships\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include relationships where source and target have high pagerank\n2. Prefer relationships with multiple instances in source graph\n3. Exclude relationships between disabled elements\n\nVALID CROSS-LAYER PATTERNS:\n- BusinessProcess uses ApplicationService (Serving)\n- ApplicationComponent accesses DataObject (Access)\n- ApplicationService uses TechnologyService (Serving)\n- BusinessObject accessed by ApplicationService (Access)\n\nNAMING RULES (MANDATORY):\n1. Identifier: rel_<source_id>_<relationship_type>_<target_id>\n2. Use lowercase snake_case\n3. Relationship types: composition, association, flow, serving, access, realization\n\nLIMIT: Maximum 20-30 relationships per model.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"relationships\": [\n    {\"source\": \"techsvc_sqlalchemy\", \"target\": \"do_application_database\", \"relationship_type\": \"Access\", \"confidence\": 0.95},\n    {\"source\": \"bp_create_invoice\", \"target\": \"bo_invoice\", \"relationship_type\": \"Access\", \"confidence\": 0.9},\n    {\"source\": \"bo_invoice\", \"target\": \"bo_position\", \"relationship_type\": \"Composition\", \"confidence\": 0.9},\n    {\"source\": \"techsvc_flask\", \"target\": \"as_invoice_form\", \"relationship_type\": \"Serving\", \"confidence\": 0.85}\n  ]\n}",
    "params": null,
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-09T23:01:18.961802"
  },
  {
    "id": 379,
    "step_name": "GlobalRelationships",
    "phase": "relationship",
    "version": 5,
    "sequence": 100,
    "enabled": true,
    "llm": true,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": "<persona>\nYou are a senior enterprise architect with 15+ years of ArchiMate 3.2 expertise. You value semantic precision and consistent terminology above all else. Your relationship derivations are deterministic, structurally sound, and follow ArchiMate standards rigorously.\n</persona>\n\n<definition>\nDerive ArchiMate relationships between existing elements. Relationships must be structurally valid according to ArchiMate 3.2 specification.\n</definition>\n\n<valid_relationship_types>\nUse ONLY these ArchiMate relationship types:\n- Composition: Parent contains child (structural ownership)\n- Aggregation: Grouping without ownership\n- Serving: A provides functionality used by B\n- Access: A reads or writes B (data access)\n- Realization: A implements B\n- Flow: Transfer of information or data\n- Assignment: Allocates responsibility\n</valid_relationship_types>\n\n<invalid_types>\nNEVER use these (map to valid types instead):\n- Association → use Serving or Flow\n- Dependency → use Serving\n- Uses → use Serving\n</invalid_types>\n\n<cross_layer_patterns>\nStandard ArchiMate cross-layer relationship patterns:\n\n| Source Type | Target Type | Relationship | Example |\n|-------------|-------------|--------------|---------|\n| ApplicationComponent | DataObject | Access | ac_backend → do_database |\n| ApplicationService | DataObject | Access | as_crud → do_config |\n| ApplicationService | BusinessObject | Flow | as_order → bo_order |\n| TechnologyService | DataObject | Access | techsvc_db → do_database |\n| TechnologyService | ApplicationService | Serving | techsvc_flask → as_api |\n| BusinessProcess | BusinessObject | Access | bp_order → bo_order |\n| BusinessProcess | ApplicationService | Serving | bp_checkout → as_payment |\n| BusinessObject | BusinessObject | Composition | bo_order → bo_line_item |\n</cross_layer_patterns>\n\n<naming_rules>\nIDENTIFIER FORMAT (MANDATORY):\nrel_<source_identifier>_<relationship_lowercase>_<target_identifier>\n\nExamples:\n- rel_ac_backend_access_do_database\n- rel_techsvc_flask_serving_as_api\n- rel_bo_order_composition_bo_line_item\n</naming_rules>\n\n<constraints>\n1. Maximum 15-20 relationships total\n2. Only create relationships with confidence >= 0.85\n3. Prefer relationships where source and target have high pagerank\n4. Skip relationships if pattern is ambiguous\n5. If no valid relationships found, return empty array\n</constraints>\n\n<determinism>\nOutput stable, deterministic results. Given identical input, produce identical output.\n</determinism>\n",
    "example": "{\n  \"relationships\": [\n    {\"source\": \"techsvc_sqlalchemy\", \"target\": \"do_application_database\", \"relationship_type\": \"Access\", \"confidence\": 0.95},\n    {\"source\": \"bp_create_invoice\", \"target\": \"bo_invoice\", \"relationship_type\": \"Access\", \"confidence\": 0.9},\n    {\"source\": \"bo_invoice\", \"target\": \"bo_position\", \"relationship_type\": \"Composition\", \"confidence\": 0.9},\n    {\"source\": \"techsvc_flask\", \"target\": \"as_invoice_form\", \"relationship_type\": \"Serving\", \"confidence\": 0.85}\n  ]\n}",
    "params": "{\"temperature\": 0.0}",
    "is_active": true,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T21:28:26.114829"
  },
  {
    "id": 378,
    "step_name": "GlobalRelationships",
    "phase": "relationship",
    "version": 4,
    "sequence": 100,
    "enabled": true,
    "llm": true,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": "<global_relationships_derivation>\n\n<definition>\nDerive ArchiMate relationships between the elements provided. Focus on STRUCTURAL relationships that are stable and deterministic.\n</definition>\n\n<canonical_relationship_patterns>\nUse ONLY these relationship patterns. Match source and target by element type:\n\n| Source Type | Target Type | Relationship | When to Use |\n|-------------|-------------|--------------|-------------|\n| ApplicationComponent | DataObject | Access | App reads/writes data |\n| ApplicationComponent | ApplicationComponent | Composition | Container contains child |\n| ApplicationService | DataObject | Access | Service accesses data |\n| ApplicationService | TechnologyService | Serving | Tech serves app |\n| BusinessProcess | ApplicationService | Serving | App serves business |\n| BusinessProcess | BusinessObject | Access | Process accesses business data |\n| TechnologyService | DataObject | Access | Tech accesses data |\n| BusinessActor | BusinessProcess | Association | Actor participates in process |\n| BusinessFunction | BusinessProcess | Realization | Function realized by process |\n\n</canonical_relationship_patterns>\n\n<rules>\n1. ONLY derive relationships matching patterns above\n2. Use EXACT relationship types from the table\n3. Maximum 15-20 relationships total\n4. Prefer relationships with HIGH confidence (>=0.85)\n5. Skip relationships if no clear pattern match\n</rules>\n\n<identifier_format>\nrel_<source_id>_<relationship_type_lowercase>_<target_id>\n\nExamples:\n- rel_ac_backend_access_do_database\n- rel_as_api_serving_techsvc_flask\n- rel_bp_order_access_bo_order\n</identifier_format>\n\n<output_requirements>\n- source: element identifier (e.g., ac_backend)\n- target: element identifier (e.g., do_database)\n- relationship_type: EXACT type from table (Access, Serving, Composition, Association, Realization)\n- confidence: 0.85-1.0\n</output_requirements>\n</global_relationships_derivation>\n",
    "example": "{\n  \"relationships\": [\n    {\"source\": \"techsvc_sqlalchemy\", \"target\": \"do_application_database\", \"relationship_type\": \"Access\", \"confidence\": 0.95},\n    {\"source\": \"bp_create_invoice\", \"target\": \"bo_invoice\", \"relationship_type\": \"Access\", \"confidence\": 0.9},\n    {\"source\": \"bo_invoice\", \"target\": \"bo_position\", \"relationship_type\": \"Composition\", \"confidence\": 0.9},\n    {\"source\": \"techsvc_flask\", \"target\": \"as_invoice_form\", \"relationship_type\": \"Serving\", \"confidence\": 0.85}\n  ]\n}",
    "params": "{\"temperature\": 0.0, \"max_candidates\": 20}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T20:59:58.373241"
  },
  {
    "id": 364,
    "step_name": "GlobalRelationships",
    "phase": "relationship",
    "version": 3,
    "sequence": 100,
    "enabled": true,
    "llm": true,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": "You are deriving ArchiMate relationships between elements based on source graph connections.\n\nRELATIONSHIP MAPPING RULES:\n1. COMPOSITION: Container relationships become Composition (parent contains child)\n2. ASSOCIATION: General connections without direction become Association\n3. FLOW: Data flow connections become Flow relationships\n4. SERVING: Service provider connections become Serving relationships\n5. ACCESS: Data access connections become Access relationships\n6. REALIZATION: Implementation connections become Realization relationships\n\nSELECTION CRITERIA (GRAPH-BASED):\n1. Include relationships where source and target have high pagerank\n2. Prefer relationships with multiple instances in source graph\n3. Exclude relationships between disabled elements\n\nVALID CROSS-LAYER PATTERNS:\n- BusinessProcess uses ApplicationService (Serving)\n- ApplicationComponent accesses DataObject (Access)\n- ApplicationService uses TechnologyService (Serving)\n- BusinessObject accessed by ApplicationService (Access)\n\nNAMING RULES (MANDATORY):\n1. Identifier: rel_<source_id>_<relationship_type>_<target_id>\n2. Use lowercase snake_case\n3. Relationship types: composition, association, flow, serving, access, realization\n\nLIMIT: Maximum 20-30 relationships per model.\n\nOutput stable, deterministic results.",
    "example": "{\n  \"relationships\": [\n    {\"source\": \"techsvc_sqlalchemy\", \"target\": \"do_application_database\", \"relationship_type\": \"Access\", \"confidence\": 0.95},\n    {\"source\": \"bp_create_invoice\", \"target\": \"bo_invoice\", \"relationship_type\": \"Access\", \"confidence\": 0.9},\n    {\"source\": \"bo_invoice\", \"target\": \"bo_position\", \"relationship_type\": \"Composition\", \"confidence\": 0.9},\n    {\"source\": \"techsvc_flask\", \"target\": \"as_invoice_form\", \"relationship_type\": \"Serving\", \"confidence\": 0.85}\n  ]\n}",
    "params": "{\"temperature\": 0.0, \"max_candidates\": 25}",
    "is_active": false,
    "max_candidates": 30,
    "batch_size": 10,
    "temperature": null,
    "max_tokens": null,
    "created_at": "2026-01-14T16:40:22.549024"
  }
]